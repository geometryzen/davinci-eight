!function(a,b){var c,d,b,e=a.define;!function(a){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.slice(0,n.length-1).concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(b,c){return function(){var d=v.call(arguments,0);return"string"!=typeof d[0]&&1===d.length&&d.push(null),n.apply(a,d.concat([b,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(b){if(e(r,b)){var c=r[b];delete r[b],t[b]=!0,m.apply(a,c)}if(!e(q,b)&&!e(t,b))throw new Error("No "+b);return q[b]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(b,c,d,f){var h,k,l,m,n,s,u=[],v=typeof d;if(f=f||b,"undefined"===v||"function"===v){for(c=!c.length&&d.length?["require","exports","module"]:c,n=0;n<c.length;n+=1)if(m=o(c[n],f),k=m.f,"require"===k)u[n]=p.require(b);else if("exports"===k)u[n]=p.exports(b),s=!0;else if("module"===k)h=u[n]=p.module(b);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(b+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=d?d.apply(q[b],u):void 0,b&&(h&&h.exports!==a&&h.exports!==q[b]?q[b]=h.exports:l===a&&s||(q[b]=l))}else b&&(q[b]=d)},c=d=n=function(b,c,d,e,f){if("string"==typeof b)return p[b]?p[b](c):j(o(b,c).f);if(!b.splice){if(s=b,s.deps&&n(s.deps,s.callback),!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(a,b,c,d):setTimeout(function(){m(a,b,c,d)},4),n},n.config=function(a){return n(a)},c._defined=q,b=function(a,b,c){if("string"!=typeof a)throw new Error("See almond README: incorrect module build, no module name");b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},b.amd={jQuery:!0}}(),b("../vendor/almond/almond",function(){}),b("davinci-eight/checks/mustSatisfy",["require","exports"],function(a,b){function c(a,b,c,d){if(!b){var e=c?c():"satisfy some condition",f=d?" in "+d():"";throw new Error(a+" must "+e+f+".")}}return c}),b("davinci-eight/checks/isString",["require","exports"],function(a,b){function c(a){return"string"==typeof a}return c}),b("davinci-eight/checks/mustBeString",["require","exports","../checks/mustSatisfy","../checks/isString"],function(a,b,c,d){function e(){return"be a string"}function f(a,b,f){return c(a,d(b),e,f),b}return f}),b("davinci-eight/i18n/readOnly",["require","exports","../checks/mustBeString"],function(a,b,c){function d(a){c("name",a);var b={get message(){return"Property `"+a+"` is readonly."}};return b}return d}),b("davinci-eight/utils/refChange",["require","exports"],function(a,b){function c(a){return p+": "+a}function d(a){return console.log(c(a))}function e(a){return console.warn(c(a))}function f(a){return console.warn(c(a))}function g(){var a=Object.keys(l);a.forEach(function(a){var b=l[a];0===b.refCount&&delete l[a]})}function h(){var a,b=Object.keys(l),c=b.length,d=0;for(a=0;c>a;a++){var e=b[a],f=l[e];d+=f.refCount}return d}function i(){return m&&e("Nothing to see because skip mode is "+m),g(),h()}function j(){var a=i();return a>0?e(JSON.stringify(l,null,2)):d("There are "+a+" outstanding reference counts."),a}function k(a,b,e){if(void 0===e&&(e=0),0===e||!m){if(n)if(o){if(b===o){var g=l[a];d(g?e+" on "+a+" @ "+b:e+" on "+a+" @ "+b)}}else d(e+" on "+a+" @ "+b);if(1===e){var g=l[a];g||(g={refCount:0,name:b,zombie:!1},l[a]=g),g.refCount+=e}else if(-1===e){var g=l[a];g?(g.refCount+=e,0===g.refCount&&(g.zombie=!0)):f(e+" on "+a+" @ "+b)}else{if(0!==e)throw new Error(c("change must be +1 or -1 for normal recording, or 0 for logging to the console."));var h=""+a+" @ "+b;if(d(h),"stop"===a)return i();if("dump"===a)return j();if("start"===a)m=!1,n=!1;else if("reset"===a)l={},m=!0,n=!1,o=void 0;else{if("trace"!==a)throw new Error(c("Unexpected command "+h));m=!1,n=!0,o=b}}}}var l={},m=!0,n=!1,o=void 0,p="refChange";return k}),b("davinci-eight/utils/uuid4",["require","exports"],function(a,b){function c(){var a=function(a){return Math.pow(2,a)},b=(a(4),a(6)),c=a(8),d=a(12),e=(a(14),a(16)),f=a(32),g=(a(40),a(48),function(a,b){return Math.floor(Math.random()*(b-a+1))+a}),h=function(){return g(0,b-1)},i=function(){return g(0,c-1)},j=function(){return g(0,d-1)},k=function(){return g(0,e-1)},l=function(){return g(0,f-1)},m=function(){return(0|Math.random()*(1<<30))+(0|Math.random()*(1<<18))*(1<<30)},n=function(a,b,c){a=String(a),c=c?c:"0";for(var d=b-a.length;d>0;d>>>=1,c+=c)1&d&&(a=c+a);return a},o=function(a,b,c,d,e,f){var g=n(a.toString(16),8)+"-"+n(b.toString(16),4)+"-"+n(c.toString(16),4)+"-"+n(d.toString(16),2)+n(e.toString(16),2)+"-"+n(f.toString(16),12);return g};return{generate:function(){return o(l(),k(),16384|j(),128|h(),i(),m())},validate:function(a){var b=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return b.test(a)}}}return c}),b("davinci-eight/utils/Shareable",["require","exports","../checks/mustBeString","../i18n/readOnly","../utils/refChange","../utils/uuid4"],function(a,b,c,d,e,f){var g=function(){function a(a){this._refCount=1,this._uuid=f().generate(),this._type=c("type",a),e(this._uuid,a,1)}return a.prototype.addRef=function(a){return this._refCount++,e(this._uuid,this._type,1),this._refCount},a.prototype.release=function(a){this._refCount--,e(this._uuid,this._type,-1);var b=this._refCount;return 0===b&&(this.destructor(!0),this._refCount=void 0,this._type=void 0,this._uuid=void 0),b},a.prototype.destructor=function(a){void 0===a&&(a=!1),a&&console.warn("`protected destructor(): void` method should be implemented by `"+this._type+"`.")},Object.defineProperty(a.prototype,"uuid",{get:function(){return this._uuid},set:function(a){throw new Error(d("uuid").message)},enumerable:!0,configurable:!0}),a}();return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/collections/IUnknownArray",["require","exports","../utils/Shareable"],function(a,b,c){function d(a){return"IUnknownArray:"+a}function e(a,b){if(a){for(var c=new g(a,b),d=0,e=a.length;e>d;d++){var f=a[d];f&&f.release()}return c}return void 0}var g=function(a){function b(b,c){void 0===b&&(b=[]),a.call(this,d(c)),this._elements=b;for(var e=0,f=this._elements.length;f>e;e++)this._elements[e].addRef();this.userName=c}return f(b,a),b.prototype.destructor=function(){for(var b=0,c=this._elements.length;c>b;b++)this._elements[b].release();this._elements=void 0,a.prototype.destructor.call(this)},b.prototype.get=function(a){var b=this.getWeakRef(a);return b&&b.addRef(),b},b.prototype.getWeakRef=function(a){return this._elements[a]},b.prototype.indexOf=function(a,b){return this._elements.indexOf(a,b)},Object.defineProperty(b.prototype,"length",{get:function(){return this._elements?this._elements.length:void console.warn(d(this.userName)+" is now a zombie, length is undefined")},enumerable:!0,configurable:!0}),b.prototype.slice=function(a,c){return new b(this._elements.slice(a,c),"IUnknownArray.slice()")},b.prototype.splice=function(a,b){return e(this._elements.splice(a,b),"IUnknownArray.slice()")},b.prototype.shift=function(){return this._elements.shift()},b.prototype.forEach=function(a){return this._elements.forEach(a)},b.prototype.push=function(a){return a&&a.addRef(),this.pushWeakRef(a)},b.prototype.pushWeakRef=function(a){return this._elements.push(a)},b.prototype.pop=function(){return this._elements.pop()},b.prototype.unshift=function(a){return a.addRef(),this.unshiftWeakRef(a)},b.prototype.unshiftWeakRef=function(a){return this._elements.unshift(a)},b}(c);return g}),b("davinci-eight/checks/isNumber",["require","exports"],function(a,b){function c(a){return"number"==typeof a}return c}),b("davinci-eight/checks/mustBeNumber",["require","exports","../checks/mustSatisfy","../checks/isNumber"],function(a,b,c,d){function e(){return"be a `number`"}function f(a,b,f){return c(a,d(b),e,f),b}return f}),b("davinci-eight/math/clamp",["require","exports","../checks/mustBeNumber"],function(a,b,c){function d(a,b,d){return c("x",a),c("min",b),c("max",d),b>a?b:a>d?d:a}return d}),b("davinci-eight/checks/isUndefined",["require","exports"],function(a,b){function c(a){return"undefined"==typeof a}return c}),b("davinci-eight/checks/expectArg",["require","exports","../checks/isUndefined","../checks/mustBeNumber"],function(a,b,c,d){function e(a,b){return c(b)?a:b()}function f(a,b){var f={toSatisfy:function(a,b){if(c(a))throw new Error("condition must be specified");if(c(b))throw new Error("message must be specified");if(!a)throw new Error(b);return f},toBeBoolean:function(c){var d=typeof b;if("boolean"!==d)throw new Error(e("Expecting argument "+a+": "+d+" to be a boolean.",c));return f},toBeDefined:function(){var c=typeof b;if("undefined"===c){var d="Expecting argument "+a+": "+c+" to be defined.";throw new Error(d)}return f},toBeInClosedInterval:function(c,e){var g=b,h=g;if(d("x",h),h>=c&&e>=h)return f;var i="Expecting argument "+a+" => "+b+" to be in the range ["+c+", "+e+"].";throw new Error(i)},toBeFunction:function(){var c=typeof b;if("function"!==c){var d="Expecting argument "+a+": "+c+" to be a function.";throw new Error(d)}return f},toBeNumber:function(c){var d=typeof b;if("number"!==d)throw new Error(e("Expecting argument "+a+": "+d+" to be a number.",c));return f},toBeObject:function(c){var d=typeof b;if("object"!==d)throw new Error(e("Expecting argument "+a+": "+d+" to be an object.",c));return f},toBeString:function(){var c=typeof b;if("string"!==c){var d="Expecting argument "+a+": "+c+" to be a string.";throw new Error(d)}return f},toBeUndefined:function(){var c=typeof b;if("undefined"!==c){var d="Expecting argument "+a+": "+c+" to be undefined.";throw new Error(d)}return f},toNotBeNull:function(){if(null===b){var c="Expecting argument "+a+" to not be null.";throw new Error(c)}return f},get value(){return b}};return f}return f}),b("davinci-eight/core/principalAngle",["require","exports"],function(a,b){function c(a){return a>2*Math.PI?c(a-2*Math.PI):0>a?c(a+2*Math.PI):a}return c}),b("davinci-eight/core/Color",["require","exports","../math/clamp","../checks/expectArg","../checks/mustBeNumber","../core/principalAngle"],function(a,b,c,d,e,f){var g=function(){function a(a){void 0===a&&(a=[0,0,0]),this.modified=!1,d("data",a).toSatisfy(3===a.length,"data must have length equal to 3"),this.data=a}return Object.defineProperty(a.prototype,"red",{get:function(){return this.data[0]},set:function(a){this.data[0]=c(a,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"green",{get:function(){return this.data[1]},set:function(a){this.data[1]=c(a,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"blue",{get:function(){return this.data[2]},set:function(a){this.data[2]=c(a,0,1)},enumerable:!0,configurable:!0}),a.prototype.clone=function(){return new a([this.data[0],this.data[1],this.data[2]])},a.prototype.interpolate=function(a,b){return this.red+=(a.red-this.red)*b,this.green+=(a.green-this.green)*b,this.blue+=(a.blue-this.blue)*b,this},Object.defineProperty(a.prototype,"luminance",{get:function(){return a.luminance(this.red,this.green,this.blue)},enumerable:!0,configurable:!0}),a.prototype.toString=function(){return"Color("+this.red+", "+this.green+", "+this.blue+")"},a.luminance=function(a,b,c){e("red",a),e("green",b),e("blue",c);var d=2.2;return.2126*Math.pow(a,d)+.7152*Math.pow(b,d)+.0722*Math.pow(c,d)},a.fromHSL=function(b,c,d){function g(b,c,e){var f=(a.luminance(b,c,e),d-.5*h);return new a([b+f,c+f,e+f])}e("H",b),e("S",c),e("L",d);var h=(1-Math.abs(2*d-1))*c,i=f(b)/Math.PI*3%6,j=h*(1-Math.abs(i%2-1));return i>=0&&1>i?g(h,j,0):i>=1&&2>i?g(j,h,0):i>=2&&3>i?g(0,h,h*(i-2)):i>=3&&4>i?g(0,h*(4-i),h):i>=4&&5>i?g(j,0,h):i>=5&&6>i?g(h,0,j):g(0,0,0)},a.fromRGB=function(b,c,f){return e("red",b),e("green",c),e("blue",f),d("red",b).toBeNumber().toBeInClosedInterval(0,1),d("green",c).toBeNumber().toBeInClosedInterval(0,1),d("blue",f).toBeNumber().toBeInClosedInterval(0,1),new a([b,c,f])},a.copy=function(b){return new a([b.red,b.green,b.blue])},a.interpolate=function(b,c,d){return a.copy(b).interpolate(c,d)},a.black=new a([0,0,0]),a.blue=new a([0,0,1]),a.green=new a([0,1,0]),a.cyan=new a([0,1,1]),a.red=new a([1,0,0]),a.magenta=new a([1,0,1]),a.yellow=new a([1,1,0]),a.white=new a([1,1,1]),a}();return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/animations/ColorAnimation",["require","exports","../../utils/Shareable","../../core/Color"],function(a,b,c,d){var e=function(a){function b(b,c,e,f){void 0===c&&(c=300),a.call(this,"ColorAnimation"),this.from=void 0,this.to=d.copy(b),this.duration=c,this.start=0,this.fraction=0,this.callback=e,this.ease=f}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.apply=function(a,b,c,e){if(!this.start&&(this.start=c-e,void 0===this.from)){var f=a.getProperty(b);f&&(this.from=new d(f))}var g,h=this.from,i=this.to,j=this.ease;g=this.duration>0?Math.min(1,(c-this.start)/(this.duration||1)):1,this.fraction=g;var k;switch(j){case"in":k=1-(1-g)*(1-g);break;case"out":k=g*g;break;case"linear":k=g;break;default:k=.5-.5*Math.cos(g*Math.PI)}a.setProperty(b,d.interpolate(h,i,k).data)},b.prototype.hurry=function(a){this.duration=this.duration*this.fraction+this.duration*(1-this.fraction)/a},b.prototype.skip=function(a,b){this.duration=0,this.fraction=1,this.done(a,b)},b.prototype.extra=function(a){return a-this.start-this.duration},b.prototype.done=function(a,b){return 1===this.fraction?(a.setProperty(b,this.to.data),this.callback&&this.callback(),this.callback=void 0,!0):!1},b.prototype.undo=function(a,b){this.from&&(a.setProperty(b,this.from.data),this.from=void 0,this.start=void 0,this.fraction=0)},b}(c);return e}),b("davinci-eight/checks/isDefined",["require","exports"],function(a,b){function c(a){return"undefined"!=typeof a}return c}),b("davinci-eight/math/VectorN",["require","exports","../checks/expectArg","../checks/isDefined","../checks/isUndefined"],function(a,b,c,d,e){function f(a){return"new VectorN<"+a+">(data: "+a+"[], modified: boolean = false, size?: number)"}function g(a){return"push(value: "+a+"): number"}function h(a){return"pop(): "+a}function i(a,b,c){return b+" must be a "+c+" in "+a}function j(a,b,c){return b+" length must be "+c+" in "+a}function k(){return i(f("T"),"data","T[]")}function l(a){return function(){return j(f("T"),"data",a)}}function m(a){return a+" is not allowed for a fixed size vector"}function n(){return m(g("T"))}function o(){return m(h("T"))}function p(){return i(f("T"),"modified","boolean")}function q(){return i(f("T"),"size","number")}var r=function(){function a(a,b,e){void 0===b&&(b=!1);var f=c("data",a).toBeObject(k);this.modified=c("modified",b).toBeBoolean(p).value,d(e)?(this._size=c("size",e).toBeNumber(q).toSatisfy(e>=0,"size must be positive").value,this._data=f.toSatisfy(a.length===e,l(e)()).value):(this._size=void 0,this._data=f.value)}return Object.defineProperty(a.prototype,"data",{get:function(){if(this._data)return this._data;if(this._callback){var a=this._callback();return d(this._size)&&c("callback()",a).toSatisfy(a.length===this._size,"callback() length must be "+this._size),this._callback()}throw new Error("Vector"+this._size+" is undefined.")},set:function(a){d(this._size)&&c("data",a).toSatisfy(a.length===this._size,"data length must be "+this._size),this._data=a,this._callback=void 0,this.modified=!0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"callback",{get:function(){return this._callback},set:function(a){this._callback=a,this._data=void 0,this.modified=!0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"length",{get:function(){return this.data.length},enumerable:!0,configurable:!0}),a.prototype.clone=function(){return new a(this._data,this.modified,this._size)},a.prototype.getComponent=function(a){return this.data[a]},a.prototype.pop=function(){if(e(this._size))return this.data.pop();throw new Error(o())},a.prototype.push=function(a){if(e(this._size)){var b=this.data,c=b.push(a);return this.data=b,c}throw new Error(n())},a.prototype.setComponent=function(a,b){var c=this.data,d=c[a];b!==d&&(c[a]=b,this.data=c,this.modified=!0)},a.prototype.toArray=function(a,b){void 0===a&&(a=[]),void 0===b&&(b=0);for(var c=this.data,d=c.length,e=0;d>e;e++)a[b+e]=c[e];return a},a.prototype.toLocaleString=function(){return this.data.toLocaleString()},a.prototype.toString=function(){return this.data.toString()},a}();return r}),b("davinci-eight/math/wedgeXY",["require","exports"],function(a,b){function c(a,b,c,d,e,f){return a*e-b*d}return c}),b("davinci-eight/math/wedgeYZ",["require","exports"],function(a,b){function c(a,b,c,d,e,f){return b*f-c*e}return c}),b("davinci-eight/math/wedgeZX",["require","exports"],function(a,b){function c(a,b,c,d,e,f){return c*d-a*f}return c});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/Vector3",["require","exports","../checks/expectArg","../checks/isNumber","../math/VectorN","../math/wedgeXY","../math/wedgeYZ","../math/wedgeZX"],function(a,b,c,d,e,g,h,i){var j=function(a){function b(b,c){void 0===b&&(b=[0,0,0]),void 0===c&&(c=!1),a.call(this,b,c,3)}return f(b,a),b.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z},Object.defineProperty(b.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.modified=this.modified||this.x!==a,this.data[0]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this.data[1]},set:function(a){this.modified=this.modified||this.y!==a,this.data[1]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"z",{get:function(){return this.data[2]},set:function(a){this.modified=this.modified||this.z!==a,this.data[2]=a},enumerable:!0,configurable:!0}),b.prototype.add=function(a){return this.sum(this,a)},b.prototype.sum=function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},b.prototype.applyMatrix3=function(a){var b=this.x,c=this.y,d=this.z,e=a.data;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this},b.prototype.applyMatrix4=function(a){var b=this.x,c=this.y,d=this.z,e=a.data;return this.x=e[0]*b+e[4]*c+e[8]*d+e[12],this.y=e[1]*b+e[5]*c+e[9]*d+e[13],this.z=e[2]*b+e[6]*c+e[10]*d+e[14],this},b.prototype.reflect=function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,h=2*(b*e+c*f+d*g);return this.x=b-h*e,this.y=c-h*f,this.z=d-h*g,this},b.prototype.rotate=function(a){var b=this.x,c=this.y,d=this.z,e=a.xy,f=a.yz,g=a.zx,h=a.w,i=h*b-g*d+e*c,j=h*c-e*b+f*d,k=h*d-f*c+g*b,l=f*b+g*c+e*d;return this.x=i*h+l*f+j*e-k*g,this.y=j*h+l*g+k*f-i*e,this.z=k*h+l*e+i*g-j*f,this},b.prototype.clone=function(){return new b([this.x,this.y,this.z])},b.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},b.prototype.cross=function(a){return this.crossVectors(this,a)},b.prototype.crossVectors=function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,j=b.y,k=b.z,l=h(c,d,e,f,j,k),m=i(c,d,e,f,j,k),n=g(c,d,e,f,j,k);return this.set(l,m,n),this},b.prototype.distanceTo=function(a){return Math.sqrt(this.quadranceTo(a))},b.prototype.quadranceTo=function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},b.prototype.divideScalar=function(a){if(0!==a){var b=1/a;this.x*=b,this.y*=b,this.z*=b}else this.x=0,this.y=0,this.z=0;return this},b.prototype.dot=function(a){return b.dot(this,a)},b.prototype.magnitude=function(){return Math.sqrt(this.quaditude())},b.prototype.quaditude=function(){var a=this.x,b=this.y,c=this.z;return a*a+b*b+c*c},b.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},b.prototype.normalize=function(){return this.divideScalar(this.magnitude())},b.prototype.multiply=function(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this},b.prototype.scale=function(a){return this.x*=a,this.y*=a,this.z*=a,this},b.prototype.set=function(a,b,d){return this.x=c("x",a).toBeNumber().value,this.y=c("y",b).toBeNumber().value,this.z=c("z",d).toBeNumber().value,this},b.prototype.setMagnitude=function(a){var b=this.magnitude();if(0!==b)return a!==b?this.scale(a/b):this;throw new Error("Attempting to set the magnitude of a null vector.")},b.prototype.setX=function(a){return this.x=a,this},b.prototype.setY=function(a){return this.y=a,this},b.prototype.setZ=function(a){return this.z=a,this},b.prototype.sub=function(a){return this.difference(this,a)},b.prototype.difference=function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},b.prototype.toString=function(){return"Vector3({x: "+this.x+", y: "+this.y+", z: "+this.z+"})"},b.prototype.__add__=function(a){return a instanceof b?this.clone().add(a):void 0},b.prototype.__sub__=function(a){return a instanceof b?this.clone().sub(a):void 0},b.prototype.__mul__=function(a){return d(a)?this.clone().scale(a):void 0},b.copy=function(a){return new b([a.x,a.y,a.z])},b.lerp=function(a,c,d){return b.copy(c).sub(a).scale(d).add(a)},b.random=function(){return new b([Math.random(),Math.random(),Math.random()])},b.e1=new b([1,0,0]),b.e2=new b([0,1,0]),b.e3=new b([0,0,1]),b}(e);return j});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/animations/Vector3Animation",["require","exports","../../utils/Shareable","../../math/Vector3"],function(a,b,c,d){var e=function(a){function b(b,c,e,f){void 0===c&&(c=300),a.call(this,"Vector3Animation"),this.to=d.copy(b),this.duration=c,this.fraction=0,this.callback=e,this.ease=f}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.apply=function(a,b,c,e){if(!this.start&&(this.start=c-e,void 0===this.from)){var f=a.getProperty(b);f&&(this.from=new d(f))}var g,h=this.ease;g=this.duration>0?Math.min(1,(c-this.start)/(this.duration||1)):1,this.fraction=g;var i;switch(h){case"in":i=1-(1-g)*(1-g);break;case"out":i=g*g;break;case"linear":i=g;break;default:i=.5-.5*Math.cos(g*Math.PI)}var j=d.lerp(this.from,this.to,i);a.setProperty(b,j.data)},b.prototype.hurry=function(a){this.duration=this.duration*this.fraction+this.duration*(1-this.fraction)/a},b.prototype.skip=function(a,b){this.duration=0,this.fraction=1,this.done(a,b)},b.prototype.extra=function(a){return a-this.start-this.duration},b.prototype.done=function(a,b){return 1===this.fraction?(a.setProperty(b,this.to.data),this.callback&&this.callback(),this.callback=void 0,!0):!1},b.prototype.undo=function(a,b){this.from&&(a.setProperty(b,this.from.data),this.from=void 0,this.start=void 0,this.fraction=0)},b}(c);return e}),b("davinci-eight/math/dotVector3",["require","exports"],function(a,b){function c(a,b){return a.x*b.x+a.y*b.y+a.z*b.z}return c}),b("davinci-eight/math/quaditude3",["require","exports"],function(a,b){function c(a){var b=a.x,c=a.y,d=a.z;return b*b+c*c+d*d}return c});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/Spinor3",["require","exports","../math/VectorN","../math/dotVector3","../checks/mustBeNumber","../math/quaditude3","../math/wedgeXY","../math/wedgeYZ","../math/wedgeZX"],function(a,b,c,d,e,g,h,i,j){var k=function(a){function b(b,c){void 0===b&&(b=[0,0,0,1]),void 0===c&&(c=!1),a.call(this,b,c,4)}return f(b,a),Object.defineProperty(b.prototype,"yz",{get:function(){return this.data[0]},set:function(a){e("yz",a),this.modified=this.modified||this.yz!==a,this.data[0]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"zx",{get:function(){return this.data[1]},set:function(a){e("zx",a),this.modified=this.modified||this.zx!==a,this.data[1]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"xy",{get:function(){return this.data[2]},set:function(a){e("xy",a),this.modified=this.modified||this.xy!==a,this.data[2]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"w",{get:function(){return this.data[3]},set:function(a){e("w",a),this.modified=this.modified||this.w!==a,this.data[3]=a},enumerable:!0,configurable:!0}),b.prototype.add=function(a){return this},b.prototype.clone=function(){return new b([this.yz,this.zx,this.xy,this.w])},b.prototype.conjugate=function(){return this.yz*=-1,this.zx*=-1,this.xy*=-1,this},b.prototype.copy=function(a){return this.yz=a.yz,this.zx=a.zx,this.xy=a.xy,this.w=a.w,this},b.prototype.difference=function(a,b){return this},b.prototype.divideScalar=function(a){return this.yz/=a,this.zx/=a,this.xy/=a,this.w/=a,this},b.prototype.dual=function(a){return this.yz=a.x,this.zx=a.y,this.xy=a.z,this.w=0,this},b.prototype.exp=function(){var a=this.w,b=this.yz,c=this.zx,d=this.xy,e=Math.exp(a),f=Math.sqrt(b*b+c*c+d*d),g=e*(0!==f?Math.sin(f)/f:1);return this.w=e*Math.cos(f),this.yz=b*g,this.zx=c*g,this.xy=d*g,this},b.prototype.inverse=function(){return this.conjugate(),this.divideScalar(this.quaditude()),this},b.prototype.lerp=function(a,c){var d=b.copy(a),e=this.clone(),f=d.multiply(e.inverse());return f.log(),f.scale(c),f.exp(),this.copy(f),this},b.prototype.log=function(){var a=this.w,b=this.yz,c=this.zx,d=this.xy,e=b*b+c*c+d*d,f=Math.sqrt(e),g=Math.abs(a),h=Math.sqrt(a*a+e);this.w=Math.log(h);var i=Math.atan2(f,g)/f;return this.yz=b*i,this.zx=c*i,this.xy=d*i,this},b.prototype.magnitude=function(){return Math.sqrt(this.quaditude())},b.prototype.multiply=function(a){return this.product(this,a)},b.prototype.scale=function(a){return this.yz*=a,this.zx*=a,this.xy*=a,this.w*=a,this},b.prototype.product=function(a,b){var c=a.w,d=a.yz,e=a.zx,f=a.xy,g=b.w,h=b.yz,i=b.zx,j=b.xy;return this.w=c*g-d*h-e*i-f*j,this.yz=c*h+d*g-e*j+f*i,this.zx=c*i+d*j+e*g-f*h,this.xy=c*j-d*i+e*h+f*g,this},b.prototype.quaditude=function(){var a=this.w,b=this.yz,c=this.zx,d=this.xy;return a*a+b*b+c*c+d*d},b.prototype.reverse=function(){return this.yz*=-1,this.zx*=-1,this.xy*=-1,this},b.prototype.reflect=function(a){var b=this.w,c=this.yz,d=this.zx,e=this.xy,f=a.x,g=a.y,h=a.z,i=f*f+g*g+h*h,j=f*c+g*d+h*e;return this.w=i*b,this.xy=2*h*j-i*e,this.yz=2*f*j-i*c,this.zx=2*g*j-i*d,this},b.prototype.rotate=function(a){return console.warn("Spinor3.rotate is not implemented"),this},b.prototype.rotor=function(a,b){var c=Math.sqrt(g(a)),e=Math.sqrt(g(b));a={x:a.x/c,y:a.y/c,z:a.z/c},b={x:b.x/e,y:b.y/e,z:b.z/e},this.spinor(a,b),this.w+=1;var f=Math.sqrt(2*(1+d(a,b)));return this.divideScalar(f),this},b.prototype.sub=function(a){return this},b.prototype.sum=function(a,b){return this},b.prototype.spinor=function(a,b){var c=a.x,e=a.y,f=a.z,g=b.x,k=b.y,l=b.z;return this.w=d(a,b),this.yz=i(c,e,f,g,k,l),this.zx=j(c,e,f,g,k,l),this.xy=h(c,e,f,g,k,l),this},b.prototype.toString=function(){return"Spinor3({yz: "+this.yz+", zx: "+this.zx+", xy: "+this.xy+", w: "+this.w+"})"},b.copy=function(a){return(new b).copy(a)},b.lerp=function(a,c,d){return b.copy(a).lerp(c,d)},b}(c);return k});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/animations/Spinor3Animation",["require","exports","../../utils/Shareable","../../math/Spinor3"],function(a,b,c,d){var e=function(a){function b(b,c,e,f){void 0===c&&(c=300),a.call(this,"Spinor3Animation"),this.from=void 0,this.to=d.copy(b),this.duration=c,this.start=0,this.fraction=0,this.callback=e,this.ease=f}return f(b,a),b.prototype.destructor=function(){},b.prototype.apply=function(a,b,c,e){if(!this.start&&(this.start=c-e,void 0===this.from)){var f=a.getProperty(b);f&&(this.from=new d(f))}var g,h=this.from,i=this.to,j=this.ease;g=this.duration>0?Math.min(1,(c-this.start)/(this.duration||1)):1,this.fraction=g;var k;switch(j){case"in":k=1-(1-g)*(1-g);break;case"out":k=g*g;break;case"linear":k=g;break;default:k=.5-.5*Math.cos(g*Math.PI)}var l=d.lerp(h,i,g);a.setProperty(b,l.data)},b.prototype.hurry=function(a){this.duration=this.duration*this.fraction+this.duration*(1-this.fraction)/a},b.prototype.skip=function(a,b){this.duration=0,this.fraction=1,this.done(a,b)},b.prototype.extra=function(a){return a-this.start-this.duration},b.prototype.done=function(a,b){return 1===this.fraction?(a.setProperty(b,this.to.data),this.callback&&this.callback(),this.callback=void 0,!0):!1},b.prototype.undo=function(a,b){this.from&&(a.setProperty(b,this.from.data),this.from=void 0,this.start=void 0,this.fraction=0)},b}(c);return e});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/commands/AnimateDrawableCommand",["require","exports","../../utils/Shareable"],function(a,b,c){var d=function(a){function b(b,c,d,e){a.call(this,"AnimateDrawableCommand"),this.drawableName=b,this.facetName=c,this.propName=d,this.animation=e,this.animation.addRef()}return f(b,a),b.prototype.destructor=function(){this.animation.release(),this.animation=void 0,a.prototype.destructor.call(this)},b.prototype.redo=function(a,b){var c=b.getDrawable(this.drawableName),d=c.getFacet(this.facetName);a.pushAnimation(d,this.propName,this.animation)},b.prototype.undo=function(a,b){var c=b.getDrawable(this.drawableName),d=c.getFacet(this.facetName),e=a.popAnimation(d,this.propName);e.release()},b}(c);return d}),b("davinci-eight/core/Symbolic",["require","exports"],function(a,b){var c=function(){function a(){}return a.ATTRIBUTE_COLOR="aColor",a.ATTRIBUTE_GEOMETRY_INDEX="aGeometryIndex",a.ATTRIBUTE_NORMAL="aNormal",a.ATTRIBUTE_POSITION="aPosition",a.ATTRIBUTE_TEXTURE_COORDS="aTextureCoords",a.UNIFORM_AMBIENT_LIGHT="uAmbientLight",a.UNIFORM_COLOR="uColor",a.UNIFORM_DIRECTIONAL_LIGHT_COLOR="uDirectionalLightColor",a.UNIFORM_DIRECTIONAL_LIGHT_DIRECTION="uDirectionalLightDirection",a.UNIFORM_POINT_LIGHT_COLOR="uPointLightColor",a.UNIFORM_POINT_LIGHT_POSITION="uPointLightPosition",a.UNIFORM_POINT_SIZE="uPointSize",a.UNIFORM_PROJECTION_MATRIX="uProjection",a.UNIFORM_MODEL_MATRIX="uModel",a.UNIFORM_NORMAL_MATRIX="uNormal",a.UNIFORM_VIEW_MATRIX="uView",a.VARYING_COLOR="vColor",a.VARYING_LIGHT="vLight",a}();return c});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/uniforms/ColorFacet",["require","exports","../utils/Shareable","../core/Symbolic","../math/Vector3"],function(a,b,c,d,e){
var g=function(a){function b(b){void 0===b&&(b=d.UNIFORM_COLOR),a.call(this,"ColorFacet"),this.data=new e([1,1,1]),this.data.modified=!0,this.name=b}return f(b,a),b.prototype.destructor=function(){this.data=void 0,a.prototype.destructor.call(this)},b.prototype.incRef=function(){return this.addRef(),this},b.prototype.decRef=function(){return this.release(),this},Object.defineProperty(b.prototype,"red",{get:function(){return this.data.x},set:function(a){this.data.x=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"green",{get:function(){return this.data.y},set:function(a){this.data.y=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"blue",{get:function(){return this.data.z},set:function(a){this.data.z=a},enumerable:!0,configurable:!0}),b.prototype.scale=function(a){return this.red*=a,this.green*=a,this.blue*=a,this},b.prototype.setColor=function(a){return this.red=a.red,this.green=a.green,this.blue=a.blue,this},b.prototype.setRGB=function(a,b,c){return this.red=a,this.green=b,this.blue=c,this},b.prototype.getProperty=function(a){switch(a){case b.PROP_RGB:return[this.red,this.green,this.blue];case b.PROP_RED:return[this.red];default:return void console.warn("ColorFacet.getProperty "+a)}},b.prototype.setProperty=function(a,c){switch(a){case b.PROP_RGB:this.red=c[0],this.green=c[1],this.blue=c[2];break;case b.PROP_RED:this.red=c[0];break;default:console.warn("ColorFacet.setProperty "+a)}},b.prototype.setUniforms=function(a,b){a.uniformCartesian3(this.name,this.data,b)},b.PROP_RGB="rgb",b.PROP_RED="red",b}(c);return g}),b("davinci-eight/i18n/cannotAssignTypeToProperty",["require","exports","../checks/mustBeString"],function(a,b,c){function d(a,b){c("type",a),c("name",b);var d={get message(){return"Cannot assign type `"+a+"` to property `"+b+"`."}};return d}return d}),b("davinci-eight/geometries/computeFaceNormals",["require","exports","../core/Symbolic","../math/Vector3","../math/wedgeXY","../math/wedgeYZ","../math/wedgeZX"],function(a,b,c,d,e,f,g){function h(a,b,h){void 0===b&&(b=c.ATTRIBUTE_POSITION),void 0===h&&(h=c.ATTRIBUTE_NORMAL);var i=a.vertices[0].attributes,j=a.vertices[1].attributes,k=a.vertices[2].attributes,l=i[b],m=j[b],n=k[b],o=l.getComponent(0),p=l.getComponent(1),q=l.getComponent(2),r=m.getComponent(0),s=m.getComponent(1),t=m.getComponent(2),u=n.getComponent(0),v=n.getComponent(1),w=n.getComponent(2),x=u-r,y=v-s,z=w-t,A=o-r,B=p-s,C=q-t,D=f(x,y,z,A,B,C),E=g(x,y,z,A,B,C),F=e(x,y,z,A,B,C),G=new d([D,E,F]).normalize();i[h]=G,j[h]=G,k[h]=G}return h}),b("davinci-eight/core",["require","exports"],function(a,b){var c={strict:!1,GITHUB:"https://github.com/geometryzen/davinci-eight",APIDOC:"http://www.mathdoodle.io/vendor/davinci-eight@2.102.0/documentation/index.html",LAST_MODIFIED:"2015-10-16",NAMESPACE:"EIGHT",verbose:!0,VERSION:"2.132.0"};return c}),b("davinci-eight/feedback/feedback",["require","exports","../core"],function(a,b,c){var d={warn:function(a){if(c.strict)throw new Error(a.message);console.warn(a.message)}};return d}),b("davinci-eight/geometries/GeometryElements",["require","exports"],function(a,b){var c=function(){function a(a,b){this.data=a,this.meta=b}return a}();return c}),b("davinci-eight/checks/isInteger",["require","exports","../checks/isNumber"],function(a,b,c){function d(a){return c(a)&&a%1===0}return d}),b("davinci-eight/checks/mustBeInteger",["require","exports","../checks/mustSatisfy","../checks/isInteger"],function(a,b,c,d){function e(){return"be an integer"}function f(a,b,f){return c(a,d(b),e,f),b}return f}),b("davinci-eight/geometries/Vertex",["require","exports"],function(a,b){function c(a,b){return b?a+b.toString():a}function d(a){var b=a.attributes,d=Object.keys(b).map(function(a){var d=b[a];return c(a,d)}).join(" ");return d}var e=function(){function a(){this.opposing=[],this.attributes={}}return a.prototype.toString=function(){return d(this)},a}();return e}),b("davinci-eight/geometries/Simplex",["require","exports","../checks/expectArg","../checks/isInteger","../geometries/Vertex","../math/VectorN"],function(a,b,c,d,e,f){function g(a,b,e,f){return d(b)&&b>=e&&f>=b?b:void c(a,b).toSatisfy(!1,a+" must be an integer in the range ["+e+","+f+"]")}function h(a){return g("count",a,0,7)}function i(a,b){return a.concat(b)}function j(a,b,d,e){void 0===e&&(e=[]),c("b",b).toSatisfy(a.length===b.length,"a must be the same length as b");var f,g=a.length,h=1-d;for(f=0;g>f;f++)e.push(h*a[f]+d*b[f]);return e}function k(a,b,c){for(var d={},e=Object.keys(a),f=e.length,g=0;f>g;g++){var h=e[g];d[h]=l(a[h],b[h],c)}return d}function l(a,b,c){return new f(j(a.data,b.data,c))}var m=function(){function a(a){this.vertices=[],d(a)||c("k",a).toBeNumber();for(var b=a+1,f=0;b>f;f++)this.vertices.push(new e);var g=this;this.vertices.forEach(function(a){a.parent=g})}return Object.defineProperty(a.prototype,"k",{get:function(){return this.vertices.length-1},enumerable:!0,configurable:!0}),a.indices=function(a){return a.vertices.map(function(a){return a.index})},a.boundaryMap=function(b){var c=(b.vertices,b.k);if(c===a.K_FOR_TRIANGLE){var d=new a(c-1);d.vertices[0].parent=d,d.vertices[0].attributes=b.vertices[0].attributes,d.vertices[1].parent=d,d.vertices[1].attributes=b.vertices[1].attributes;var e=new a(c-1);e.vertices[0].parent=e,e.vertices[0].attributes=b.vertices[1].attributes,e.vertices[1].parent=e,e.vertices[1].attributes=b.vertices[2].attributes;var f=new a(c-1);return f.vertices[0].parent=f,f.vertices[0].attributes=b.vertices[2].attributes,f.vertices[1].parent=f,f.vertices[1].attributes=b.vertices[0].attributes,[d,e,f]}if(c===a.K_FOR_LINE_SEGMENT){var g=new a(c-1);g.vertices[0].parent=g,g.vertices[0].attributes=b.vertices[0].attributes;var h=new a(c-1);return h.vertices[0].parent=h,h.vertices[0].attributes=b.vertices[1].attributes,[g,h]}if(c===a.K_FOR_POINT)return[new a(c-1)];if(c===a.K_FOR_EMPTY)return[];throw new Error("Unexpected k-simplex, k = "+b.k+" @ Simplex.boundaryMap()")},a.subdivideMap=function(b){c("simplex",b).toBeObject();var d=[],e=b.vertices,f=b.k;if(f===a.K_FOR_TRIANGLE){var g=e[0].attributes,h=e[1].attributes,i=e[2].attributes,j=k(g,h,.5),l=k(h,i,.5),m=k(i,g,.5),n=new a(f);n.vertices[0].attributes=i,n.vertices[1].attributes=m,n.vertices[2].attributes=l;var o=new a(f);o.vertices[0].attributes=g,o.vertices[1].attributes=j,o.vertices[2].attributes=m;var p=new a(f);p.vertices[0].attributes=h,p.vertices[1].attributes=l,p.vertices[2].attributes=j;var q=new a(f);q.vertices[0].attributes=j,q.vertices[1].attributes=l,q.vertices[2].attributes=m,d.push(n),d.push(o),d.push(p),d.push(q)}else if(f===a.K_FOR_LINE_SEGMENT){var g=e[0].attributes,h=e[1].attributes,r=k(g,h,.5),s=new a(f);s.vertices[0].attributes=g,s.vertices[1].attributes=r;var t=new a(f);t.vertices[0].attributes=r,t.vertices[1].attributes=h,d.push(s),d.push(t)}else if(f===a.K_FOR_POINT)d.push(b);else if(f!==a.K_FOR_EMPTY)throw new Error(f+"-simplex is not supported");return d},a.boundary=function(b,c){void 0===c&&(c=1),h(c);for(var d=0;c>d;d++)b=b.map(a.boundaryMap).reduce(i,[]);return b},a.subdivide=function(b,c){void 0===c&&(c=1),h(c);for(var d=0;c>d;d++)b=b.map(a.subdivideMap).reduce(i,[]);return b},a.setAttributeValues=function(a,b){var c,d=Object.keys(a),e=d.length;for(c=0;e>c;c++){var f=d[c],g=a[f],h=g.length,i=void 0;for(i=0;h>i;i++)b.vertices[i].attributes[f]=g[i]}},a.K_FOR_EMPTY=-1,a.K_FOR_POINT=0,a.K_FOR_LINE_SEGMENT=1,a.K_FOR_TRIANGLE=2,a.K_FOR_TETRAHEDRON=3,a.K_FOR_FIVE_CELL=4,a}();return m}),b("davinci-eight/geometries/toGeometryMeta",["require","exports","../checks/expectArg","../checks/isDefined","../geometries/Simplex"],function(a,b,c,d,e){function f(a,b){var c=[];return JSON.stringify(a,function(a,b){if("object"==typeof b&&null!==b){if(-1!==c.indexOf(b))return;c.push(b)}return b},b)}function g(a){for(var b=void 0,g={},h=a.length,i=0;h>i;i++){var j=a[i];j instanceof e||c("simplex",j).toSatisfy(!1,"Every element must be a Simplex @ toGeometryMeta(). Found "+f(j,2));var k=j.vertices;b=j.k;for(var l=0,m=k.length;m>l;l++)for(var n=k[l],o=n.attributes,p=Object.keys(o),q=p.length,r=0;q>r;r++){var s=p[r],t=o[s],u=g[s];if(u){if(u.size!==t.length)throw new Error("Something is rotten in Denmark!")}else g[s]={size:t.length}}}if(d(b)){var v={get attributes(){return g},get k(){return b}};return v}return void 0}return g}),b("davinci-eight/geometries/computeUniqueVertices",["require","exports"],function(a,b){function c(a){function b(a){var b=a.toString();if(c[b]){var e=c[b];a.index=e.index}else a.index=d.length,d.push(a),c[b]=a}var c={},d=[];return a.forEach(function(a){a.vertices.forEach(function(a){b(a)})}),d}return c}),b("davinci-eight/geometries/GeometryData",["require","exports","../checks/expectArg","../math/VectorN"],function(a,b,c,d){var e=function(){function a(a,b,e){this.attributes={},c("indices",b).toBeObject().toSatisfy(b instanceof d,"indices must be a VectorN<number>"),c("attributes",e).toBeObject(),this.k=a,this.indices=b,this.attributes=e}return a}();return e}),b("davinci-eight/geometries/GeometryAttribute",["require","exports","../math/VectorN"],function(a,b,c){function d(a){return a instanceof c}function e(a){if(!d(a))throw new Error("values must be a VectorN");return a}function f(a,b){return a%b===0}function g(a,b){if("number"!=typeof a)throw new Error("size must be a number");if(!f(b.length,a))throw new Error("values.length must be an exact multiple of size");return a}var h=function(){function a(a,b){this.values=e(a),this.size=g(b,a)}return a}();return h}),b("davinci-eight/geometries/toGeometryData",["require","exports","../geometries/toGeometryMeta","../geometries/computeUniqueVertices","../geometries/GeometryData","../geometries/GeometryAttribute","../checks/expectArg","../geometries/Simplex","../math/VectorN"],function(a,b,c,d,e,f,g,h,i){function j(a,b){for(var c=[],d=0;a>d;d++)c.push(b);return c}function k(a,b){g("name",a).toBeString(),g("attribMap",b).toBeObject();var c=b[a];if(c){var d=c.name;return d?d:a}throw new Error("Unable to compute name; missing attribute specification for "+a)}function l(a,b){g("key",a).toBeString(),g("attribMap",b).toBeObject();var c=b[a];if(c){var d=c.size;return g("size",d).toBeNumber(),c.size}throw new Error("Unable to compute size; missing attribute specification for "+a)}function m(a,b){return a.concat(b)}function n(a,b){if(g("simplices",a).toBeObject(),0===a.length)return new e(h.K_FOR_EMPTY,new i([]),{});var n=c(a);b?g("geometryMeta",b).toBeObject():b=n;var o,p,q=b.attributes,r=Object.keys(q),s=r.length,t=d(a),u=t.length,v=a.map(h.indices).reduce(m,[]),w=[];for(o=0;s>o;o++){var x=r[o],y=l(x,q),z=j(u*y,void 0);w.push({data:z,dimensions:y,name:k(x,q)})}for(p=0;u>p;p++){var A=t[p],B=A.attributes;for(A.index!==p&&g("vertex.index",p).toSatisfy(!1,"vertex.index must equal loop index, i"),o=0;s>o;o++){var C=w[o],D=C.dimensions,z=B[r[o]];z||(z=new i(j(D,0),!1,D)),z.toArray(C.data,p*C.dimensions)}}var E={};for(o=0;s>o;o++){var C=w[o],z=C.data,F=new i(z,!1,z.length);E[C.name]=new f(F,C.dimensions)}return new e(b.k,new i(v,!1,v.length),E)}return n});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/MutableNumber",["require","exports","../math/VectorN"],function(a,b,c){var d=function(a){function b(b,c){void 0===b&&(b=[0]),void 0===c&&(c=!1),a.call(this,b,c,1)}return f(b,a),Object.defineProperty(b.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.modified=this.modified||this.x!==a,this.data[0]=a},enumerable:!0,configurable:!0}),b.prototype.set=function(a){return this.x=a,this},b.prototype.setX=function(a){return this.x=a,this},b.prototype.copy=function(a){return this.x=a.x,this},b.prototype.add=function(a){return this.x+=a.x,this},b.prototype.addScalar=function(a){return this.x+=a,this},b.prototype.sum=function(a,b){return this.x=a.x+b.x,this},b.prototype.exp=function(){return this.x=Math.exp(this.x),this},b.prototype.sub=function(a){return this.x-=a.x,this},b.prototype.subScalar=function(a){return this.x-=a,this},b.prototype.difference=function(a,b){return this.x=a.x-b.x,this},b.prototype.multiply=function(a){return this.x*=a.x,this},b.prototype.scale=function(a){return this.x*=a,this},b.prototype.divide=function(a){return this.x/=a.x,this},b.prototype.divideScalar=function(a){if(0!==a){var b=1/a;this.x*=b}else this.x=0;return this},b.prototype.min=function(a){return this.x>a.x&&(this.x=a.x),this},b.prototype.max=function(a){return this.x<a.x&&(this.x=a.x),this},b.prototype.floor=function(){return this.x=Math.floor(this.x),this},b.prototype.ceil=function(){return this.x=Math.ceil(this.x),this},b.prototype.round=function(){return this.x=Math.round(this.x),this},b.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this},b.prototype.negate=function(){return this.x=-this.x,this},b.prototype.distanceTo=function(a){return Math.sqrt(this.quadranceTo(a))},b.prototype.dot=function(a){return this.x*a.x},b.prototype.magnitude=function(){return Math.sqrt(this.quaditude())},b.prototype.normalize=function(){return this.divideScalar(this.magnitude())},b.prototype.quaditude=function(){return this.x*this.x},b.prototype.quadranceTo=function(a){var b=this.x-a.x;return b*b},b.prototype.reflect=function(a){return this},b.prototype.rotate=function(a){return this},b.prototype.setMagnitude=function(a){var b=this.magnitude();return 0!==b&&a!==b&&this.scale(a/b),this},b.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this},b.prototype.lerpVectors=function(a,b,c){return this.difference(b,a).scale(c).add(a),this},b.prototype.equals=function(a){return a.x===this.x},b.prototype.fromArray=function(a,b){return void 0===b&&(b=0),this.x=a[b],this},b.prototype.toArray=function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a},b.prototype.fromAttribute=function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this},b.prototype.clone=function(){return new b([this.x])},b}(c);return d});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/Geometry",["require","exports","../geometries/GeometryElements","../checks/mustBeInteger","../checks/mustBeString","../utils/Shareable","../geometries/Simplex","../core/Symbolic","../geometries/toGeometryData","../geometries/toGeometryMeta","../math/MutableNumber","../math/Vector3"],function(a,b,c,d,e,g,h,i,j,k,l,m){var n=function(a){function b(b){void 0===b&&(b="Geometry"),a.call(this,e("type",b)),this.data=[],this._k=new l([h.K_FOR_TRIANGLE]),this.curvedSegments=16,this.flatSegments=1,this.orientationColors=!1,this._k.modified=!0}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},Object.defineProperty(b.prototype,"k",{get:function(){return this._k.x},set:function(a){this._k.x=d("k",a)},enumerable:!0,configurable:!0}),b.prototype.regenerate=function(){console.warn("`public regenerate(): void` method should be implemented by `"+this._type+"`.")},b.prototype.isModified=function(){return this._k.modified},b.prototype.setModified=function(a){return this._k.modified=a,this},b.prototype.boundary=function(a){return this.isModified()&&this.regenerate(),this.data=h.boundary(this.data,a),this.check()},b.prototype.check=function(){return this.meta=k(this.data),this},b.prototype.subdivide=function(a){return this.isModified()&&this.regenerate(),this.data=h.subdivide(this.data,a),this.check(),this},b.prototype.toElements=function(){this.isModified()&&this.regenerate(),this.check();var a=j(this.data,this.meta);return new c(a,this.meta)},b.prototype.mergeVertices=function(a){void 0===a&&(a=4)},b.prototype.triangle=function(a,b,c){var d=new h(h.K_FOR_TRIANGLE);return d.vertices[0].attributes[i.ATTRIBUTE_POSITION]=a[0],d.vertices[1].attributes[i.ATTRIBUTE_POSITION]=a[1],d.vertices[2].attributes[i.ATTRIBUTE_POSITION]=a[2],d.vertices[0].attributes[i.ATTRIBUTE_NORMAL]=b[0],d.vertices[1].attributes[i.ATTRIBUTE_NORMAL]=b[1],d.vertices[2].attributes[i.ATTRIBUTE_NORMAL]=b[2],d.vertices[0].attributes[i.ATTRIBUTE_TEXTURE_COORDS]=c[0],d.vertices[1].attributes[i.ATTRIBUTE_TEXTURE_COORDS]=c[1],d.vertices[2].attributes[i.ATTRIBUTE_TEXTURE_COORDS]=c[2],this.orientationColors&&(d.vertices[0].attributes[i.ATTRIBUTE_COLOR]=m.e1.clone(),d.vertices[1].attributes[i.ATTRIBUTE_COLOR]=m.e2.clone(),d.vertices[2].attributes[i.ATTRIBUTE_COLOR]=m.e3.clone()),this.data.push(d)},b.prototype.lineSegment=function(a,b,c){var d=new h(h.K_FOR_LINE_SEGMENT);return d.vertices[0].attributes[i.ATTRIBUTE_POSITION]=a[0],d.vertices[1].attributes[i.ATTRIBUTE_POSITION]=a[1],d.vertices[0].attributes[i.ATTRIBUTE_NORMAL]=b[0],d.vertices[1].attributes[i.ATTRIBUTE_NORMAL]=b[1],d.vertices[0].attributes[i.ATTRIBUTE_TEXTURE_COORDS]=c[0],d.vertices[1].attributes[i.ATTRIBUTE_TEXTURE_COORDS]=c[1],this.orientationColors&&(d.vertices[0].attributes[i.ATTRIBUTE_COLOR]=m.e1.clone(),d.vertices[1].attributes[i.ATTRIBUTE_COLOR]=m.e2.clone()),this.data.push(d)},b.prototype.point=function(a,b,c){var d=new h(h.K_FOR_POINT);return d.vertices[0].attributes[i.ATTRIBUTE_POSITION]=a[0],d.vertices[0].attributes[i.ATTRIBUTE_NORMAL]=b[0],d.vertices[0].attributes[i.ATTRIBUTE_TEXTURE_COORDS]=c[0],this.orientationColors&&(d.vertices[0].attributes[i.ATTRIBUTE_COLOR]=m.e1.clone()),this.data.push(d)},b.prototype.empty=function(a,b,c){var d=new h(h.K_FOR_EMPTY);return this.data.push(d)},b}(g);return n}),b("davinci-eight/geometries/triangle",["require","exports","../geometries/computeFaceNormals","../checks/expectArg","../geometries/Simplex","../core/Symbolic","../math/VectorN"],function(a,b,c,d,e,f,g){function h(a,b,h,i,j){void 0===i&&(i={}),void 0===j&&(j=[]),d("a",a).toSatisfy(a instanceof g,"a must be a VectorN"),d("b",b).toSatisfy(a instanceof g,"a must be a VectorN"),d("b",h).toSatisfy(a instanceof g,"a must be a VectorN");var k=new e(e.K_FOR_TRIANGLE);return k.vertices[0].attributes[f.ATTRIBUTE_POSITION]=a,k.vertices[1].attributes[f.ATTRIBUTE_POSITION]=b,k.vertices[2].attributes[f.ATTRIBUTE_POSITION]=h,c(k,f.ATTRIBUTE_POSITION,f.ATTRIBUTE_NORMAL),e.setAttributeValues(i,k),j.push(k),j}return h}),b("davinci-eight/geometries/quadrilateral",["require","exports","../checks/expectArg","../geometries/triangle","../math/VectorN"],function(a,b,c,d,e){function f(a,b,c){var d,e,f,g=Object.keys(b),h=g.length;for(d=0;h>d;d++)e=g[d],f=b[e],c[e]=a.map(function(a){return f[a]})}function g(a,b,g,h,i,j){void 0===i&&(i={}),void 0===j&&(j=[]),c("a",a).toSatisfy(a instanceof e,"a must be a VectorN"),c("b",b).toSatisfy(b instanceof e,"b must be a VectorN"),c("c",g).toSatisfy(g instanceof e,"c must be a VectorN"),c("d",h).toSatisfy(h instanceof e,"d must be a VectorN");var k={};f([1,2,0],i,k),d(b,g,a,k,j);var l=j[j.length-1];f([3,0,2],i,k),d(h,a,g,k,j);var m=j[j.length-1];return l.vertices[0].opposing.push(m),m.vertices[0].opposing.push(l),j}return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/CuboidGeometry",["require","exports","../i18n/cannotAssignTypeToProperty","../geometries/computeFaceNormals","../feedback/feedback","../geometries/Geometry","../geometries/quadrilateral","../geometries/Simplex","../core/Symbolic","../math/MutableNumber","../math/Vector3"],function(a,b,c,d,e,g,h,i,j,k,l){var m=function(a){function b(b,c,d,e,f,g){void 0===b&&(b=l.e1),void 0===c&&(c=l.e2),void 0===d&&(d=l.e3),void 0===e&&(e=i.K_FOR_TRIANGLE),void 0===f&&(f=0),void 0===g&&(g=0),a.call(this,"CuboidGeometry"),this._isModified=!0,this.a=l.copy(b),this.b=l.copy(c),this.c=l.copy(d),this.k=e,this.subdivide(f),this.boundary(g),this.regenerate()}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},Object.defineProperty(b.prototype,"a",{get:function(){return this._a},set:function(a){a instanceof l?(this._a=a,this._isModified=!0):e.warn(c(typeof a,"a"))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"b",{get:function(){return this._b},set:function(a){a instanceof l?(this._b=a,this._isModified=!0):e.warn(c(typeof a,"b"))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"c",{get:function(){return this._c},set:function(a){a instanceof l?(this._c=a,this._isModified=!0):e.warn(c(typeof a,"c"))},enumerable:!0,configurable:!0}),b.prototype.isModified=function(){return this._isModified||this._a.modified||this._b.modified||this._c.modified||a.prototype.isModified.call(this)},b.prototype.setModified=function(b){return this._isModified=b,this._a.modified=b,this._b.modified=b,this._c.modified=b,a.prototype.setModified.call(this,b),this},b.prototype.regenerate=function(){function a(a){for(var c=new i(a.length-1),d=0;d<a.length;d++)c.vertices[d].attributes[j.ATTRIBUTE_POSITION]=b[a[d]],c.vertices[d].attributes[j.ATTRIBUTE_GEOMETRY_INDEX]=new k([d]);return c}this.setModified(!1);var b=[0,1,2,3,4,5,6,7].map(function(a){return void 0});switch(b[0]=(new l).sub(this._a).sub(this._b).add(this._c).divideScalar(2),b[1]=(new l).add(this._a).sub(this._b).add(this._c).divideScalar(2),b[2]=(new l).add(this._a).add(this._b).add(this._c).divideScalar(2),b[3]=(new l).sub(this._a).add(this._b).add(this._c).divideScalar(2),b[4]=(new l).copy(b[3]).sub(this._c),b[5]=(new l).copy(b[2]).sub(this._c),b[6]=(new l).copy(b[1]).sub(this._c),b[7]=(new l).copy(b[0]).sub(this._c),this.k){case 0:var c=[[0],[1],[2],[3],[4],[5],[6],[7]];this.data=c.map(function(b){return a(b)});break;case 1:var e=[[0,1],[1,2],[2,3],[3,0],[0,7],[1,6],[2,5],[3,4],[4,5],[5,6],[6,7],[7,4]];this.data=e.map(function(b){return a(b)});break;case 2:var f=[0,1,2,3,4,5].map(function(a){return void 0});f[0]=h(b[0],b[1],b[2],b[3]),f[1]=h(b[1],b[6],b[5],b[2]),f[2]=h(b[7],b[0],b[3],b[4]),f[3]=h(b[6],b[7],b[4],b[5]),f[4]=h(b[3],b[2],b[5],b[4]),f[5]=h(b[7],b[6],b[1],b[0]),this.data=f.reduce(function(a,b){return a.concat(b)},[]),this.data.forEach(function(a){d(a)})}this.check()},b}(g);return m}),b("davinci-eight/checks/mustBeDefined",["require","exports","../checks/mustSatisfy","../checks/isDefined"],function(a,b,c,d){function e(){return"not be be `undefined`"}function f(a,b,f){return c(a,d(b),e,f),b}return f});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/collections/NumberIUnknownMap",["require","exports","../utils/Shareable"],function(a,b,c){var d="NumberIUnknownMap",e=function(a){function b(){a.call(this,d),this._elements={}}return f(b,a),b.prototype.destructor=function(){this.forEach(function(a,b){b&&b.release()}),this._elements=void 0},b.prototype.exists=function(a){var b=this._elements[a];return b?!0:!1},b.prototype.get=function(a){var b=this.getWeakRef(a);return b&&b.addRef(),b},b.prototype.getWeakRef=function(a){return this._elements[a]},b.prototype.put=function(a,b){b&&b.addRef(),this.putWeakRef(a,b)},b.prototype.putWeakRef=function(a,b){var c=this._elements,d=c[a];d&&d.release(),c[a]=b},b.prototype.forEach=function(a){var b,c=this.keys,d=c.length;for(b=0;d>b;b++){var e=c[b],f=this._elements[e];a(e,f)}},Object.defineProperty(b.prototype,"keys",{get:function(){return Object.keys(this._elements).map(function(a){return parseFloat(a)})},enumerable:!0,configurable:!0}),b.prototype.remove=function(a){this.put(a,void 0),delete this._elements[a]},b}(c);return e}),b("davinci-eight/collections/StringIUnknownMap",["require","exports","../checks/mustBeString","../utils/refChange","../utils/uuid4"],function(a,b,c,d,e){function f(a){var b="StringIUnknownMap";return b+":"+a}var g=function(){function a(a){this._refCount=1,this._elements={},this._uuid=e().generate(),this._userName=a,d(this._uuid,f(this._userName),1)}return a.prototype.addRef=function(){return d(this._uuid,f(this._userName),1),this._refCount++,this._refCount},a.prototype.release=function(){if(d(this._uuid,f(this._userName),-1),this._refCount--,0===this._refCount){var a=this;this.forEach(function(b){a.putWeakRef(b,void 0)}),this._elements=void 0}return this._refCount},a.prototype.exists=function(a){var b=this._elements[a];return b?!0:!1},a.prototype.get=function(a){var b=this._elements[a];return b?(b.addRef(),b):void 0},a.prototype.getWeakRef=function(a){return this._elements[a]},a.prototype.put=function(a,b){b&&b.addRef(),this.putWeakRef(a,b)},a.prototype.putWeakRef=function(a,b){c("key",a);var d=this._elements,e=d[a];e&&e.release(),d[a]=b},a.prototype.forEach=function(a){for(var b=this.keys,c=0,d=b.length;d>c;c++){var e=b[c];a(e,this._elements[e])}},Object.defineProperty(a.prototype,"keys",{get:function(){return Object.keys(this._elements)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"values",{get:function(){for(var a=[],b=this.keys,c=0,d=b.length;d>c;c++){var e=b[c];a.push(this._elements[e])}return a},enumerable:!0,configurable:!0}),a.prototype.remove=function(a){var b=this._elements[a];return delete this._elements[a],b},a}();return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/scene/Drawable",["require","exports","../checks/isDefined","../checks/mustBeDefined","../collections/NumberIUnknownMap","../utils/Shareable","../collections/StringIUnknownMap"],function(a,b,c,d,e,g,h){function i(){return j}var j="Drawable",k=function(a){function b(b,c){a.call(this,j),this.geometry=b,this._material=c,this._material.addRef(),this.buffersByCanvasid=new e,this.uniforms=new h(j)}return f(b,a),b.prototype.destructor=function(){this.geometry=void 0,this.buffersByCanvasid.release(),this.buffersByCanvasid=void 0,this._material.release(),this._material=void 0,this.uniforms.release(),this.uniforms=void 0},b.prototype.draw=function(a){if(c(a)){var b=this._material,d=this.buffersByCanvasid.get(a);c(d)&&(b.use(a),this.uniforms.forEach(function(c,d){d.setUniforms(b,a)}),d.bind(b),d.draw(),d.unbind(),d.release())}},b.prototype.contextFree=function(a){this._material.contextFree(a)},b.prototype.contextGain=function(a){if(this.geometry){var b=this.geometry.data,c=this.geometry.meta;d("geometry.data",b,i),d("geometry.meta",c,i),this.buffersByCanvasid.putWeakRef(a.canvasId,a.createBufferGeometry(b))}else console.warn(j+" contextGain method has no elements, canvasId => "+a.canvasId);this._material.contextGain(a)},b.prototype.contextLost=function(a){this._material.contextLost(a)},b.prototype.getFacet=function(a){return this.uniforms.get(a)},b.prototype.setFacet=function(a,b){return this.uniforms.put(a,b),b},Object.defineProperty(b.prototype,"material",{get:function(){return this._material.addRef(),this._material},enumerable:!0,configurable:!0}),b}(g);return k});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/scene/MonitorList",["require","exports","../utils/Shareable","../checks/mustSatisfy","../checks/isInteger"],function(a,b,c,d,e){function g(){return"be an instance of MonitorList"}function h(){return"be IContextMonitor[]"}function i(a){return a}var j=function(a){function b(b){void 0===b&&(b=[]),a.call(this,"MonitorList"),this.monitors=b.map(i),this.monitors.forEach(function(a){a.addRef()})}return f(b,a),b.prototype.destructor=function(){this.monitors.forEach(function(a){a.release()})},b.prototype.addContextListener=function(a){this.monitors.forEach(function(b){b.addContextListener(a)})},b.prototype.push=function(a){this.monitors.push(a)},b.prototype.removeContextListener=function(a){this.monitors.forEach(function(b){b.removeContextListener(a)})},b.prototype.synchronize=function(a){this.monitors.forEach(function(b){b.synchronize(a)})},b.prototype.toArray=function(){return this.monitors.map(i)},b.copy=function(a){return new b(a)},b.isInstanceOf=function(a){return a instanceof b},b.assertInstance=function(a,c,e){if(b.isInstanceOf(c))return c;throw d(a,!1,g,e),new Error},b.verify=function(a,b,c){d(a,e(b.length),h,c);for(var f=b.length,g=0;f>g;g++);return b},b.addContextListener=function(a,c){b.verify("monitors",c,function(){return"MonitorList.addContextListener"}),c.forEach(function(b){b.addContextListener(a)})},b.removeContextListener=function(a,c){b.verify("monitors",c,function(){return"MonitorList.removeContextListener"}),c.forEach(function(b){b.removeContextListener(a)})},b.synchronize=function(a,c){b.verify("monitors",c,function(){return"MonitorList.removeContextListener"}),c.forEach(function(b){b.synchronize(a)})},b}(c);return j});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/materials/Material",["require","exports","../core","../checks/isDefined","../checks/isUndefined","../scene/MonitorList","../checks/mustBeInteger","../checks/mustBeString","../utils/Shareable","../utils/uuid4"],function(a,b,c,d,e,g,h,i,j,k){function l(a,b,c,d){console.warn(a+" dropped uniform"+b+" "+c),console.warn("`typeof canvasId` is "+typeof d)}var m="Material",n=function(a){function b(b,c){a.call(this,m),this.readyPending=!1,this.programId=k().generate(),g.verify("contexts",b),i("type",c),this._monitors=g.copy(b),this.type=c}return f(b,a),b.prototype.destructor=function(){this._monitors.removeContextListener(this),this._monitors.release(),this._monitors=void 0,this.inner&&(this.inner.release(),this.inner=void 0)},b.prototype.makeReady=function(a){this.readyPending||(this.readyPending=!0,this._monitors.addContextListener(this),this._monitors.synchronize(this))},Object.defineProperty(b.prototype,"monitors",{get:function(){return this._monitors.toArray()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"fragmentShader",{get:function(){return this.inner?this.inner.fragmentShader:void 0},enumerable:!0,configurable:!0}),b.prototype.use=function(a){if(c.strict&&h("canvasid",a),this.inner)return this.inner.use(a);var b=!1;return this.makeReady(b),this.inner?this.inner.use(a):void(c.verbose&&console.warn(this.type+" is not ready for use. Maybe did not receive contextGain?"))},b.prototype.attributes=function(a){if(this.inner)return this.inner.attributes(a);var b=!1;return this.makeReady(b),this.inner?this.inner.attributes(a):void 0},b.prototype.uniforms=function(a){if(this.inner)return this.inner.uniforms(a);var b=!1;return this.makeReady(b),this.inner?this.inner.uniforms(a):void 0},b.prototype.enableAttrib=function(a,b){if(this.inner)return this.inner.enableAttrib(a,b);var c=!1;return this.makeReady(c),this.inner?this.inner.enableAttrib(a,b):void console.warn(this.type+" enableAttrib()")},b.prototype.disableAttrib=function(a,b){if(this.inner)return this.inner.disableAttrib(a,b);var c=!1;return this.makeReady(c),this.inner?this.inner.disableAttrib(a,b):void console.warn(this.type+" disableAttrib()")},b.prototype.contextFree=function(a){this.inner&&this.inner.contextFree(a)},b.prototype.contextGain=function(a){e(this.inner)&&(this.inner=this.createMaterial()),d(this.inner)&&this.inner.contextGain(a)},b.prototype.contextLost=function(a){this.inner&&this.inner.contextLost(a)},b.prototype.createMaterial=function(){throw new Error("Material createMaterial method is virtual and should be implemented by "+this.type)},b.prototype.uniform1f=function(a,b,c){if(this.inner)this.inner.uniform1f(a,b,c);else{var d=!1,e=this.readyPending;this.makeReady(d),this.inner?this.inner.uniform1f(a,b,c):e||l(this.type,"1f",a,c)}},b.prototype.uniform2f=function(a,b,c,d){if(this.inner)this.inner.uniform2f(a,b,c,d);else{var e=!1,f=this.readyPending;this.makeReady(e),this.inner?this.inner.uniform2f(a,b,c,d):f||l(this.type,"2f",a,d);
}},b.prototype.uniform3f=function(a,b,c,d,e){if(this.inner)this.inner.uniform3f(a,b,c,d,e);else{var f=!1,g=this.readyPending;this.makeReady(f),this.inner?this.inner.uniform3f(a,b,c,d,e):g||l(this.type,"3f",a,e)}},b.prototype.uniform4f=function(a,b,c,d,e,f){if(this.inner)this.inner.uniform4f(a,b,c,d,e,f);else{var g=!1,h=this.readyPending;this.makeReady(g),this.inner?this.inner.uniform4f(a,b,c,d,e,f):h||l(this.type,"4f",a,f)}},b.prototype.uniformMatrix2=function(a,b,c,d){if(this.inner)this.inner.uniformMatrix2(a,b,c,d);else{var e=!1,f=this.readyPending;this.makeReady(e),this.inner?this.inner.uniformMatrix2(a,b,c,d):f||l(this.type,"Matrix2",a,d)}},b.prototype.uniformMatrix3=function(a,b,c,d){if(this.inner)this.inner.uniformMatrix3(a,b,c,d);else{var e=!1,f=this.readyPending;this.makeReady(e),this.inner?this.inner.uniformMatrix3(a,b,c,d):f||l(this.type,"Matrix3",a,d)}},b.prototype.uniformMatrix4=function(a,b,d,e){if(this.inner)this.inner.uniformMatrix4(a,b,d,e);else{var f=!1,g=this.readyPending;this.makeReady(f),this.inner?this.inner.uniformMatrix4(a,b,d,e):g||c.verbose&&l(this.type,"Matrix4",a,e)}},b.prototype.uniformCartesian2=function(a,b,c){if(this.inner)this.inner.uniformCartesian2(a,b,c);else{var d=!1,e=this.readyPending;this.makeReady(d),this.inner?this.inner.uniformCartesian2(a,b,c):e||l(this.type,"Vector2",a,c)}},b.prototype.uniformCartesian3=function(a,b,c){if(this.inner)this.inner.uniformCartesian3(a,b,c);else{var d=!1,e=this.readyPending;this.makeReady(d),this.inner?this.inner.uniformCartesian3(a,b,c):e||l(this.type,"Vector3",a,c)}},b.prototype.uniformCartesian4=function(a,b,c){if(this.inner)this.inner.uniformCartesian4(a,b,c);else{var d=!1,e=this.readyPending;this.makeReady(d),this.inner?this.inner.uniformCartesian4(a,b,c):e||l(this.type,"Vector4",a,c)}},b.prototype.vector2=function(a,b,c){if(this.inner)this.inner.vector2(a,b,c);else{var d=!1,e=this.readyPending;this.makeReady(d),this.inner?this.inner.vector2(a,b,c):e||l(this.type,"vector2",a,c)}},b.prototype.vector3=function(a,b,c){if(this.inner)this.inner.vector3(a,b,c);else{var d=!1,e=this.readyPending;this.makeReady(d),this.inner?this.inner.vector3(a,b,c):e||l(this.type,"vector3",a,c)}},b.prototype.vector4=function(a,b,c){if(this.inner)this.inner.vector4(a,b,c);else{var d=!1,e=this.readyPending;this.makeReady(d),this.inner?this.inner.vector4(a,b,c):e||l(this.type,"vector4",a,c)}},Object.defineProperty(b.prototype,"vertexShader",{get:function(){return this.inner?this.inner.vertexShader:void 0},enumerable:!0,configurable:!0}),b}(j);return n}),b("davinci-eight/core/getAttribVarName",["require","exports","../checks/isDefined","../checks/expectArg"],function(a,b,c,d){function e(a,b){return d("attribute",a).toBeObject(),d("varName",b).toBeString(),c(a.name)?d("attribute.name",a.name).toBeString().value:b}return e}),b("davinci-eight/core/getUniformVarName",["require","exports","../checks/isDefined","../checks/expectArg"],function(a,b,c,d){function e(a,b){return d("uniform",a).toBeObject(),d("varName",b).toBeString(),c(a.name)?d("uniform.name",a.name).toBeString().value:b}return e}),b("davinci-eight/programs/glslAttribType",["require","exports","../core/Symbolic","../checks/mustBeInteger","../checks/mustBeString"],function(a,b,c,d,e){function f(a){switch(d("size",a),a){case 1:return"float";case 2:return"vec2";case 3:return"vec3";default:throw new Error("Can't compute the GLSL attribute type from size "+a)}}function g(a,b){switch(e("key",a),d("size",b),a){case c.ATTRIBUTE_COLOR:return"vec3";default:return f(b)}}return g}),b("davinci-eight/checks/isBoolean",["require","exports"],function(a,b){function c(a){return"boolean"==typeof a}return c}),b("davinci-eight/checks/mustBeBoolean",["require","exports","../checks/mustSatisfy","../checks/isBoolean"],function(a,b,c,d){function e(){return"be `boolean`"}function f(a,b,f){return c(a,d(b),e,f),b}return f}),b("davinci-eight/programs/fragmentShader",["require","exports","../checks/mustBeBoolean","../checks/mustBeDefined"],function(a,b,c,d){function e(a,b,e,f){d("attributes",a),d("uniforms",b),c("vColor",e),c("vLight",f);var g=[];g.push("// generated fragment shader"),e&&g.push("varying highp vec4 vColor;"),f&&g.push("varying highp vec3 vLight;"),g.push("void main(void) {");f?e?g.push("  gl_FragColor = vec4(vColor.xyz * vLight, vColor.a);"):g.push("  gl_FragColor = vec4(vLight, 1.0);"):e?g.push("  gl_FragColor = vColor;"):g.push("  gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);"),g.push("}");var h=g.join("\n");return h}return e}),b("davinci-eight/core/AttribLocation",["require","exports","../checks/expectArg"],function(a,b,c){var d=function(){function a(a,b){c("manager",a).toBeObject().value,this._name=c("name",b).toBeString().value}return Object.defineProperty(a.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),a.prototype.contextFree=function(){this.contextLost()},a.prototype.contextGain=function(a,b){this.contextLost(),this._index=a.getAttribLocation(b,this._name),this._context=a},a.prototype.contextLost=function(){this._index=void 0,this._context=void 0},a.prototype.vertexPointer=function(a,b,c,d){void 0===b&&(b=!1),void 0===c&&(c=0),void 0===d&&(d=0),this._context.vertexAttribPointer(this._index,a,this._context.FLOAT,b,c,d)},a.prototype.enable=function(){this._context.enableVertexAttribArray(this._index)},a.prototype.disable=function(){this._context.disableVertexAttribArray(this._index)},a.prototype.toString=function(){return["attribute",this._name].join(" ")},a}();return d}),b("davinci-eight/programs/makeWebGLShader",["require","exports"],function(a,b){function c(a,b,c){var d=a.createShader(c);a.shaderSource(d,b),a.compileShader(d);var e=a.getShaderParameter(d,a.COMPILE_STATUS);if(e)return d;if(a.isContextLost())throw new Error("Context lost while compiling shader");var f=a.getShaderInfoLog(d);throw a.deleteShader(d),new Error("Error compiling shader: "+f)}return c}),b("davinci-eight/programs/makeWebGLProgram",["require","exports","../programs/makeWebGLShader"],function(a,b,c){function d(a,b,d,e){var f=c(a,b,a.VERTEX_SHADER),g=c(a,d,a.FRAGMENT_SHADER),h=a.createProgram();a.attachShader(h,f),a.attachShader(h,g);for(var i=0;i<e.length;++i)a.bindAttribLocation(h,i,e[i]);a.linkProgram(h);var j=a.getProgramParameter(h,a.LINK_STATUS);if(j||a.isContextLost())return h;var k=a.getProgramInfoLog(h);throw a.detachShader(h,f),a.deleteShader(f),a.detachShader(h,g),a.deleteShader(g),a.deleteProgram(h),new Error("Error linking program: "+k)}return d}),b("davinci-eight/core/UniformLocation",["require","exports","../checks/expectArg"],function(a,b,c){var d=function(){function a(a,b){c("manager",a).toBeObject().value,this._name=c("name",b).toBeString().value}return a.prototype.contextFree=function(){this.contextLost()},a.prototype.contextGain=function(a,b){this.contextLost(),this._context=a,this._location=a.getUniformLocation(b,this._name),this._program=b},a.prototype.contextLost=function(){this._context=void 0,this._location=void 0,this._program=void 0},a.prototype.cartesian1=function(a){this._context.useProgram(this._program),this._context.uniform1f(this._location,a.x)},a.prototype.cartesian2=function(a){this._context.useProgram(this._program),this._context.uniform2f(this._location,a.x,a.y)},a.prototype.cartesian3=function(a){a&&(this._context.useProgram(this._program),this._context.uniform3f(this._location,a.x,a.y,a.z))},a.prototype.cartesian4=function(a){this._context.useProgram(this._program),this._context.uniform4f(this._location,a.x,a.y,a.z,a.w)},a.prototype.uniform1f=function(a){this._context.useProgram(this._program),this._context.uniform1f(this._location,a)},a.prototype.uniform2f=function(a,b){this._context.useProgram(this._program),this._context.uniform2f(this._location,a,b)},a.prototype.uniform3f=function(a,b,c){this._context.useProgram(this._program),this._context.uniform3f(this._location,a,b,c)},a.prototype.uniform4f=function(a,b,c,d){this._context.useProgram(this._program),this._context.uniform4f(this._location,a,b,c,d)},a.prototype.matrix1=function(a,b){this._context.useProgram(this._program),this._context.uniform1fv(this._location,b.data)},a.prototype.matrix2=function(a,b){this._context.useProgram(this._program),this._context.uniformMatrix2fv(this._location,a,b.data)},a.prototype.matrix3=function(a,b){this._context.useProgram(this._program),this._context.uniformMatrix3fv(this._location,a,b.data)},a.prototype.matrix4=function(a,b){b&&(this._context.useProgram(this._program),this._context.uniformMatrix4fv(this._location,a,b.data))},a.prototype.vector2=function(a){this._context.useProgram(this._program),this._context.uniform2fv(this._location,a)},a.prototype.vector3=function(a){this._context.useProgram(this._program),this._context.uniform3fv(this._location,a)},a.prototype.vector4=function(a){this._context.useProgram(this._program),this._context.uniform4fv(this._location,a)},a.prototype.toString=function(){return["uniform",this._name].join(" ")},a}();return d});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/programs/SimpleWebGLProgram",["require","exports","../core/AttribLocation","../programs/makeWebGLProgram","../core/UniformLocation","../utils/Shareable"],function(a,b,c,d,e,g){var h=function(a){function b(b,c,d,e){a.call(this,"SimpleWebGLProgram"),this.attributes={},this.uniforms={},this.manager=b,this.vertexShader=c,this.fragmentShader=d,this.attribs=e,this.manager.addContextListener(this),this.manager.synchronize(this)}return f(b,a),b.prototype.destructor=function(){var a=this.manager,b=a.canvasId;if(this.program){var c=a.gl;c?c.isContextLost()?this.contextLost(b):this.contextFree(b):console.warn("memory leak: WebGLProgram has not been deleted because WebGLRenderingContext is not available anymore.")}a.removeContextListener(this),this.manager=void 0},b.prototype.contextGain=function(a){if(!this.program){this.program=d(a.gl,this.vertexShader,this.fragmentShader,this.attribs);for(var b=a.gl,f=this.program,g=this.attributes,h=this.uniforms,i=b.getProgramParameter(f,b.ACTIVE_ATTRIBUTES),j=0;i>j;j++){var k=b.getActiveAttrib(f,j),l=k.name;g[l]||(g[l]=new c(a,l))}for(var m=b.getProgramParameter(f,b.ACTIVE_UNIFORMS),n=0;m>n;n++){var o=b.getActiveUniform(f,n),p=o.name;h[p]||(h[p]=new e(a,p))}for(var q in g)g[q].contextGain(b,f);for(var r in h)h[r].contextGain(b,f)}},b.prototype.contextLost=function(a){this.program=void 0;for(var b in this.attributes)this.attributes[b].contextLost();for(var c in this.uniforms)this.uniforms[c].contextLost()},b.prototype.contextFree=function(a){if(this.program){var b=this.manager.gl;b?b.isContextLost()||b.deleteProgram(this.program):console.warn("memory leak: WebGLProgram has not been deleted because WebGLRenderingContext is not available anymore."),this.program=void 0}for(var c in this.attributes)this.attributes[c].contextFree();for(var d in this.uniforms)this.uniforms[d].contextFree()},b.prototype.use=function(){this.manager.gl.useProgram(this.program)},b}(g);return h}),b("davinci-eight/programs/createMaterial",["require","exports","../core","../scene/MonitorList","../collections/NumberIUnknownMap","../checks/mustBeInteger","../checks/mustBeString","../utils/uuid4","../utils/refChange","../programs/SimpleWebGLProgram"],function(a,b,c,d,e,f,g,h,i,j){var k="IMaterial",l=function(a,b,l,m){if(d.verify("monitors",a,function(){return"createMaterial"}),"string"!=typeof b)throw new Error("vertexShader argument must be a string.");if("string"!=typeof l)throw new Error("fragmentShader argument must be a string.");var n=1,o=new e,p=h().generate(),q={get vertexShader(){return b},get fragmentShader(){return l},attributes:function(a){f("canvasId",a);var b=o.getWeakRef(a);return b?b.attributes:void 0},uniforms:function(a){f("canvasId",a);var b=o.getWeakRef(a);return b?b.uniforms:void 0},addRef:function(){return i(p,k,1),n++,n},release:function(){return i(p,k,-1),n--,0===n&&(d.removeContextListener(q,a),o.release()),n},contextFree:function(a){f("canvasId",a);var b=o.getWeakRef(a);b&&(b.contextFree(a),o.remove(a))},contextGain:function(a){var c,d;c=a.canvasId,o.exists(c)?d=o.getWeakRef(c):(d=new j(a,b,l,m),o.putWeakRef(c,d)),d.contextGain(a)},contextLost:function(a){f("canvasId",a);var b=o.getWeakRef(a);b&&(b.contextLost(a),o.remove(a))},get programId(){return p},use:function(a){f("canvasId",a);var b=o.getWeakRef(a);b?b.use():console.warn(k+" use(canvasId: number) missing WebGLRenderingContext")},enableAttrib:function(a,b){g("name",a),f("canvasId",b);var c=o.getWeakRef(b);if(c){var d=c.attributes[a];d&&d.enable()}},disableAttrib:function(a,b){g("name",a),f("canvasId",b);var c=o.getWeakRef(b);if(c){var d=c.attributes[a];d&&d.enable()}},uniform1f:function(a,b,c){g("name",a),f("canvasId",c);var d=o.getWeakRef(c);if(d){var e=d.uniforms[a];e&&e.uniform1f(b)}},uniform2f:function(a,b,c,d){g("name",a),f("canvasId",d);var e=o.getWeakRef(d);if(e){var h=e.uniforms[a];h&&h.uniform2f(b,c)}},uniform3f:function(a,b,c,d,e){g("name",a),f("canvasId",e);var h=o.getWeakRef(e);if(h){var i=h.uniforms[a];i&&i.uniform3f(b,c,d)}},uniform4f:function(a,b,c,d,e,h){g("name",a),f("canvasId",h);var i=o.getWeakRef(h);if(i){var j=i.uniforms[a];j&&j.uniform4f(b,c,d,e)}},uniformMatrix2:function(a,b,c,d){g("name",a),f("canvasId",d);var e=o.getWeakRef(d);if(e){var h=e.uniforms[a];h&&h.matrix2(b,c)}},uniformMatrix3:function(a,b,c,d){g("name",a),f("canvasId",d);var e=o.getWeakRef(d);if(e){var h=e.uniforms[a];h&&h.matrix3(b,c)}},uniformMatrix4:function(a,b,d,e){g("name",a),f("canvasId",e);var h=o.getWeakRef(e);if(h){var i=h.uniforms[a];i&&i.matrix4(b,d)}else c.verbose&&console.warn("Ignoring uniformMatrix4 for "+a+" because `typeof canvasId` is "+typeof e)},uniformCartesian2:function(a,b,c){g("name",a),f("canvasId",c);var d=o.getWeakRef(c);if(d){var e=d.uniforms[a];e&&e.cartesian2(b)}},uniformCartesian3:function(a,b,c){g("name",a),f("canvasId",c);var d=o.getWeakRef(c);if(d){var e=d.uniforms[a];e&&e.cartesian3(b)}},uniformCartesian4:function(a,b,c){g("name",a),f("canvasId",c);var d=o.getWeakRef(c);if(d){var e=d.uniforms[a];e&&e.cartesian4(b)}},vector2:function(a,b,c){g("name",a),f("canvasId",c);var d=o.getWeakRef(c);if(d){var e=d.uniforms[a];e&&e.vector2(b)}},vector3:function(a,b,c){g("name",a),f("canvasId",c);var d=o.getWeakRef(c);if(d){var e=d.uniforms[a];e&&e.vector3(b)}},vector4:function(a,b,c){g("name",a),f("canvasId",c);var d=o.getWeakRef(c);if(d){var e=d.uniforms[a];e&&e.vector4(b)}}};return d.addContextListener(q,a),d.synchronize(q,a),i(p,k,1),q};return l}),b("davinci-eight/programs/vertexShader",["require","exports","../core/getAttribVarName","../core/getUniformVarName","../checks/mustBeBoolean","../checks/mustBeDefined","../core/Symbolic"],function(a,b,c,d,e,f,g){function h(a,b){return d(a[b],b)}function i(a,b,d,i){f("attributes",a),f("uniforms",b),e("vColor",d),e("vLight",i);var t=[];t.push("// generated vertex shader");for(var u in a)t.push(k+a[u].glslType+j+c(a[u],u)+n);for(var v in b)t.push(l+b[v].glslType+j+h(b,v)+n);d&&t.push("varying highp vec4 vColor;"),i&&t.push("varying highp vec3 vLight;"),t.push("void main(void) {");var w=[];if(w.unshift(n),a[g.ATTRIBUTE_POSITION]?(w.unshift(p),w.unshift("1.0"),w.unshift(m),w.unshift(c(a[g.ATTRIBUTE_POSITION],g.ATTRIBUTE_POSITION)),w.unshift(o),w.unshift("vec4")):w.unshift("vec4(0.0, 0.0, 0.0, 1.0)"),b[g.UNIFORM_MODEL_MATRIX]&&(w.unshift(q),w.unshift(h(b,g.UNIFORM_MODEL_MATRIX))),b[g.UNIFORM_VIEW_MATRIX]&&(w.unshift(q),w.unshift(h(b,g.UNIFORM_VIEW_MATRIX))),b[g.UNIFORM_PROJECTION_MATRIX]&&(w.unshift(q),w.unshift(h(b,g.UNIFORM_PROJECTION_MATRIX))),w.unshift(r),w.unshift("gl_Position"),w.unshift("  "),t.push(w.join("")),b[g.UNIFORM_POINT_SIZE]&&t.push("  gl_PointSize = "+h(b,g.UNIFORM_POINT_SIZE)+";"),d)if(a[g.ATTRIBUTE_COLOR]){var x=c(a[g.ATTRIBUTE_COLOR],g.ATTRIBUTE_COLOR);switch(a[g.ATTRIBUTE_COLOR].glslType){case"vec4":t.push("  vColor = "+x+n);break;case"vec3":t.push("  vColor = vec4("+x+", 1.0);");break;default:throw new Error("Unexpected type for color attribute: "+a[g.ATTRIBUTE_COLOR].glslType)}}else if(b[g.UNIFORM_COLOR]){var y=h(b,g.UNIFORM_COLOR);switch(b[g.UNIFORM_COLOR].glslType){case"vec4":t.push("  vColor = "+y+n);break;case"vec3":t.push("  vColor = vec4("+y+", 1.0);");break;default:throw new Error("Unexpected type for color uniform: "+b[g.UNIFORM_COLOR].glslType)}}else t.push("  vColor = vec4(1.0, 1.0, 1.0, 1.0);");i&&(b[g.UNIFORM_DIRECTIONAL_LIGHT_COLOR]&&b[g.UNIFORM_DIRECTIONAL_LIGHT_DIRECTION]&&b[g.UNIFORM_NORMAL_MATRIX]&&a[g.ATTRIBUTE_NORMAL]?(t.push("  vec3 L = normalize("+h(b,g.UNIFORM_DIRECTIONAL_LIGHT_DIRECTION)+");"),t.push("  vec3 N = normalize("+h(b,g.UNIFORM_NORMAL_MATRIX)+" * "+c(a[g.ATTRIBUTE_NORMAL],g.ATTRIBUTE_NORMAL)+");"),t.push("  // The minus sign arises because L is the light direction, so we need dot(N, -L) = -dot(N, L)"),t.push("  float "+s+" = max(-dot(N, L), 0.0);"),b[g.UNIFORM_AMBIENT_LIGHT]?t.push("  vLight = "+h(b,g.UNIFORM_AMBIENT_LIGHT)+" + "+s+" * "+h(b,g.UNIFORM_DIRECTIONAL_LIGHT_COLOR)+";"):t.push("  vLight = "+s+" * "+h(b,g.UNIFORM_DIRECTIONAL_LIGHT_COLOR)+";")):b[g.UNIFORM_AMBIENT_LIGHT]?t.push("  vLight = "+h(b,g.UNIFORM_AMBIENT_LIGHT)+";"):t.push("  vLight = vec3(1.0, 1.0, 1.0);")),t.push("}");var z=t.join("\n");return z}var j=" ",k="attribute"+j,l="uniform"+j,m=","+j,n=";",o="(",p=")",q=j+"*"+j,r=j+"="+j,s="directionalLightCosineFactor";return i});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/materials/SmartMaterial",["require","exports","../programs/fragmentShader","../materials/Material","../programs/createMaterial","../programs/vertexShader"],function(a,b,c,d,e,g){var h="SmartMaterial",i=function(a){function b(b,c,d,e,f){a.call(this,b,h),this.aParams={},this.uParams={},this.vColor=!1,this.vLight=!1,this.aParams=c,this.uParams=d,this.vColor=e,this.vLight=f,this.makeReady(!1)}return f(b,a),b.prototype.createMaterial=function(){var a=[];return e(this.monitors,this.vertexShader,this.fragmentShader,a)},Object.defineProperty(b.prototype,"vertexShader",{get:function(){return g(this.aParams,this.uParams,this.vColor,this.vLight)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"fragmentShader",{get:function(){return c(this.aParams,this.uParams,this.vColor,this.vLight)},enumerable:!0,configurable:!0}),b}(d);return i}),b("davinci-eight/programs/vColorRequired",["require","exports","../core/Symbolic"],function(a,b,c){function d(a,b){return!!a[c.ATTRIBUTE_COLOR]||!!b[c.UNIFORM_COLOR]}return d}),b("davinci-eight/programs/vLightRequired",["require","exports","../checks/mustBeDefined","../core/Symbolic"],function(a,b,c,d){function e(a,b){return c("attributes",a),c("uniforms",b),!!b[d.UNIFORM_AMBIENT_LIGHT]||!!b[d.UNIFORM_DIRECTIONAL_LIGHT_COLOR]&&!!b[d.UNIFORM_DIRECTIONAL_LIGHT_COLOR]}return e}),b("davinci-eight/materials/SmartMaterialBuilder",["require","exports","../core/getAttribVarName","../core/getUniformVarName","../programs/glslAttribType","../checks/mustBeInteger","../checks/mustBeString","../materials/SmartMaterial","../programs/vColorRequired","../programs/vLightRequired"],function(a,b,c,d,e,f,g,h,i,j){function k(a){for(var b={},d=Object.keys(a),g=d.length,h=0;g>h;h++){var i=d[h],j=a[i],k=f("size",j.size),l=c(j,i);b[l]={glslType:e(i,k)}}return b}var l=function(){function a(a){if(this.aMeta={},this.uParams={},a)for(var b=a.meta.attributes,c=Object.keys(b),d=c.length,e=0;d>e;e++){var f=c[e],g=b[f];this.attribute(f,g.size,g.name)}}return a.prototype.attribute=function(a,b,c){return g("key",a),f("size",b),this.aMeta[a]={size:b},c&&(g("name",c),this.aMeta[a].name=c),this},a.prototype.uniform=function(a,b,c){return g("key",a),g("type",b),this.uParams[a]={glslType:b},c&&(g("name",c),this.uParams[a].name=c),this},a.prototype.build=function(a){var b=k(this.aMeta),c=i(b,this.uParams),d=j(b,this.uParams);return new h(a,b,this.uParams,c,d)},a}();return l});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/materials/PointMaterial",["require","exports","../materials/Material","../materials/SmartMaterialBuilder","../core/Symbolic"],function(a,b,c,d,e){var g="PointMaterial",h=function(a){function b(b,c){void 0===b&&(b=[]),a.call(this,b,g)}return f(b,a),b.prototype.createMaterial=function(){var a=new d;return a.attribute(e.ATTRIBUTE_POSITION,3),a.uniform(e.UNIFORM_COLOR,"vec3"),a.uniform(e.UNIFORM_MODEL_MATRIX,"mat4"),a.uniform(e.UNIFORM_PROJECTION_MATRIX,"mat4"),a.uniform(e.UNIFORM_VIEW_MATRIX,"mat4"),a.uniform(e.UNIFORM_POINT_SIZE,"float"),a.build(this.monitors)},b}(c);return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/materials/LineMaterial",["require","exports","../materials/Material","../materials/SmartMaterialBuilder","../core/Symbolic"],function(a,b,c,d,e){var g="LineMaterial",h=function(a){function b(b,c){void 0===b&&(b=[]),a.call(this,b,g)}return f(b,a),b.prototype.createMaterial=function(){var a=new d;return a.attribute(e.ATTRIBUTE_POSITION,3),a.uniform(e.UNIFORM_COLOR,"vec3"),a.uniform(e.UNIFORM_MODEL_MATRIX,"mat4"),a.uniform(e.UNIFORM_PROJECTION_MATRIX,"mat4"),a.uniform(e.UNIFORM_VIEW_MATRIX,"mat4"),a.build(this.monitors)},b}(c);return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/materials/MeshMaterial",["require","exports","../materials/Material","../materials/SmartMaterialBuilder","../core/Symbolic"],function(a,b,c,d,e){var g="MeshMaterial",h=function(a){function b(b,c){void 0===b&&(b=[]),a.call(this,b,g)}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.createMaterial=function(){var a=new d;return a.attribute(e.ATTRIBUTE_POSITION,3),a.attribute(e.ATTRIBUTE_NORMAL,3),a.uniform(e.UNIFORM_COLOR,"vec3"),a.uniform(e.UNIFORM_MODEL_MATRIX,"mat4"),a.uniform(e.UNIFORM_NORMAL_MATRIX,"mat3"),a.uniform(e.UNIFORM_PROJECTION_MATRIX,"mat4"),a.uniform(e.UNIFORM_VIEW_MATRIX,"mat4"),a.uniform(e.UNIFORM_AMBIENT_LIGHT,"vec3"),a.uniform(e.UNIFORM_DIRECTIONAL_LIGHT_COLOR,"vec3"),a.uniform(e.UNIFORM_DIRECTIONAL_LIGHT_DIRECTION,"vec3"),a.build(this.monitors)},b}(c);return h}),b("davinci-eight/math/AbstractMatrix",["require","exports","../checks/mustBeInteger","../checks/expectArg"],function(a,b,c,d){var e=function(){function a(a,b){this._dimensions=c("dimensions",b),this._length=b*b,d("data",a).toSatisfy(a.length===this._length,"data must have length "+this._length),this._data=a,this.modified=!1}return Object.defineProperty(a.prototype,"data",{get:function(){if(this._data)return this._data;if(this._callback){var a=this._callback();return d("callback()",a).toSatisfy(a.length===this._length,"callback() length must be "+this._length),this._callback()}throw new Error("Matrix"+Math.sqrt(this._length)+" is undefined.")},set:function(a){d("data",a).toSatisfy(a.length===this._length,"data length must be "+this._length),this._data=a,this._callback=void 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"callback",{get:function(){return this._callback},set:function(a){this._callback=a,this._data=void 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dimensions",{get:function(){return this._dimensions},enumerable:!0,configurable:!0}),a}();return e});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/Matrix3",["require","exports","../math/AbstractMatrix"],function(a,b,c){var d=function(a){function b(b){a.call(this,b,3)}return f(b,a),b.identity=function(){return new b(new Float32Array([1,0,0,0,1,0,0,0,1]))},b.zero=function(){return new b(new Float32Array([0,0,0,0,0,0,0,0,0]))},b.prototype.determinant=function(){return 1},b.prototype.getInverse=function(a,b){var c=a.data,d=this.data;d[0]=c[10]*c[5]-c[6]*c[9],d[1]=-c[10]*c[1]+c[2]*c[9],d[2]=c[6]*c[1]-c[2]*c[5],d[3]=-c[10]*c[4]+c[6]*c[8],d[4]=c[10]*c[0]-c[2]*c[8],d[5]=-c[6]*c[0]+c[2]*c[4],d[6]=c[9]*c[4]-c[5]*c[8],d[7]=-c[9]*c[0]+c[1]*c[8],d[8]=c[5]*c[0]-c[1]*c[4];var e=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===e){var f="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(b||!b)throw new Error(f);return console.warn(f),this.identity(),this}return this.scale(1/e),this},b.prototype.identity=function(){return this.set(1,0,0,0,1,0,0,0,1)},b.prototype.multiply=function(a){return this.product(this,a)},b.prototype.row=function(a){var b=this.data;return[b[0+a],b[3+a],b[6+a]]},b.prototype.scale=function(a){var b=this.data;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},b.prototype.product=function(a,b){return this},b.prototype.normalFromMatrix4=function(a){this.getInverse(a).transpose()},b.prototype.set=function(a,b,c,d,e,f,g,h,i){var j=this.data;return j[0]=a,j[3]=b,j[6]=c,j[1]=d,j[4]=e,j[7]=f,j[2]=g,j[5]=h,j[8]=i,this},b.prototype.toString=function(){for(var a=[],b=0;b<this.dimensions;b++)a.push(this.row(b).map(function(a,b){return a.toString()}).join(" "));return a.join("\n")},b.prototype.transpose=function(){var a,b=this.data;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this},b}(c);return d}),b("davinci-eight/math/_M4_x_M4_",["require","exports"],function(a,b){function c(a,b,c){var d=a[0],e=a[4],f=a[8],g=a[12],h=a[1],i=a[5],j=a[9],k=a[13],l=a[2],m=a[6],n=a[10],o=a[14],p=a[3],q=a[7],r=a[11],s=a[15],t=b[0],u=b[4],v=b[8],w=b[12],x=b[1],y=b[5],z=b[9],A=b[13],B=b[2],C=b[6],D=b[10],E=b[14],F=b[3],G=b[7],H=b[11],I=b[15];return c[0]=d*t+e*x+f*B+g*F,c[4]=d*u+e*y+f*C+g*G,c[8]=d*v+e*z+f*D+g*H,c[12]=d*w+e*A+f*E+g*I,c[1]=h*t+i*x+j*B+k*F,c[5]=h*u+i*y+j*C+k*G,c[9]=h*v+i*z+j*D+k*H,c[13]=h*w+i*A+j*E+k*I,c[2]=l*t+m*x+n*B+o*F,c[6]=l*u+m*y+n*C+o*G,c[10]=l*v+m*z+n*D+o*H,c[14]=l*w+m*A+n*E+o*I,c[3]=p*t+q*x+r*B+s*F,c[7]=p*u+q*y+r*C+s*G,c[11]=p*v+q*z+r*D+s*H,c[15]=p*w+q*A+r*E+s*I,c}return c});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/Matrix4",["require","exports","../math/AbstractMatrix","../checks/expectArg","../checks/isDefined","../math/_M4_x_M4_"],function(a,b,c,d,e,g){var h=function(a){function b(b){a.call(this,b,4)}return f(b,a),b.identity=function(){return new b(new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]))},b.zero=function(){return new b(new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]))},b.scaling=function(a){return b.identity().scaling(a)},b.translation=function(a){return b.identity().translation(a)},b.rotation=function(a){return b.identity().rotation(a)},b.prototype.clone=function(){return b.zero().copy(this)},b.prototype.compose=function(a,b,c){return this.scaling(a),this.rotate(b),this.translate(c),this},b.prototype.copy=function(a){return this.data.set(a.data),this},b.prototype.determinant=function(){var a=this.data,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14],n=a[3],o=a[7],p=a[11],q=a[15],r=b*g,s=b*h,t=b*i,u=c*f,v=c*h,w=c*i,x=d*f,y=d*g,z=d*i,A=e*f,B=e*g,C=e*h;return n*((C-z)*k+(w-B)*l+(y-v)*m)+o*((z-C)*j+(A-t)*l+(s-x)*m)+p*((B-w)*j+(t-A)*k+(u-r)*m)+q*((v-y)*j+(x-s)*k+(r-u)*l)},b.prototype.invert=function(a,b){void 0===b&&(b=!1);var c=this.data,d=a.data,e=d[0],f=d[4],g=d[8],h=d[12],i=d[1],j=d[5],k=d[9],l=d[13],m=d[2],n=d[6],o=d[10],p=d[14],q=d[3],r=d[7],s=d[11],t=d[15];c[0]=k*p*r-l*o*r+l*n*s-j*p*s-k*n*t+j*o*t,c[4]=h*o*r-g*p*r-h*n*s+f*p*s+g*n*t-f*o*t,c[8]=g*l*r-h*k*r+h*j*s-f*l*s-g*j*t+f*k*t,c[12]=h*k*n-g*l*n-h*j*o+f*l*o+g*j*p-f*k*p,c[1]=l*o*q-k*p*q-l*m*s+i*p*s+k*m*t-i*o*t,c[5]=g*p*q-h*o*q+h*m*s-e*p*s-g*m*t+e*o*t,c[9]=h*k*q-g*l*q-h*i*s+e*l*s+g*i*t-e*k*t,c[13]=g*l*m-h*k*m+h*i*o-e*l*o-g*i*p+e*k*p,c[2]=j*p*q-l*n*q+l*m*r-i*p*r-j*m*t+i*n*t,c[6]=h*n*q-f*p*q-h*m*r+e*p*r+f*m*t-e*n*t,c[10]=f*l*q-h*j*q+h*i*r-e*l*r-f*i*t+e*j*t,c[14]=h*j*m-f*l*m-h*i*n+e*l*n+f*i*p-e*j*p,c[3]=k*n*q-j*o*q-k*m*r+i*o*r+j*m*s-i*n*s,c[7]=f*o*q-g*n*q+g*m*r-e*o*r-f*m*s+e*n*s,c[11]=g*j*q-f*k*q-g*i*r+e*k*r+f*i*s-e*j*s,c[15]=f*k*m-g*j*m+g*i*n-e*k*n-f*i*o+e*j*o;var u=e*c[0]+i*c[4]+m*c[8]+q*c[12];if(0!==u)return this.scale(1/u);var v="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(b)throw new Error(v);return console.warn(v),this.identity(),this},b.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},b.prototype.scale=function(a){var b=this.data;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},b.prototype.transpose=function(){var a,b=this.data;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},b.prototype.frustum=function(a,b,c,d,e,f){var g=this.data,h=2*e/(b-a),i=2*e/(d-c),j=(b+a)/(b-a),k=(d+c)/(d-c),l=-(f+e)/(f-e),m=-2*f*e/(f-e);return g[0]=h,g[4]=0,g[8]=j,g[12]=0,g[1]=0,g[5]=i,g[9]=k,g[13]=0,g[2]=0,g[6]=0,g[10]=l,g[14]=m,g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},b.prototype.rotationAxis=function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1)},b.prototype.multiply=function(a){return this.product(this,a)},b.prototype.product=function(a,b){return g(a.data,b.data,this.data),this},b.prototype.rotate=function(a){var c=b.rotation(a);return g(c.data,this.data,this.data),this},b.prototype.rotation=function(a){var b=-d("spinor.yz",a.yz).toBeNumber().value,c=-d("spinor.zx",a.zx).toBeNumber().value,e=-d("spinor.xy",a.xy).toBeNumber().value,f=d("spinor.w",a.w).toBeNumber().value,g=b+b,h=c+c,i=e+e,j=b*g,k=b*h,l=b*i,m=c*h,n=c*i,o=e*i,p=f*g,q=f*h,r=f*i;return this.set(1-m-o,k-r,l+q,0,k+r,1-j-o,n-p,0,l-q,n+p,1-j-m,0,0,0,0,1),this},b.prototype.row=function(a){var b=this.data;return[b[0+a],b[4+a],b[8+a],b[12+a]]},b.prototype.scaleXYZ=function(a){var c=b.scaling(a);return g(c.data,this.data,this.data),this},b.prototype.scaling=function(a){return this.set(a.x,0,0,0,0,a.y,0,0,0,0,a.z,0,0,0,0,1)},b.prototype.set=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.data;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},b.prototype.toFixed=function(a){e(a)&&d("digits",a).toBeNumber();for(var b=[],c=0;c<=this.dimensions-1;c++)b.push(this.row(c).map(function(b,c){return b.toFixed(a)}).join(" "));return b.join("\n")},b.prototype.toString=function(){for(var a=[],b=0;3>=b;b++)a.push(this.row(b).map(function(a,b){return a.toString()}).join(" "));return a.join("\n")},b.prototype.translate=function(a){var c=b.translation(a);return g(c.data,this.data,this.data),this},b.prototype.translation=function(a){return this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1)},b.prototype.__mul__=function(a){return a instanceof b?b.identity().product(this,a):"number"==typeof a?this.clone().scale(a):void 0},b.prototype.__rmul__=function(a){return a instanceof b?b.identity().product(a,this):"number"==typeof a?this.clone().scale(a):void 0},b}(c);return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/models/ModelFacet",["require","exports","../math/Matrix3","../math/Matrix4","../i18n/readOnly","../utils/Shareable","../math/Spinor3","../core/Symbolic","../math/Vector3"],function(a,b,c,d,e,g,h,i,j){
var k=function(a){function b(){a.call(this,"ModelFacet"),this._position=new j,this._attitude=new h,this._scaleXYZ=new j([1,1,1]),this.M=d.identity(),this.N=c.identity(),this.R=d.identity(),this.S=d.identity(),this.T=d.identity(),this._position.modified=!0,this._attitude.modified=!0,this._scaleXYZ.modified=!0}return f(b,a),b.prototype.destructor=function(){this._position=void 0,this._attitude=void 0,this._scaleXYZ=void 0,this.M=void 0,this.N=void 0,this.R=void 0,this.S=void 0,this.T=void 0},Object.defineProperty(b.prototype,"attitude",{get:function(){return this._attitude},set:function(a){throw new Error(e("attitude").message)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"position",{get:function(){return this._position},set:function(a){throw new Error(e("position").message)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"scaleXYZ",{get:function(){return this._scaleXYZ},set:function(a){throw new Error(e("scaleXYZ").message)},enumerable:!0,configurable:!0}),b.prototype.getProperty=function(a){switch(a){case b.PROP_ATTITUDE:return this._attitude.data.map(function(a){return a});case b.PROP_POSITION:return this._position.data.map(function(a){return a});default:return void console.warn("ModelFacet.getProperty "+a)}},b.prototype.setProperty=function(a,c){switch(a){case b.PROP_ATTITUDE:this._attitude.yz=c[0],this._attitude.zx=c[1],this._attitude.xy=c[2],this._attitude.w=c[3];break;case b.PROP_POSITION:this._position.set(c[0],c[1],c[2]);break;default:console.warn("ModelFacet.setProperty "+a)}},b.prototype.setUniforms=function(a,b){return this.position?(this._position.modified&&(this.T.translation(this._position),this._position.modified=!1),this._attitude.modified&&(this.R.rotation(this._attitude),this._attitude.modified=!1),this.scaleXYZ.modified&&(this.S.scaling(this.scaleXYZ),this.scaleXYZ.modified=!1),this.M.copy(this.T).multiply(this.R).multiply(this.S),this.N.normalFromMatrix4(this.M),a.uniformMatrix4(i.UNIFORM_MODEL_MATRIX,!1,this.M,b),void a.uniformMatrix3(i.UNIFORM_NORMAL_MATRIX,!1,this.N,b)):void console.warn("setUniforms called on zombie ModelFacet")},b.prototype.incRef=function(){return this.addRef(),this},b.prototype.decRef=function(){return this.release(),this},b.PROP_ATTITUDE="attitude",b.PROP_POSITION="position",b}(g);return k});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/commands/CreateCuboidDrawable",["require","exports","../../uniforms/ColorFacet","../../geometries/CuboidGeometry","../../scene/Drawable","../../materials/PointMaterial","../../materials/LineMaterial","../../materials/MeshMaterial","../../models/ModelFacet","../../utils/Shareable","../../geometries/Simplex","../../math/Vector3"],function(a,b,c,d,e,g,h,i,j,k,l,m){function n(a){switch(a.meta.k){case l.K_FOR_POINT:return new g;case l.K_FOR_LINE_SEGMENT:return new h;case l.K_FOR_TRIANGLE:return new i;default:throw new Error("Unexpected dimensions for simplex: "+a.meta.k)}}var o=function(a){function b(b,c,d,e,f,g,h){void 0===c&&(c=m.e1),void 0===d&&(d=m.e2),void 0===e&&(e=m.e3),void 0===f&&(f=l.K_FOR_TRIANGLE),void 0===g&&(g=0),void 0===h&&(h=0),a.call(this,"CreateCuboidDrawable"),this.name=b,this.a=m.copy(c),this.b=m.copy(d),this.c=m.copy(e),this.k=f,this.subdivide=g,this.boundary=h}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.redo=function(a,b){var f=new d;f.a.copy(this.a),f.b.copy(this.b),f.c.copy(this.c),f.k=this.k,f.subdivide(this.subdivide),f.boundary(this.boundary);var g=f.toElements(),h=n(f),i=new e(g,h);i.setFacet("model",new j).decRef(),i.setFacet("color",new c).decRef().setRGB(1,1,1),b.addDrawable(i,this.name)},b.prototype.undo=function(a,b){b.removeDrawable(this.name).release()},b}(k);return o});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/materials/EmptyMaterial",["require","exports","../materials/Material","../materials/SmartMaterialBuilder","../core/Symbolic"],function(a,b,c,d,e){var g="EmptyMaterial",h=function(a){function b(b,c){void 0===b&&(b=[]),a.call(this,b,g)}return f(b,a),b.prototype.createMaterial=function(){var a=new d;return a.attribute(e.ATTRIBUTE_POSITION,3),a.uniform(e.UNIFORM_COLOR,"vec3"),a.uniform(e.UNIFORM_MODEL_MATRIX,"mat4"),a.uniform(e.UNIFORM_PROJECTION_MATRIX,"mat4"),a.uniform(e.UNIFORM_VIEW_MATRIX,"mat4"),a.uniform(e.UNIFORM_POINT_SIZE,"float"),a.build(this.monitors)},b}(c);return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/commands/CreateDrawable",["require","exports","../../uniforms/ColorFacet","../../scene/Drawable","../../materials/EmptyMaterial","../../materials/PointMaterial","../../materials/LineMaterial","../../materials/MeshMaterial","../../models/ModelFacet","../../utils/Shareable","../../geometries/Simplex"],function(a,b,c,d,e,g,h,i,j,k,l){function m(a){switch(a.meta.k){case l.K_FOR_TRIANGLE:return new i;case l.K_FOR_LINE_SEGMENT:return new h;case l.K_FOR_POINT:return new g;case l.K_FOR_EMPTY:return new e;default:throw new Error("Unexpected dimensionality for simplex: "+a.meta.k)}}var n=function(a){function b(b,c){a.call(this,"CreateDrawable"),this.name=b,this.geometry=c,this.geometry.addRef()}return f(b,a),b.prototype.destructor=function(){this.geometry.release(),this.geometry=void 0,a.prototype.destructor.call(this)},b.prototype.redo=function(a,b){var e=this.geometry.toElements(),f=m(this.geometry),g=new d(e,f);g.setFacet("model",new j).decRef(),g.setFacet("color",new c).decRef().setRGB(1,1,1),b.addDrawable(g,this.name)},b.prototype.undo=function(a,b){b.removeDrawable(this.name).release()},b}(k);return n});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/commands/DestroyDrawableCommand",["require","exports","../../utils/Shareable"],function(a,b,c){var d=function(a){function b(b){a.call(this,"DestroyDrawableCommand"),this.name=b}return f(b,a),b.prototype.destructor=function(){this.drawable&&(this.drawable.release(),this.drawable=void 0),a.prototype.destructor.call(this)},b.prototype.redo=function(a,b){this.drawable=b.removeDrawable(this.name)},b.prototype.undo=function(a,b){b.addDrawable(this.drawable,this.name),this.drawable.release(),this.drawable=void 0},b}(c);return d});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/commands/UseDrawableInSceneCommand",["require","exports","../../utils/Shareable"],function(a,b,c){var d=function(a){function b(b,c,d){a.call(this,"TestCommand"),this.drawableName=b,this.sceneName=c,this.confirm=d}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.redo=function(a,b){this.wasHere=b.isDrawableInScene(this.drawableName,this.sceneName),b.useDrawableInScene(this.drawableName,this.sceneName,this.confirm)},b.prototype.undo=function(a,b){b.useDrawableInScene(this.drawableName,this.sceneName,this.wasHere)},b}(c);return d});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/SlideCommands",["require","exports","../collections/IUnknownArray","../utils/Shareable","../slideshow/animations/ColorAnimation","../slideshow/animations/Vector3Animation","../slideshow/animations/Spinor3Animation","../slideshow/commands/AnimateDrawableCommand","../slideshow/commands/CreateCuboidDrawable","../slideshow/commands/CreateDrawable","../slideshow/commands/DestroyDrawableCommand","../slideshow/commands/UseDrawableInSceneCommand"],function(a,b,c,d,e,g,h,i,j,k,l,m){var n=function(a){function b(b){a.call(this,"SlideCommands"),this.commands=new c([],b)}return f(b,a),b.prototype.destructor=function(){this.commands.release(),this.commands=void 0,a.prototype.destructor.call(this)},b.prototype.animateDrawable=function(a,b,c,d){return this.commands.pushWeakRef(new i(a,b,c,d))},b.prototype.attitude=function(a,b,c,d){return this.animateDrawable(a,"model","attitude",new h(b,c,d))},b.prototype.color=function(a,b,c,d){return this.animateDrawable(a,"color","rgb",new e(b,c,d))},b.prototype.createDrawable=function(a,b){return this.commands.pushWeakRef(new k(a,b))},b.prototype.cuboid=function(a,b,c,d,e,f,g){return this.commands.pushWeakRef(new j(a,b,c,d,e,f,g))},b.prototype.destroyDrawable=function(a){return this.commands.pushWeakRef(new l(a))},b.prototype.position=function(a,b,c,d){return this.animateDrawable(a,"model","position",new g(b,c,d))},b.prototype.useDrawableInScene=function(a,b,c){return this.commands.pushWeakRef(new m(a,b,c))},b.prototype.pushWeakRef=function(a){return this.commands.pushWeakRef(a)},b.prototype.redo=function(a,b){for(var c=0,d=this.commands.length;d>c;c++)this.commands.getWeakRef(c).redo(a,b)},b.prototype.undo=function(a,b){for(var c=this.commands.length-1;c>=0;c--)this.commands.getWeakRef(c).undo(a,b)},b}(d);return n});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/Slide",["require","exports","../collections/IUnknownArray","../utils/Shareable","../slideshow/SlideCommands","../collections/StringIUnknownMap"],function(a,b,c,d,e,g){var h=function(a){function b(){a.call(this,"Slide"),this.now=0,this.prolog=new e("Slide.prolog"),this.epilog=new e("Slide.epilog"),this.targets=new c([],"Slide.targets"),this.mirrors=new g("Slide.mirrors")}return f(b,a),b.prototype.destructor=function(){this.prolog.release(),this.prolog=void 0,this.epilog.release(),this.epilog=void 0,this.targets.release(),this.targets=void 0,this.mirrors.release(),this.mirrors=void 0,a.prototype.destructor.call(this)},b.prototype.ensureTarget=function(a){this.targets.indexOf(a)<0&&this.targets.push(a)},b.prototype.ensureMirror=function(a){this.mirrors.exists(a.uuid)||this.mirrors.putWeakRef(a.uuid,new j)},b.prototype.pushAnimation=function(a,b,c){this.ensureTarget(a),this.ensureMirror(a);var d=this.mirrors.getWeakRef(a.uuid);d.ensureAnimationLane(b);var e=d.animationLanes.getWeakRef(b);e.push(c)},b.prototype.popAnimation=function(a,b){var c=this.mirrors.getWeakRef(a.uuid),d=c.animationLanes.getWeakRef(b);return d.pop()},b.prototype.advance=function(a){this.now+=a;for(var b=0;b<this.targets.length;b++)for(var c=this.targets.getWeakRef(b),d=0,e=this.mirrors.getWeakRef(c.uuid),f=e.animationLanes.keys,g=0;g<f.length;g++){var h=f[g],i=e.animationLanes.getWeakRef(h);d=i.apply(c,h,this.now,d)}},b.prototype.doProlog=function(a,b){b?this.prolog.redo(this,a):this.prolog.undo(this,a)},b.prototype.doEpilog=function(a,b){b?this.epilog.redo(this,a):this.epilog.undo(this,a)},b.prototype.undo=function(a){for(var b=0;b<this.targets.length;b++)for(var c=this.targets.getWeakRef(b),d=this.mirrors.getWeakRef(c.uuid),e=d.animationLanes.keys,f=0;f<e.length;f++){var g=e[f],h=d.animationLanes.getWeakRef(g);h.undo(c,g)}},b}(d),i=function(a){function b(){a.call(this,"AnimationLane"),this.completed=new c([],"AnimationLane.remaining"),this.remaining=new c([],"AnimationLane.remaining")}return f(b,a),b.prototype.destructor=function(){this.completed.release(),this.completed=void 0,this.remaining.release(),this.remaining=void 0,a.prototype.destructor.call(this)},b.prototype.pop=function(){return this.remaining.length>0?this.remaining.pop():this.completed.pop()},b.prototype.push=function(a){return this.remaining.push(a)},b.prototype.pushWeakRef=function(a){return this.remaining.pushWeakRef(a)},b.prototype.apply=function(a,b,c,d){for(var e=!1;!e;)if(this.remaining.length>0){var f=this.remaining.getWeakRef(0);f.apply(a,b,c,d),f.done(a,b)?(d=f.extra(c),this.completed.push(this.remaining.shift())):e=!0}else e=!0;return d},b.prototype.undo=function(a,b){for(;this.completed.length>0;)this.remaining.unshift(this.completed.pop());for(var c=this.remaining.length-1;c>=0;c--){var d=this.remaining.getWeakRef(c);d.undo(a,b)}},b}(d),j=function(a){function b(){a.call(this,"Mirror"),this.animationLanes=new g("Mirror.animationLanes")}return f(b,a),b.prototype.destructor=function(){this.animationLanes.release(),this.animationLanes=void 0,a.prototype.destructor.call(this)},b.prototype.ensureAnimationLane=function(a){this.animationLanes.exists(a)||this.animationLanes.putWeakRef(a,new i)},b}(d);return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/Director",["require","exports","../slideshow/Slide","../checks/isDefined","../collections/IUnknownArray","../checks/mustBeDefined","../checks/mustBeString","../collections/NumberIUnknownMap","../utils/Shareable","../collections/StringIUnknownMap"],function(a,b,c,d,e,g,h,i,j,k){var l=function(a){function b(){a.call(this,"Director"),this.step=-1,this.slides=new e([],"Director.slides"),this.contexts=new i,this.scenes=new k("Director.scenes"),this.drawables=new k("Director.drawables"),this.geometries=new k("Director.geometries"),this.facets=new k("Director.facets"),this.sceneNamesByCanvasId={},this.facetsByCanvasId=new i}return f(b,a),b.prototype.destructor=function(){this.slides.release(),this.slides=void 0,this.contexts.forEach(function(a,b){b.stop()}),this.contexts.release(),this.contexts=void 0,this.scenes.release(),this.scenes=void 0,this.drawables.release(),this.drawables=void 0,this.geometries.release(),this.geometries=void 0,this.facets.release(),this.facets=void 0,this.facetsByCanvasId.release(),this.facetsByCanvasId=void 0},b.prototype.addCanvas3D=function(a){this.contexts.put(a.canvasId,a)},b.prototype.getCanvas3D=function(a){return this.contexts.get(a)},b.prototype.removeCanvas3D=function(a){this.contexts.remove(a)},b.prototype.addDrawable=function(a,b){this.drawables.put(b,a)},b.prototype.getDrawable=function(a){return d(a)?(h("drawableName",a),this.drawables.get(a)):void 0},b.prototype.removeDrawable=function(a){return this.drawables.remove(a)},b.prototype.addFacet=function(a,b){this.facets.put(b,a)},b.prototype.getFacet=function(a){return this.facets.get(a)},b.prototype.removeFacet=function(a){return this.facets.remove(a)},b.prototype.addGeometry=function(a,b){this.geometries.put(a,b)},b.prototype.removeGeometry=function(a){return this.geometries.remove(a)},b.prototype.getGeometry=function(a){return this.geometries.get(a)},b.prototype.addScene=function(a,b){this.scenes.put(b,a)},b.prototype.getScene=function(a){return this.scenes.get(a)},b.prototype.removeScene=function(a){return this.scenes.remove(a)},b.prototype.isDrawableInScene=function(a,b){h("drawableName",a),h("sceneName",b);var c=this.drawables.getWeakRef(a);g(a,c);var d=this.scenes.getWeakRef(b);return g(b,d),d.containsDrawable(c)},b.prototype.useDrawableInScene=function(a,b,c){h("drawableName",a),h("sceneName",b);var d=this.drawables.getWeakRef(a);g(a,d);var e=this.scenes.getWeakRef(b);g(b,e),c?e.add(d):e.remove(d)},b.prototype.useSceneOnCanvas=function(a,b,c){var d=this.sceneNamesByCanvasId[b];if(d){var e=d.indexOf(a);0>e?c&&d.push(a):c||(d.splice(e,1),0===d.length&&delete this.sceneNamesByCanvasId[b])}else c&&(this.sceneNamesByCanvasId[b]=[a])},b.prototype.useFacetOnCanvas=function(a,b,c){var d=this.facets.get(a);if(d)try{var e=this.facetsByCanvasId.get(b);e||(e=new k("Director"),this.facetsByCanvasId.put(b,e)),e.put(a,d),e.release()}finally{d.release()}else console.warn(a+" is not a recognized facet")},b.prototype.createSlide=function(){return new c},b.prototype.go=function(a,b){if(void 0===b&&(b=!1),0!==this.slides.length)for(;0>a;)a+=this.slides.length+1},b.prototype.forward=function(a,b){if(void 0===a&&(a=!0),void 0===b&&(b=0),this.canForward()){var c=this.slides.getWeakRef(this.step),d=this.slides.getWeakRef(this.step+1),e=this,f=function(){c&&c.doEpilog(e,!0),d&&d.doProlog(e,!0),e.step++};b?setTimeout(f,b):f()}},b.prototype.canForward=function(){return this.step<this.slides.length},b.prototype.backward=function(a,b){if(void 0===a&&(a=!0),void 0===b&&(b=0),this.canBackward()){var c=this.slides.getWeakRef(this.step),d=this.slides.getWeakRef(this.step-1),e=this,f=function(){c&&(c.undo(e),c.doProlog(e,!1)),d&&d.doEpilog(e,!1),e.step--};b?setTimeout(f,b):f()}},b.prototype.canBackward=function(){return this.step>-1},b.prototype.pushSlide=function(a){return this.slides.push(a)},b.prototype.advance=function(a){var b=this.step;if(b>=0&&b<this.slides.length){var c=this.slides.get(b);if(c)try{c.advance(a)}finally{c.release()}else console.warn("No slide found at index "+this.step)}},b.prototype.render=function(){for(var a=this.contexts.keys,b=0,c=a.length;c>b;b++){var d=a[b],e=(this.contexts.getWeakRef(d),this.facetsByCanvasId.getWeakRef(d)),f=this.sceneNamesByCanvasId[d];if(f)for(var g=0,h=f.length;h>g;g++){var i=f[g],j=this.scenes.getWeakRef(i);j.draw(e.values,d)}}},b}(j);return l});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/DirectorKeyboardHandler",["require","exports","../utils/Shareable"],function(a,b,c){var d=function(a){function b(b){a.call(this,"DirectorKeyboardHandler"),this.director=b,this.director.addRef()}return f(b,a),b.prototype.destructor=function(){this.director.release(),this.director=void 0,a.prototype.destructor.call(this)},b.prototype.keyDown=function(a){},b.prototype.keyUp=function(a){switch(a.keyCode){case 37:this.director.backward();break;case 39:this.director.forward()}},b}(c);return d});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/animations/WaitAnimation",["require","exports","../../utils/Shareable"],function(a,b,c){var d=function(a){function b(b){a.call(this,"WaitAnimation"),this.duration=b,this.fraction=0}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.apply=function(a,b,c,d){this.start||(this.start=c-d),this.duration>0?this.fraction=Math.min(1,(c-this.start)/this.duration):this.fraction=1},b.prototype.skip=function(){this.duration=0},b.prototype.hurry=function(a){this.duration=this.duration*this.fraction+this.duration*(1-this.fraction)/a},b.prototype.extra=function(a){return a-this.start-this.duration},b.prototype.done=function(a,b){return 1===this.fraction},b.prototype.undo=function(a,b){this.start=void 0,this.fraction=0},b}(c);return d});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/slideshow/commands/TestCommand",["require","exports","../../utils/Shareable"],function(a,b,c){var d=function(a){function b(b){a.call(this,"TestCommand"),this.name=b}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.redo=function(a,b){console.log("redo => "+this.name)},b.prototype.undo=function(a,b){console.log("undo => "+this.name)},b}(c);return d}),b("davinci-eight/checks/isObject",["require","exports"],function(a,b){function c(a){return"object"==typeof a}return c}),b("davinci-eight/checks/mustBeObject",["require","exports","../checks/mustSatisfy","../checks/isObject"],function(a,b,c,d){function e(){return"be an `object`"}function f(a,b,f){return c(a,d(b),e,f),b}return f}),b("davinci-eight/cameras/viewArray",["require","exports","../math/Vector3","../checks/expectArg","../checks/isDefined"],function(a,b,c,d,e){function f(a,b,f,g){var h=e(g)?g:new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);d("matrix",h).toSatisfy(16===h.length,"matrix must have length 16");var i=(new c).difference(a,b);0===i.x&&0===i.y&&0===i.z?i.z=1:i.normalize();var j=(new c).crossVectors(f,i),k=(new c).crossVectors(i,j),l=new c([c.dot(a,j),c.dot(a,k),c.dot(a,i)]).scale(-1);return h[0]=j.x,h[4]=j.y,h[8]=j.z,h[12]=l.x,h[1]=k.x,h[5]=k.y,h[9]=k.z,h[13]=l.y,h[2]=i.x,h[6]=i.y,h[10]=i.z,h[14]=l.z,h[3]=0,h[7]=0,h[11]=0,h[15]=1,h}return f}),b("davinci-eight/cameras/viewMatrix",["require","exports","../checks/isDefined","../math/Matrix4","../cameras/viewArray"],function(a,b,c,d,e){function f(a,b,f,g){var h=c(g)?g:d.identity();return e(a,b,f,h.data),h}return f}),b("davinci-eight/cameras/createView",["require","exports","../math/Vector3","../math/Matrix4","../checks/mustBeNumber","../checks/mustBeObject","../core/Symbolic","../checks/isUndefined","../cameras/viewMatrix"],function(a,b,c,d,e,f,g,h,i){var j=function(a){var b=1,j=new c,k=new c,l=c.e2,m=d.identity(),n=h(a.viewMatrixName)?g.UNIFORM_VIEW_MATRIX:a.viewMatrixName;j.modified=!0,k.modified=!0,l.modified=!0;var o={addRef:function(){return b++,b},release:function(){return b--,b},get uuid(){return""},getProperty:function(a){return void 0},setProperty:function(a,b){},get eye(){return j},set eye(a){o.setEye(a)},setEye:function(a){return f("eye",a),j.x=e("eye.x",a.x),j.y=e("eye.y",a.y),j.z=e("eye.z",a.z),o},get look(){return k},set look(a){o.setLook(a)},setLook:function(a){return f("look",a),k.x=a.x,k.y=a.y,k.z=a.z,o},get up(){return l},set up(a){o.setUp(a)},setUp:function(a){return f("up",a),l.x=a.x,l.y=a.y,l.z=a.z,l.normalize(),o},setUniforms:function(a,b){(j.modified||k.modified||l.modified)&&(i(j,k,l,m),j.modified=!1,k.modified=!1,l.modified=!1),a.uniformMatrix4(n,!1,m,b)}};return o};return j}),b("davinci-eight/cameras/createFrustum",["require","exports","davinci-eight/cameras/createView","davinci-eight/math/Matrix4","../math/MutableNumber"],function(a,b,c,d,e){var f=function(a,b){function f(){o.frustum(i.x,j.x,k.x,l.x,m.x,n.x)}var g=1,h=c(a),i=new e,j=new e,k=new e,l=new e,m=new e,n=new e,o=d.identity();f();var p={addRef:function(){return g++,g},release:function(){return g--,g},get uuid(){return""},getProperty:function(a){return void 0},setProperty:function(a,b){},get eye(){return h.eye},set eye(a){h.eye=a},setEye:function(a){return h.setEye(a),p},get look(){return h.look},set look(a){h.look=a},setLook:function(a){return h.setLook(a),p},get up(){return h.up},set up(a){h.setUp(a)},setUp:function(a){return h.setUp(a),p},get left(){return i.x},set left(a){i.x=a,f()},get right(){return j.x},set right(a){j.x=a,f()},get bottom(){return k.x},set bottom(a){k.x=a,f()},get top(){return l.x},set top(a){l.x=a,f()},get near(){return m.x},set near(a){m.x=a,f()},get far(){return n.x},set far(a){n.x=a,f()},setUniforms:function(a,c){a.uniformMatrix4(b,!1,o,c),h.setUniforms(a,c)}};return p};return f}),b("davinci-eight/cameras/frustumMatrix",["require","exports","../checks/expectArg","../checks/isDefined"],function(a,b,c,d){function e(a,b,e,f,g,h,i){c("left",a).toBeNumber(),c("right",b).toBeNumber(),c("bottom",e).toBeNumber(),c("top",f).toBeNumber(),c("near",g).toBeNumber(),c("far",h).toBeNumber();var j=d(i)?i:new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);c("m",j).toSatisfy(16===j.length,"elements must have length 16");var k=2*g/(b-a),l=2*g/(f-e),m=(b+a)/(b-a),n=(f+e)/(f-e),o=-(h+g)/(h-g),p=-2*h*g/(h-g);return j[0]=k,j[4]=0,j[8]=m,j[12]=0,j[1]=0,j[5]=l,j[9]=n,j[13]=0,j[2]=0,j[6]=0,j[10]=o,j[14]=p,j[3]=0,j[7]=0,j[11]=-1,j[15]=0,j}return e}),b("davinci-eight/cameras/perspectiveArray",["require","exports","../cameras/frustumMatrix","../checks/expectArg"],function(a,b,c,d){function e(a,b,e,f,g){d("fov",a).toBeNumber(),d("aspect",b).toBeNumber(),d("near",e).toBeNumber(),d("far",f).toBeNumber();var h=e*Math.tan(.5*a),i=-h,j=i*b,k=h*b;return c(j,k,i,h,e,f,g)}return e}),b("davinci-eight/cameras/perspectiveMatrix",["require","exports","../checks/isDefined","../math/Matrix4","../cameras/perspectiveArray"],function(a,b,c,d,e){function f(a,b,f,g,h){var i=c(h)?h:d.identity();return e(a,b,f,g,i.data),i}return f}),b("davinci-eight/cameras/createPerspective",["require","exports","../cameras/createView","../math/Matrix4","../core/Symbolic","../math/MutableNumber","../checks/isUndefined","../checks/expectArg","../cameras/perspectiveMatrix"],function(a,b,c,d,e,f,g,h,i){var j=function(a){a=a||{};var b=new f([g(a.fov)?75*Math.PI/180:a.fov]),j=new f([g(a.aspect)?1:a.aspect]),k=new f([g(a.near)?.1:a.near]),l=new f([h("options.far",g(a.far)?2e3:a.far).toBeNumber().value]),m=g(a.projectionMatrixName)?e.UNIFORM_PROJECTION_MATRIX:a.projectionMatrixName,n=1,o=c(a),p=d.identity(),q=!0,r={addRef:function(){return n++,n},release:function(){return n--,n},get uuid(){return""},getProperty:function(a){return void 0},setProperty:function(a,b){},get eye(){return o.eye},set eye(a){o.eye=a},setEye:function(a){return o.setEye(a),r},get look(){return o.look},set look(a){o.look=a},setLook:function(a){return o.setLook(a),r},get up(){return o.up},set up(a){o.up=a},setUp:function(a){return o.setUp(a),r},get fov(){return b.x},set fov(a){r.setFov(a)},setFov:function(a){return h("fov",a).toBeNumber(),q=q||b.x!==a,b.x=a,r},get aspect(){return j.x},set aspect(a){r.setAspect(a)},setAspect:function(a){return h("aspect",a).toBeNumber(),q=q||j.x!==a,j.x=a,r},get near(){return k.x},set near(a){r.setNear(a)},setNear:function(a){return h("near",a).toBeNumber(),q=q||k.x!==a,k.x=a,r},get far(){return l.x},set far(a){r.setFar(a)},setFar:function(a){return h("far",a).toBeNumber(),q=q||l.x!==a,l.x=a,r},setUniforms:function(a,c){q&&(i(b.x,j.x,k.x,l.x,p),q=!1),a.uniformMatrix4(m,!1,p,c),o.setUniforms(a,c)}};return r};return j});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/commands/WebGLBlendFunc",["require","exports","../checks/mustBeNumber","../utils/Shareable"],function(a,b,c,d){function e(a,b){if(g.indexOf(b)>=0)return b;throw new Error(b+" is not a valid factor. Factor must be one of "+JSON.stringify(g))}var g=["ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","DST_ALPHA","ONE_MINUS_DST_ALPHA","SRC_ALPHA_SATURATE"],h=function(a){function b(b,c){a.call(this,"WebGLBlendFunc"),this.sfactor=e("sfactor",b),this.dfactor=e("dfactor",c)}return f(b,a),b.prototype.contextFree=function(a){},b.prototype.contextGain=function(a){this.execute(a.gl)},b.prototype.contextLost=function(a){},b.prototype.execute=function(a){var b=c("sfactor => "+this.sfactor,a[this.sfactor]),d=c("dfactor => "+this.dfactor,a[this.dfactor]);a.blendFunc(b,d)},b.prototype.destructor=function(){this.sfactor=void 0,this.dfactor=void 0},b}(d);return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/commands/WebGLClearColor",["require","exports","../checks/mustBeNumber","../utils/Shareable"],function(a,b,c,d){var e=function(a){function b(b,d,e,f){void 0===b&&(b=0),void 0===d&&(d=0),void 0===e&&(e=0),void 0===f&&(f=1),a.call(this,"WebGLClearColor"),this.red=c("red",b),this.green=c("green",d),this.blue=c("blue",e),this.alpha=c("alpha",f)}return f(b,a),b.prototype.contextFree=function(a){},b.prototype.contextGain=function(a){c("red",this.red),c("green",this.green),c("blue",this.blue),c("alpha",this.alpha),a.gl.clearColor(this.red,this.green,this.blue,this.alpha)},b.prototype.contextLost=function(a){},b.prototype.destructor=function(){this.red=void 0,this.green=void 0,this.blue=void 0,this.alpha=void 0,a.prototype.destructor.call(this)},b}(d);return e});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/commands/WebGLDisable",["require","exports","../checks/mustBeNumber","../checks/mustBeString","../utils/Shareable"],function(a,b,c,d,e){var g=function(a){function b(b){a.call(this,"WebGLDisable"),this._capability=d("capability",b)}return f(b,a),b.prototype.contextFree=function(a){},b.prototype.contextGain=function(a){a.gl.disable(c(this._capability,a.gl[this._capability]))},b.prototype.contextLost=function(a){},b.prototype.destructor=function(){this._capability=void 0,a.prototype.destructor.call(this)},b}(e);return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/commands/WebGLEnable",["require","exports","../checks/mustBeNumber","../checks/mustBeString","../utils/Shareable"],function(a,b,c,d,e){var g=function(a){function b(b){a.call(this,"WebGLEnable"),this._capability=d("capability",b)}return f(b,a),b.prototype.contextFree=function(a){},b.prototype.contextGain=function(a){a.gl.enable(c(this._capability,a.gl[this._capability]))},b.prototype.contextLost=function(a){},b.prototype.destructor=function(){this._capability=void 0,a.prototype.destructor.call(this)},b}(e);return g}),b("davinci-eight/core/DrawMode",["require","exports"],function(a,b){var c;return function(a){a[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.TRIANGLES=2]="TRIANGLES"}(c||(c={})),c}),b("davinci-eight/curves/Curve",["require","exports"],function(a,b){var c=function(){function a(){}return a.prototype.getPoint=function(a){throw new Error("Curve.getPoint() not implemented!")},a.prototype.getPointAt=function(a){var b=this.getUtoTmapping(a);return this.getPoint(b)},a.prototype.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;a>=b;b++)c.push(this.getPoint(b/a));return c},a.prototype.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;a>=b;b++)c.push(this.getPointAt(b/a));return c},a.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]},a.prototype.getLengths=function(a){if(a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b,c,d=[],e=this.getPoint(0),f=0;for(d.push(0),c=1;a>=c;c++)b=this.getPoint(c/a),f+=b.distanceTo(e),d.push(f),e=b;return this.cacheArcLengths=d,d},a.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},a.prototype.getUtoTmapping=function(a,b){var c,d=this.getLengths(),e=0,f=d.length;c=b?b:a*d[f-1];for(var g,h=0,i=f-1;i>=h;)if(e=Math.floor(h+(i-h)/2),g=d[e]-c,0>g)h=e+1;else{if(!(g>0)){i=e;break}i=e-1}if(e=i,d[e]==c){var j=e/(f-1);return j}var k=d[e],l=d[e+1],m=l-k,n=(c-k)/m,j=(e+n)/(f-1);return j},a.prototype.getTangent=function(a){var b=1e-4,c=a-b,d=a+b;0>c&&(c=0),d>1&&(d=1);var e=this.getPoint(c),f=this.getPoint(d),g=f.clone().sub(e);return g.normalize()},a.prototype.getTangentAt=function(a){var b=this.getUtoTmapping(a);return this.getTangent(b)},a}();return c});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/devices/Keyboard",["require","exports","../utils/Shareable"],function(a,b,c){function d(a,b){return function(c){a.currentlyPressedKeys[c.keyCode]=!0,b.keyDown(c)}}function e(a,b){return function(c){a.currentlyPressedKeys[c.keyCode]=!1,b.keyUp(c)}}var g=function(a){function b(b,c){void 0===c&&(c=window.document),
a.call(this,"Keyboard"),this.currentlyPressedKeys=[],this.attach(b,c)}return f(b,a),b.prototype.destructor=function(){this.detach(),a.prototype.destructor.call(this)},b.prototype.attach=function(a,b,c){void 0===b&&(b=window.document),this.document!==b&&(this.detach(),this.handler=a,this.handler.addRef(),this.document=b,this.useCapture=c,this.keyDownHandler=d(this,a),this.keyUpHandler=e(this,a),this.document.addEventListener("keydown",this.keyDownHandler,c),this.document.addEventListener("keyup",this.keyUpHandler,c))},b.prototype.detach=function(){this.document&&(this.document.removeEventListener("keydown",this.keyDownHandler,this.useCapture),this.document.removeEventListener("keyup",this.keyUpHandler,this.useCapture),this.handler.release(),this.handler=void 0,this.document=void 0,this.useCapture=void 0,this.keyDownHandler=void 0,this.keyUpHandler=void 0)},b}(c);return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/Vector2",["require","exports","../math/VectorN"],function(a,b,c){var d=function(a){function b(b,c){void 0===b&&(b=[0,0]),void 0===c&&(c=!1),a.call(this,b,c,2)}return f(b,a),Object.defineProperty(b.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.modified=this.modified||this.x!==a,this.data[0]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this.data[1]},set:function(a){this.modified=this.modified||this.y!==a,this.data[1]=a},enumerable:!0,configurable:!0}),b.prototype.set=function(a,b){return this.x=a,this.y=b,this},b.prototype.setX=function(a){return this.x=a,this},b.prototype.setY=function(a){return this.y=a,this},b.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this},b.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},b.prototype.addScalar=function(a){return this.x+=a,this.y+=a,this},b.prototype.sum=function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},b.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},b.prototype.subScalar=function(a){return this.x-=a,this.y-=a,this},b.prototype.difference=function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},b.prototype.multiply=function(a){return this.x*=a.x,this.y*=a.y,this},b.prototype.scale=function(a){return this.x*=a,this.y*=a,this},b.prototype.divide=function(a){return this.x/=a.x,this.y/=a.y,this},b.prototype.divideScalar=function(a){if(0!==a){var b=1/a;this.x*=b,this.y*=b}else this.x=0,this.y=0;return this},b.prototype.min=function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this},b.prototype.max=function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this},b.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},b.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},b.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},b.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},b.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},b.prototype.distanceTo=function(a){return Math.sqrt(this.quadranceTo(a))},b.prototype.dot=function(a){return this.x*a.x+this.y*a.y},b.prototype.magnitude=function(){return Math.sqrt(this.quaditude())},b.prototype.normalize=function(){return this.divideScalar(this.magnitude())},b.prototype.quaditude=function(){return this.x*this.x+this.y*this.y},b.prototype.quadranceTo=function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},b.prototype.reflect=function(a){return this},b.prototype.rotate=function(a){return this},b.prototype.setMagnitude=function(a){var b=this.magnitude();return 0!==b&&a!==b&&this.scale(a/b),this},b.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},b.prototype.lerpVectors=function(a,b,c){return this.difference(b,a).scale(c).add(a),this},b.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},b.prototype.fromArray=function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this},b.prototype.fromAttribute=function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this.y=a.array[b+1],this},b.prototype.clone=function(){return new b([this.x,this.y])},b}(c);return d}),b("davinci-eight/geometries/cube",["require","exports","../geometries/quadrilateral","../core/Symbolic","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,f){function g(a){void 0===a&&(a=1);var b=a/2,g=new f([+b,+b,+b]),h=new f([-b,+b,+b]),i=new f([-b,-b,+b]),j=new f([+b,-b,+b]),k=new f([+b,-b,-b]),l=new f([+b,+b,-b]),m=new f([-b,+b,-b]),n=new f([-b,-b,-b]),o=new e([0,0]),p=new e([0,1]),q=new e([1,0]),r=new e([1,1]),s={};s[d.ATTRIBUTE_TEXTURE_COORDS]=[r,p,o,q];var t=c(g,h,i,j,s),u=c(g,j,k,l,s),v=c(g,l,m,h,s),w=c(h,m,n,i,s),x=c(n,k,j,i,s),y=c(k,n,m,l,s),z=[t,u,v,w,x,y];return z.reduce(function(a,b){return a.concat(b)},[])}return g}),b("davinci-eight/geometries/square",["require","exports","../geometries/quadrilateral","../core/Symbolic","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,f){function g(a){void 0===a&&(a=1);var b=a/2,g=new f([+b,+b,0]),h=new f([-b,+b,0]),i=new f([-b,-b,0]),j=new f([+b,-b,0]),k=new e([0,0]),l=new e([0,1]),m=new e([1,0]),n=new e([1,1]),o=[n,l,k,m],p={};return p[d.ATTRIBUTE_TEXTURE_COORDS]=o,c(g,h,i,j,p)}return g}),b("davinci-eight/geometries/tetrahedron",["require","exports","../checks/expectArg","../geometries/triangle","../math/VectorN"],function(a,b,c,d,e){function f(a,b,f,g,h,i){void 0===h&&(h={}),void 0===i&&(i=[]),c("a",a).toSatisfy(a instanceof e,"a must be a VectorN"),c("b",b).toSatisfy(b instanceof e,"b must be a VectorN"),c("c",f).toSatisfy(f instanceof e,"c must be a VectorN"),c("d",g).toSatisfy(g instanceof e,"d must be a VectorN");var j={},k=[a,b,f,g],l=[];return d(k[0],k[1],k[2],j,i),l.push(i[i.length-1]),d(k[1],k[3],k[2],j,i),l.push(i[i.length-1]),d(k[2],k[3],k[0],j,i),l.push(i[i.length-1]),d(k[3],k[1],k[0],j,i),l.push(i[i.length-1]),l[3].vertices[0].opposing.push(l[0]),l[3].vertices[1].opposing.push(l[1]),l[3].vertices[2].opposing.push(l[2]),l[0].vertices[0].opposing.push(l[1]),l[0].vertices[1].opposing.push(l[3]),l[0].vertices[2].opposing.push(l[2]),l[1].vertices[0].opposing.push(l[2]),l[1].vertices[1].opposing.push(l[3]),l[1].vertices[2].opposing.push(l[0]),l[2].vertices[0].opposing.push(l[3]),l[2].vertices[1].opposing.push(l[1]),l[2].vertices[2].opposing.push(l[0]),i}return f});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/scene/createDrawList",["require","exports","../collections/IUnknownArray","../collections/NumberIUnknownMap","../utils/refChange","../utils/Shareable","../collections/StringIUnknownMap","../utils/uuid4"],function(a,b,c,d,e,g,h,i){var j="createDrawList",k="DrawableGroup",l="DrawableGroups",m=function(){function a(a){this._drawables=new c([],k),this._refCount=1,this._uuid=i().generate(),this._program=a,this._program.addRef(),e(this._uuid,k,1)}return a.prototype.addRef=function(){return this._refCount++,e(this._uuid,k,1),this._refCount},a.prototype.release=function(){return this._refCount--,e(this._uuid,k,-1),0===this._refCount?(this._program.release(),this._program=void 0,this._drawables.release(),this._drawables=void 0,this._refCount=void 0,this._uuid=void 0,0):this._refCount},Object.defineProperty(a.prototype,"material",{get:function(){return this._program.addRef(),this._program},enumerable:!0,configurable:!0}),a.prototype.acceptProgram=function(a){a(this._program)},Object.defineProperty(a.prototype,"length",{get:function(){return this._drawables.length},enumerable:!0,configurable:!0}),a.prototype.containsDrawable=function(a){return this._drawables.indexOf(a)>=0},a.prototype.push=function(a){this._drawables.push(a)},a.prototype.remove=function(a){var b=this._drawables,c=b.indexOf(a);c>=0&&b.splice(c,1).release()},a.prototype.draw=function(a,b){var c,d,e=this._drawables,f=this._program;for(f.use(b),a&&a.forEach(function(a){a.setUniforms(f,b)}),d=e.length,c=0;d>c;c++){var g=e.get(c);g.draw(b),g.release()}},a.prototype.traverseDrawables=function(a){this._drawables.forEach(a)},a}(),n=function(a){function b(){a.call(this,l),this._groups=new h(l)}return f(b,a),b.prototype.destructor=function(){this._groups.release(),this._groups=void 0,a.prototype.destructor.call(this)},b.prototype.add=function(a){var b=a.material;if(b)try{var c=b.programId,d=this._groups.get(c);d||(d=new m(b),this._groups.put(c,d)),d.containsDrawable(a)||d.push(a),d.release()}finally{b.release()}},b.prototype.containsDrawable=function(a){var b=a.material;if(!b)return!1;try{var c=this._groups.getWeakRef(b.programId);return c?c.containsDrawable(a):!1}finally{b.release()}},b.prototype.remove=function(a){var b=a.material;if(b)try{var c=b.programId;if(this._groups.exists(c)){var d=this._groups.get(c);try{d.remove(a),0===d.length&&this._groups.remove(c).release()}finally{d.release()}}}finally{b.release()}},b.prototype.draw=function(a,b){var c,d,e,f,g,h;for(c=this._groups,e=c.keys,f=e.length,g=0;f>g;g++)d=e[g],h=c.get(d),h.draw(a,b),h.release()},b.prototype.traverseDrawables=function(a,b){this._groups.forEach(function(c,d){d.acceptProgram(b),d.traverseDrawables(a)})},b.prototype.traversePrograms=function(a){this._groups.forEach(function(b,c){c.acceptProgram(a)})},b}(g),o=function(){var a=new n,b=new d,f=1,g=i().generate(),h={addRef:function(){return f++,e(g,j,1),f},release:function(){return f--,e(g,j,-1),0===f?(a.release(),a=void 0,b.release(),b=void 0,f=void 0,g=void 0,0):f},contextFree:function(c){a.traverseDrawables(function(a){a.contextFree(c)},function(a){a.contextFree(c)}),b.remove(c)},contextGain:function(c){b.exists(c.canvasId)||(b.put(c.canvasId,c),a.traverseDrawables(function(a){a.contextGain(c)},function(a){a.contextGain(c)}))},contextLost:function(c){b.exists(c)&&(a.traverseDrawables(function(a){a.contextLost(c)},function(a){a.contextLost(c)}),b.remove(c))},add:function(c){b.forEach(function(a,b){c.contextGain(b)}),a.add(c)},containsDrawable:function(b){return a.containsDrawable(b)},draw:function(b,c){a.draw(b,c)},getDrawablesByName:function(b){var d=new c([],"getDrawablesByName");return a.traverseDrawables(function(a){a.name===b&&d.push(a)},function(a){}),d},remove:function(b){a.remove(b)},traverse:function(b,c,d){a.traverseDrawables(b,d)}};return e(g,j,1),h};return o});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/scene/PerspectiveCamera",["require","exports","../cameras/createPerspective","../i18n/readOnly","../checks/mustBeNumber","../utils/Shareable","../math/Vector3"],function(a,b,c,d,e,g,h){var i="PerspectiveCamera",j=function(a){function b(b,d,f,g){void 0===b&&(b=75*Math.PI/180),void 0===d&&(d=1),void 0===f&&(f=.1),void 0===g&&(g=2e3),a.call(this,"PerspectiveCamera"),this.position=new h,e("fov",b),e("aspect",d),e("near",f),e("far",g),this.inner=c({fov:b,aspect:d,near:f,far:g})}return f(b,a),b.prototype.destructor=function(){},b.prototype.setUniforms=function(a,b){this.inner.setNear(this.near),this.inner.setFar(this.far),this.inner.setUniforms(a,b)},b.prototype.contextFree=function(){},b.prototype.contextGain=function(a){},b.prototype.contextLost=function(){},b.prototype.draw=function(a){console.warn(i+".draw("+a+")")},b.prototype.getProperty=function(a){return void 0},b.prototype.setProperty=function(a,b){},Object.defineProperty(b.prototype,"aspect",{get:function(){return this.inner.aspect},enumerable:!0,configurable:!0}),b.prototype.setAspect=function(a){return this.inner.aspect=a,this},Object.defineProperty(b.prototype,"eye",{get:function(){return this.inner.eye},enumerable:!0,configurable:!0}),b.prototype.setEye=function(a){return this.inner.setEye(a),this},Object.defineProperty(b.prototype,"fov",{get:function(){return this.inner.fov},set:function(a){throw new Error(d("fov").message)},enumerable:!0,configurable:!0}),b.prototype.setFov=function(a){return e("fov",a),this.inner.fov=a,this},Object.defineProperty(b.prototype,"look",{get:function(){return this.inner.look},enumerable:!0,configurable:!0}),b.prototype.setLook=function(a){return this.inner.setLook(a),this},Object.defineProperty(b.prototype,"near",{get:function(){return this.inner.near},set:function(a){throw new Error(d("near").message)},enumerable:!0,configurable:!0}),b.prototype.setNear=function(a){return this.inner.setNear(a),this},Object.defineProperty(b.prototype,"far",{get:function(){return this.inner.far},set:function(a){this.inner.far=a},enumerable:!0,configurable:!0}),b.prototype.setFar=function(a){return this.inner.setFar(a),this},Object.defineProperty(b.prototype,"up",{get:function(){return this.inner.up},set:function(a){throw new Error(d("up").message)},enumerable:!0,configurable:!0}),b.prototype.setUp=function(a){return this.inner.setUp(a),this},b}(g);return j});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/scene/Scene",["require","exports","../scene/createDrawList","../scene/MonitorList","../utils/Shareable"],function(a,b,c,d,e){function g(){return h+" constructor"}var h="Scene",i=function(a){function b(b){void 0===b&&(b=[]),a.call(this,h),d.verify("monitors",b,g),this.drawList=c(),this.monitors=new d(b),this.monitors.addContextListener(this),this.monitors.synchronize(this)}return f(b,a),b.prototype.destructor=function(){this.monitors.removeContextListener(this),this.monitors.release(),this.monitors=void 0,this.drawList.release(),this.drawList=void 0},b.prototype.add=function(a){return this.drawList.add(a)},b.prototype.containsDrawable=function(a){return this.drawList.containsDrawable(a)},b.prototype.draw=function(a,b){return this.drawList.draw(a,b)},b.prototype.getDrawablesByName=function(a){return this.drawList.getDrawablesByName(a)},b.prototype.remove=function(a){return this.drawList.remove(a)},b.prototype.traverse=function(a,b,c){this.drawList.traverse(a,b,c)},b.prototype.contextFree=function(a){this.drawList.contextFree(a)},b.prototype.contextGain=function(a){this.drawList.contextGain(a)},b.prototype.contextLost=function(a){this.drawList.contextLost(a)},b}(e);return i}),b("davinci-eight/renderers/renderer",["require","exports","../collections/IUnknownArray","../utils/refChange","../utils/uuid4"],function(a,b,c,d,e){var f="CanonicalIContextRenderer",g=function(){var a,b=e().generate(),g=1,h=new c([],f),i={addRef:function(){return g++,d(b,f,1),g},get canvas(){return a?a.canvas:void 0},get commands(){return h},get gl(){return a?a.gl:void 0},contextFree:function(b){h.forEach(function(a){a.contextFree(b)}),a=void 0},contextGain:function(b){a=b,h.forEach(function(a){a.contextGain(b)})},contextLost:function(b){h.forEach(function(a){a.contextLost(b)}),a=void 0},release:function(){return g--,d(b,f,-1),0===g?(h.release(),h=void 0,0):g}};return d(b,f,1),i};return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/core/BufferResource",["require","exports","../checks/isDefined","../checks/mustBeBoolean","../checks/mustBeObject","../utils/Shareable"],function(a,b,c,d,e,g){var h="BufferResource",i=function(a){function b(b,c){a.call(this,h),this.manager=e("manager",b),this._isElements=d("isElements",c),b.addContextListener(this),b.synchronize(this)}return f(b,a),b.prototype.destructor=function(){this.contextFree(this.manager.canvasId),this.manager.removeContextListener(this),this.manager=void 0,this._isElements=void 0},b.prototype.contextFree=function(a){if(this._buffer){var b=this.manager.gl;c(b)?b.deleteBuffer(this._buffer):console.error(h+" must leak WebGLBuffer because WebGLRenderingContext is "+typeof b),this._buffer=void 0}},b.prototype.contextGain=function(a){this.manager.canvasId===a.canvasId?this._buffer||(this._buffer=a.gl.createBuffer()):console.warn("BufferResource ignoring contextGain for canvasId "+a.canvasId)},b.prototype.contextLost=function(){this._buffer=void 0},b.prototype.bind=function(){var a=this.manager.gl;if(a){var b=this._isElements?a.ELEMENT_ARRAY_BUFFER:a.ARRAY_BUFFER;a.bindBuffer(b,this._buffer)}else console.warn(h+" bind() missing WebGL rendering context.")},b.prototype.unbind=function(){var a=this.manager.gl;if(a){var b=this._isElements?a.ELEMENT_ARRAY_BUFFER:a.ARRAY_BUFFER;a.bindBuffer(b,null)}else console.warn(h+" unbind() missing WebGL rendering context.")},b}(g);return i}),b("davinci-eight/renderers/initWebGL",["require","exports","../checks/isDefined"],function(a,b,c){function d(a,b){if(c(a)){var d;try{d=a.getContext("webgl",b)||a.getContext("experimental-webgl",b)}catch(e){}if(d)return d;throw new Error("Unable to initialize WebGL. Your browser may not support it.")}return void 0}return d}),b("davinci-eight/utils/randumbInteger",["require","exports"],function(a,b){function c(){var a=Math.random(),b=1e6*a,c=Math.round(b);return c}return c}),b("davinci-eight/resources/TextureResource",["require","exports","../checks/expectArg","../utils/refChange","../utils/uuid4"],function(a,b,c,d,e){var f="ITexture",g=(new Array,function(){function a(a,b){this._refCount=1,this._uuid=e().generate();var g=a[0];this._monitor=c("montor",g).toBeObject().value,this._target=b,d(this._uuid,f,1),g.addContextListener(this),g.synchronize(this)}return a.prototype.addRef=function(){return this._refCount++,d(this._uuid,f,1),this._refCount},a.prototype.release=function(){return this._refCount--,d(this._uuid,f,-1),0===this._refCount&&(this._monitor.removeContextListener(this),this.contextFree()),this._refCount},a.prototype.contextFree=function(){this._texture&&(this._gl.deleteTexture(this._texture),this._texture=void 0),this._gl=void 0},a.prototype.contextGain=function(a){var b=a.gl;this._gl!==b&&(this.contextFree(),this._gl=b,this._texture=b.createTexture())},a.prototype.contextLost=function(){this._texture=void 0,this._gl=void 0},a.prototype.bind=function(){this._gl?this._gl.bindTexture(this._target,this._texture):console.warn(f+" bind() missing WebGL rendering context.")},a.prototype.unbind=function(){this._gl?this._gl.bindTexture(this._target,null):console.warn(f+" unbind() missing WebGL rendering context.")},a}());return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/utils/contextProxy",["require","exports","../core/BufferResource","../core","../geometries/GeometryData","../checks/expectArg","../renderers/initWebGL","../checks/isDefined","../checks/isUndefined","../checks/mustBeInteger","../checks/mustBeNumber","../checks/mustBeString","../utils/randumbInteger","../utils/refChange","../utils/Shareable","../geometries/Simplex","../collections/StringIUnknownMap","../resources/TextureResource","../utils/uuid4"],function(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(a,b){if(a)return a;throw new Error(b+": gl: WebGLRenderingContext is not defined. Either gl has been lost or start() not called.")}function v(a,b){switch(a){case q.K_FOR_TRIANGLE:return l("TRIANGLES",WebGLRenderingContext.TRIANGLES);case q.K_FOR_LINE_SEGMENT:return l("LINES",WebGLRenderingContext.LINES);case q.K_FOR_POINT:return l("POINTS",WebGLRenderingContext.POINTS);case q.K_FOR_EMPTY:return void 0;default:throw new Error("Unexpected k-simplex dimension, k => "+a)}}function w(a){switch(l("usage",a),a){case WebGLRenderingContext.STATIC_DRAW:return!0;default:return!1}}function x(a){return m("uuid",a),a+" is not a recognized mesh uuid"}function y(a,b){if(b){var c=b[a];return c?c:a}return a}function z(a,b,c,d){var e=a.attributes(b);if(e){var f,g=Object.keys(e),h=g.length;for(f=0;h>f;f++){var i=g[f],j=y(i,d),k=c.attributes,l=k.get(j);if(l){var m=l.buffer;m.bind();var n=e[i];n.vertexPointer(l.size,l.normalized,l.stride,l.offset),m.unbind(),n.enable(),m.release(),l.release()}else console.warn("program attribute "+i+" is not satisfied by the mesh");k.release()}}else console.warn("bindProgramAttribLocations: program.attributes is falsey.")}function A(a,b){var c=a.attributes(b);c?Object.keys(c).forEach(function(a){c[a].disable()}):console.warn("unbindProgramAttribLocations: program.attributes is falsey.")}function B(a){function b(a){g("user",a).toBeObject();var b=z.indexOf(a);0>b?z.push(a):console.warn("user already exists for addContextListener")}function f(a){g("user",a).toBeObject();var b=z.indexOf(a);if(b>=0){z.splice(b,1)}}function l(a){m&&(m.isContextLost()?a.contextLost(q):a.contextGain(D))}var m,p,q,x=t().generate(),y=new r("webgl"),z=[],A=0,B=(g("token",""),function(a){i(p)&&(a.preventDefault(),m=void 0,z.forEach(function(a){a.contextLost(q)}))}),C=function(b){i(p)&&(b.preventDefault(),m=h(p,a),z.forEach(function(a){a.contextGain(D)}))},D={get canvasId(){return q},createBufferGeometry:function(a,b,c){if(g("elements",a).toSatisfy(a instanceof e,"elements must be an instance of GeometryElements"),b=v(a.k,b),!i(b))return void 0;if(i(c)?g("usage",c).toSatisfy(w(c),"usage must be on of STATIC_DRAW, ..."):c=i(m)?m.STATIC_DRAW:void 0,j(m))return void(d.verbose&&console.warn("Impossible to create a buffer geometry without a WebGL context. Sorry, no dice!"));var f=new I(q,m,y),h=D.createElementArrayBuffer();h.bind(),i(m)?m.bufferData(m.ELEMENT_ARRAY_BUFFER,new Uint16Array(a.indices.data),c):console.warn("Unable to bufferData to ELEMENT_ARRAY_BUFFER, WebGL context is undefined."),h.unbind();var k,l=new r("createBufferGeometry"),n=Object.keys(a.attributes),o=n.length;for(k=0;o>k;k++){var p=n[k],s=D.createArrayBuffer();s.bind();var t=a.attributes[p],u=t.values.data;m.bufferData(m.ARRAY_BUFFER,new Float32Array(u),c);var x=new H(s,t.size,!1,0,0);l.put(p,x),x.release(),s.unbind(),s.release()}a.k;var z=new F(b,a.indices.length,m.UNSIGNED_SHORT,0),A=new G(h,l,z);return y.put(f.uuid,A),A.release(),l.release(),h.release(),f},start:function(b,c){var e=i(p);return e?(k("_canvasId",q),void(d.verbose&&console.warn("Ignoring `start()` because already started."))):(p=b,q=c,void(i(p)&&(m=h(p,a),z.forEach(function(a){D.synchronize(a)}),p.addEventListener("webglcontextlost",B,!1),p.addEventListener("webglcontextrestored",C,!1))))},stop:function(){i(p)&&(p.removeEventListener("webglcontextrestored",C,!1),p.removeEventListener("webglcontextlost",B,!1),m&&(m.isContextLost()?z.forEach(function(a){a.contextLost(q)}):z.forEach(function(a){a.contextFree(q)}),m=void 0),p=void 0,q=void 0)},addContextListener:function(a){b(a)},removeContextListener:function(a){f(a)},synchronize:function(a){l(a)},get canvas(){return p||D.start(document.createElement("canvas"),n()),p},get gl(){return m?m:void console.warn("property gl: WebGLRenderingContext is not defined. Either gl has been lost or start() not called.")},addRef:function(){return A++,o(x,E,1),A},release:function(){if(A--,o(x,E,-1),0===A)for(y.release();z.length>0;){z.pop()}return A},createArrayBuffer:function(){return new c(D,!1)},createElementArrayBuffer:function(){return new c(D,!0)},createTexture2D:function(){return new s([D],u(m,"createTexture2D()").TEXTURE_2D)},createTextureCubeMap:function(){return new s([D],u(m,"createTextureCubeMap()").TEXTURE_CUBE_MAP)}};return D.addRef(),D}var C="ElementsBlock",D="ElementsBlockAttrib",E="ContextKahuna",F=function(){function a(a,b,c,d){this.mode=a,this.count=b,this.type=c,this.offset=d}return a.prototype.execute=function(a){i(a)?a.drawElements(this.mode,this.count,this.type,this.offset):console.warn("HFW: Er, like hey dude! You're asking me to draw something without a context. That's not cool, but I won't complain.")},a}(),G=function(a){function b(b,c,d){a.call(this,C),this._indexBuffer=b,this._indexBuffer.addRef(),this._attributes=c,this._attributes.addRef(),this.drawCommand=d}return f(b,a),b.prototype.destructor=function(){this._attributes.release(),this._attributes=void 0,this._indexBuffer.release(),this._indexBuffer=void 0,a.prototype.destructor.call(this)},Object.defineProperty(b.prototype,"indexBuffer",{get:function(){return this._indexBuffer.addRef(),this._indexBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"attributes",{get:function(){return this._attributes.addRef(),this._attributes},enumerable:!0,configurable:!0}),b}(p),H=function(a){function b(b,c,d,e,f){a.call(this,D),this._buffer=b,this._buffer.addRef(),this.size=c,this.normalized=d,this.stride=e,this.offset=f}return f(b,a),b.prototype.destructor=function(){this._buffer.release(),this._buffer=void 0,this.size=void 0,this.normalized=void 0,this.stride=void 0,this.offset=void 0},Object.defineProperty(b.prototype,"buffer",{get:function(){return this._buffer.addRef(),this._buffer},enumerable:!0,configurable:!0}),b}(p),I=function(a){function b(b,c,d){a.call(this,"BufferGeometry"),this.canvasId=b,this._blocks=d,this._blocks.addRef(),this.gl=c}return f(b,a),b.prototype.destructor=function(){this._blocks.release(),a.prototype.destructor.call(this)},b.prototype.bind=function(a,b){if(this._program!==a){this._program&&this.unbind();var c=this._blocks.get(this.uuid);if(!c)throw new Error(x(this.uuid));if(a){this._program=a,this._program.addRef();var d=c.indexBuffer;d.bind(),d.release(),z(this._program,this.canvasId,c,b)}else g("program",a).toBeObject();c.release()}},b.prototype.draw=function(){var a=this._blocks.get(this.uuid);if(!a)throw new Error(x(this.uuid));a.drawCommand.execute(this.gl),a.release()},b.prototype.unbind=function(){if(this._program){var a=this._blocks.get(this.uuid);if(!a)throw new Error(x(this.uuid));var b=a.indexBuffer;b.unbind(),b.release(),A(this._program,this.canvasId),a.release(),this._program.release(),this._program=void 0}},b}(p);return B});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/scene/Canvas3D",["require","exports","../renderers/renderer","../utils/contextProxy","../core","../checks/mustBeDefined","../checks/mustBeInteger","../i18n/readOnly","../utils/Shareable"],function(a,b,c,d,e,g,h,i,j){var k=function(a){function b(b){a.call(this,"Canvas3D"),this._kahuna=d(b),this._renderer=c(),this._kahuna.addContextListener(this._renderer),this._kahuna.synchronize(this._renderer)}return f(b,a),b.prototype.destructor=function(){this._kahuna.removeContextListener(this._renderer),this._kahuna.release(),this._kahuna=void 0,this._renderer.release(),this._renderer=void 0,a.prototype.destructor.call(this)},b.prototype.addContextListener=function(a){this._kahuna.addContextListener(a)},Object.defineProperty(b.prototype,"canvas",{get:function(){return this._kahuna.canvas},set:function(a){this._kahuna.canvas=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"canvasId",{get:function(){return this._kahuna.canvasId},set:function(a){throw new Error(i("canvasId").message)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"commands",{get:function(){return this._renderer.commands},enumerable:!0,configurable:!0}),b.prototype.contextFree=function(a){this._renderer.contextFree(a)},b.prototype.contextGain=function(a){this._renderer.contextGain(a)},b.prototype.contextLost=function(a){this._renderer.contextLost(a)},b.prototype.createArrayBuffer=function(){return this._kahuna.createArrayBuffer()},b.prototype.createBufferGeometry=function(a,b,c){return this._kahuna.createBufferGeometry(a,b,c)},b.prototype.createElementArrayBuffer=function(){return this._kahuna.createElementArrayBuffer()},b.prototype.createTextureCubeMap=function(){return this._kahuna.createTextureCubeMap()},b.prototype.createTexture2D=function(){return this._kahuna.createTexture2D()},Object.defineProperty(b.prototype,"gl",{get:function(){return this._kahuna.gl},enumerable:!0,configurable:!0}),b.prototype.removeContextListener=function(a){this._kahuna.removeContextListener(a)},b.prototype.setSize=function(a,b){h("width",a),h("height",b);var c=this.canvas;c.width=a,c.height=b,this.gl.viewport(0,0,a,b)},b.prototype.start=function(a,b){return a instanceof HTMLElement?(g("canvas",a),h("canvasId",b),void this._kahuna.start(a,b)):void(e.verbose&&console.warn("canvas must be an HTMLCanvasElement to start the context."))},b.prototype.stop=function(){this._kahuna.stop()},b.prototype.synchronize=function(a){this._kahuna.synchronize(a)},b}(j);return k});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/AxialGeometry",["require","exports","../geometries/Geometry","../math/Vector3"],function(a,b,c,d){var e=function(a){function b(b,c){a.call(this,b),this.axis=d.copy(c).normalize()}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b}(c);return e}),b("davinci-eight/geometries/arc3",["require","exports","../checks/mustBeDefined","../checks/mustBeInteger","../checks/mustBeNumber","../math/Spinor3","../math/Vector3"],function(a,b,c,d,e,f,g){function h(a,b,h,i){c("begin",a),e("angle",b),c("generator",h),d("segments",i);var j=[],k=g.copy(a),l=f.copy(h).scale(-b/2/i).exp();j.push(k.clone());for(var m=0;i>m;m++)k.rotate(l),j.push(k.clone());return j}return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/SliceGeometry",["require","exports","../geometries/AxialGeometry","../checks/isDefined","../checks/mustBeNumber","../math/Vector3"],function(a,b,c,d,e,g){function h(a){return g.random().cross(a).normalize()}var i=function(a){function b(b,c,f,i){void 0===c&&(c=g.e3),void 0===i&&(i=2*Math.PI),a.call(this,b,c),this.sliceAngle=2*Math.PI,d(f)?this.sliceStart=g.copy(f).normalize():this.sliceStart=h(this.axis),this.sliceAngle=e("sliceAngle",i)}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b}(c);return i});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/RingGeometry",["require","exports","../geometries/arc3","../geometries/Simplex","../geometries/SliceGeometry","../math/Spinor3","../core/Symbolic","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g,h,i,j){function k(a,b,d,e,f,g,h,k,l,m){for(var n=j.copy(d).cross(e),o=b,p=(a-b)/h,q=0;h+1>q;q++){for(var r=j.copy(e).scale(o),s=c(r,f,g,k),t=0,u=s.length;u>t;t++){var v=s[t];l.push(v),m.push(new i([(v.dot(e)/a+1)/2,(v.dot(n)/a+1)/2]))}o+=p}}function l(a,b,c){return a*(c+1)+b}function m(a,b,c,d,e,f){for(var g=0;d>g;g++)for(var h=g*(e+1),i=0;e>i;i++){var j=h+i,k=j,l=j+e+1,m=j+e+2;f.triangle([a[k],a[l],a[m]],[c,c,c],[b[k].clone(),b[l].clone(),b[m].clone()]),k=j,l=j+e+2,m=j+1,f.triangle([a[k],a[l],a[m]],[c,c,c],[b[k].clone(),b[l].clone(),b[m].clone()])}}function n(a,b,c,e){for(var f=0;b>f;f++){for(var g=0;c>g;g++){var i=new d(d.K_FOR_LINE_SEGMENT);i.vertices[0].attributes[h.ATTRIBUTE_POSITION]=a[l(f,g,c)],i.vertices[1].attributes[h.ATTRIBUTE_POSITION]=a[l(f,g+1,c)],e.push(i);var i=new d(d.K_FOR_LINE_SEGMENT);i.vertices[0].attributes[h.ATTRIBUTE_POSITION]=a[l(f,g,c)],i.vertices[1].attributes[h.ATTRIBUTE_POSITION]=a[l(f+1,g,c)],e.push(i)}var i=new d(d.K_FOR_LINE_SEGMENT);i.vertices[0].attributes[h.ATTRIBUTE_POSITION]=a[l(f,c,c)],i.vertices[1].attributes[h.ATTRIBUTE_POSITION]=a[l(f+1,c,c)],
e.push(i)}for(var g=0;c>g;g++){var i=new d(d.K_FOR_LINE_SEGMENT);i.vertices[0].attributes[h.ATTRIBUTE_POSITION]=a[l(b,g,c)],i.vertices[1].attributes[h.ATTRIBUTE_POSITION]=a[l(b,g+1,c)],e.push(i)}}function o(a,b,c,e){for(var f=0;b>=f;f++)for(var g=0;c>=g;g++){var i=new d(d.K_FOR_POINT);i.vertices[0].attributes[h.ATTRIBUTE_POSITION]=a[l(f,g,c)],e.push(i)}}function p(a,b,c,e){for(var f=0;b>=f;f++)for(var g=0;c>=g;g++){var h=new d(d.K_FOR_EMPTY);e.push(h)}}var q=function(a){function b(b,c,d,e,f){void 0===b&&(b=1),void 0===c&&(c=0),a.call(this,"RingGeometry",d,e,f),this.a=b,this.b=c}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.isModified=function(){return a.prototype.isModified.call(this)},b.prototype.regenerate=function(){this.data=[];var a=this.flatSegments,b=this.curvedSegments,c=(new g).dual(this.axis),e=[],f=[];switch(k(this.a,this.b,this.axis,this.sliceStart,this.sliceAngle,c,a,b,e,f),this.k){case d.K_FOR_EMPTY:p(e,a,b,this.data);break;case d.K_FOR_POINT:o(e,a,b,this.data);break;case d.K_FOR_LINE_SEGMENT:n(e,a,b,this.data);break;case d.K_FOR_TRIANGLE:m(e,f,this.axis,a,b,this);break;default:console.warn(this.k+"-simplex is not supported for geometry generation.")}this.setModified(!1)},b.prototype.setModified=function(b){return a.prototype.setModified.call(this,b),this},b}(e);return q});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/RevolutionGeometry",["require","exports","../geometries/Geometry","../math/Spinor3","../math/Vector2"],function(a,b,c,d,e){var g=function(a){function b(b){void 0===b&&(b="RevolutionGeometry"),a.call(this,b)}return f(b,a),b.prototype.revolve=function(a,b,c,f,g,h){void 0===c&&(c=12),void 0===f&&(f=0),void 0===g&&(g=2*Math.PI);var i,j,k,l,m=[],n=Math.abs(2*Math.PI-Math.abs(g-f))<1e-4,o=n?c:c+1,p=1/c,q=(g-f)*p,r=new d;for(i=0,k=o;k>i;i++){var s=f+i*q,t=s/2;for(r.copy(b).scale(t).exp(),j=0,l=a.length;l>j;j++){var u=a[j].clone();u.rotate(r),h&&u.rotate(h),m.push(u)}}var v=1/(a.length-1),w=a.length,x=w*o;for(i=0,k=c;k>i;i++)for(j=0,l=a.length-1;l>j;j++){var y=j+w*i,z=y%x,A=(y+w)%x,B=(y+1+w)%x,C=(y+1)%x,D=i*p,E=j*v,F=D+p,G=E+v;this.triangle([m[C],m[A],m[z]],[],[new e([D,E]),new e([F,E]),new e([D,G])]),this.triangle([m[C],m[B],m[A]],[],[new e([F,E]),new e([F,G]),new e([D,G])])}},b}(c);return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/ArrowGeometry",["require","exports","../geometries/RevolutionGeometry","../math/Spinor3","../math/Vector3"],function(a,b,c,d,e){function g(a){return a>=0?1:-1}function h(a,b){return a>=b}function i(a){var b=j(a);switch(b){case 0:return new e([k(b,a),0,0]);case 1:return new e([0,k(b,a),0]);case 2:return new e([0,0,k(b,a)])}return e.copy(a)}var j=function(a){var b=Math.abs(a.x),c=Math.abs(a.y),d=Math.abs(a.z);return h(b,d)?h(b,c)?0:1:h(c,d)?1:2},k=function(a,b){return g(b.getComponent(a))},l=function(a){function b(){a.call(this,"ArrowGeometry"),this.lengthCone=.2,this.radiusCone=.08,this.radiusShaft=.01,this.vector=e.e1.clone(),this.segments=12,this.setModified(!0)}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.isModified=function(){return this.vector.modified},b.prototype.setModified=function(a){return this.vector.modified=a,this},b.prototype.regenerate=function(){var b=this.vector.magnitude(),c=b-this.lengthCone,f=b/2,g=this.radiusCone,h=this.radiusShaft,l=function(a){var b=j(a),l=k(b,a),m=(b+0)%3,n=(b+2)%3,o=(b+1)%3,p=f*l,q=c*l,r=[[p,0,0],[q-p,g,0],[q-p,h,0],[-p,h,0],[-p,0,0]],s=r.map(function(a){return new e([a[m],a[n],a[o]])}),t=i(a),u=new d([t.x,t.y,t.z,0]);return{points:s,generator:u}},m=e.copy(this.vector).normalize(),n=l(m),o=(new d).rotor(m,i(m));this.data=[],a.prototype.revolve.call(this,n.points,n.generator,this.segments,0,2*Math.PI,o),this.setModified(!1)},b}(c);return l});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/BarnGeometry",["require","exports","../geometries/computeFaceNormals","../geometries/Geometry","../geometries/quadrilateral","../geometries/Simplex","../core/Symbolic","../geometries/triangle","../math/Vector3"],function(a,b,c,d,e,g,h,i,j){var k=function(a){function b(){a.call(this,"BarnGeometry"),this.a=j.e1.clone(),this.b=j.e2.clone(),this.c=j.e3.clone(),this.regenerate()}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.isModified=function(){return this.a.modified||this.b.modified||this.c.modified||a.prototype.isModified.call(this)},b.prototype.setModified=function(b){return this.a.modified=b,this.b.modified=b,this.c.modified=b,a.prototype.setModified.call(this,b),this},b.prototype.regenerate=function(){function a(a){for(var c=new g(a.length-1),d=0;d<a.length;d++)c.vertices[d].attributes[h.ATTRIBUTE_POSITION]=b[a[d]];return c}this.setModified(!1);var b=[0,1,2,3,4,5,6,7,8,9].map(function(a){return void 0});switch(b[0]=(new j).sub(this.a).sub(this.b).sub(this.c).divideScalar(2),b[1]=(new j).add(this.a).sub(this.b).sub(this.c).divideScalar(2),b[6]=(new j).add(this.a).sub(this.b).add(this.c).divideScalar(2),b[5]=(new j).sub(this.a).sub(this.b).add(this.c).divideScalar(2),b[4]=(new j).copy(b[0]).add(this.b),b[2]=(new j).copy(b[1]).add(this.b),b[7]=(new j).copy(b[6]).add(this.b),b[9]=(new j).copy(b[5]).add(this.b),b[3]=j.lerp(b[4],b[2],.5).scale(2).add(this.b).divideScalar(2),b[8]=j.lerp(b[7],b[9],.5).scale(2).add(this.b).divideScalar(2),this.k){case 0:var d=b.map(function(a){var b=new g(0);return b.vertices[0].attributes[h.ATTRIBUTE_POSITION]=a,b});this.data=d;break;case 1:var f=[[0,1],[1,6],[6,5],[5,0],[1,2],[6,7],[5,9],[0,4],[4,3],[3,2],[9,8],[8,7],[9,4],[8,3],[7,2]];this.data=f.map(function(b){return a(b)});break;case 2:var k=[0,1,2,3,4,5,6,7,8].map(function(a){return void 0});k[0]=e(b[0],b[5],b[9],b[4]),k[1]=e(b[3],b[4],b[9],b[8]),k[2]=e(b[2],b[3],b[8],b[7]),k[3]=e(b[1],b[2],b[7],b[6]),k[4]=e(b[0],b[1],b[6],b[5]),k[5]=e(b[5],b[6],b[7],b[9]),k[6]=e(b[0],b[4],b[2],b[1]),k[7]=i(b[9],b[7],b[8]),k[8]=i(b[2],b[4],b[3]),this.data=k.reduce(function(a,b){return a.concat(b)},[]),this.data.forEach(function(a){c(a)})}this.check()},b}(d);return k});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/ConeGeometry",["require","exports","../geometries/SliceGeometry","../math/Vector2","../math/Vector3"],function(a,b,c,d,e){var g=function(a){function b(b,c,d,e,f,g,h){void 0===b&&(b=.5),void 0===c&&(c=1),void 0===e&&(e=0),void 0===f&&(f=!1),void 0===g&&(g=!1),void 0===h&&(h=0),a.call(this,"ConeGeometry",d,void 0,void 0),this.radiusTop=e,this.radius=b,this.height=c,this.openTop=f,this.openBottom=g,this.thetaStart=h}return f(b,a),b.prototype.regenerate=function(){var a,b,c=this.radius,f=this.radiusTop,g=this.height,h=this.flatSegments,i=this.curvedSegments,j=this.openTop,k=this.openBottom,l=this.thetaStart,m=this.sliceAngle,n=g/2,o=[],p=[],q=[];for(b=0;h>=b;b++){var r=[],s=[],t=b/h,u=t*(c-f)+f;for(a=0;i>=a;a++){var v=a/i,w=new e;w.x=u*Math.sin(v*m+l),w.y=-t*g+n,w.z=u*Math.cos(v*m+l),o.push(w),r.push(o.length-1),s.push(new d([v,1-t]))}p.push(r),q.push(s)}var x,y,z=(c-f)/g;for(a=0;i>a;a++)for(0!==f?(x=e.copy(o[p[0][a]]),y=e.copy(o[p[0][a+1]])):(x=e.copy(o[p[1][a]]),y=e.copy(o[p[1][a+1]])),x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*z).normalize(),y.setY(Math.sqrt(y.x*y.x+y.z*y.z)*z).normalize(),b=0;h>b;b++){var A=p[b][a],B=p[b+1][a],C=p[b+1][a+1],D=p[b][a+1],E=x.clone(),F=x.clone(),G=y.clone(),H=y.clone(),I=q[b][a].clone(),J=q[b+1][a].clone(),K=q[b+1][a+1].clone(),L=q[b][a+1].clone();this.triangle([o[A],o[B],o[D]],[E,F,H],[I,J,L]),this.triangle([o[B],o[C],o[D]],[F.clone(),G,H.clone()],[J.clone(),K,L.clone()])}if(!j&&f>0)for(o.push(e.e2.clone().scale(n)),a=0;i>a;a++){var A=p[0][a],B=p[0][a+1],C=o.length-1,E=e.e2.clone(),F=e.e2.clone(),G=e.e2.clone(),I=q[0][a].clone(),J=q[0][a+1].clone(),K=new d([J.x,0]);this.triangle([o[A],o[B],o[C]],[E,F,G],[I,J,K])}if(!k&&c>0)for(o.push(e.e2.clone().scale(-n)),a=0;i>a;a++){var A=p[h][a+1],B=p[h][a],C=o.length-1,E=e.e2.clone().scale(-1),F=e.e2.clone().scale(-1),G=e.e2.clone().scale(-1),I=q[h][a+1].clone(),J=q[h][a].clone(),K=new d([J.x,1]);this.triangle([o[A],o[B],o[C]],[E,F,G],[I,J,K])}},b}(c);return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/CylinderGeometry",["require","exports","../geometries/arc3","../geometries/SliceGeometry","../math/Spinor3","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g,h){function i(a,b,d,e,f,i,j,k,l,m,n){for(var o=h.copy(e).scale(a),p=h.copy(d).scale(.5*b),q=h.copy(d).normalize().scale(b/j),r=0;j>=r;r++){for(var s=h.copy(q).scale(r).sub(p),t=[],u=[],v=(j-r)/j,w=c(o,f,i,k),x=0,y=w.length;y>x;x++){var z=w[x].add(s),A=x/k;l.push(z),t.push(l.length-1),u.push(new g([A,v]))}m.push(t),n.push(u)}}var j=function(a){function b(b,c,d,e,f){void 0===b&&(b=1),void 0===c&&(c=1),void 0===d&&(d=h.e2),void 0===e&&(e=!1),void 0===f&&(f=!1),a.call(this,"CylinderGeometry",d,void 0,void 0),this.radius=b,this.height=c,this.openTop=e,this.openBottom=f,this.setModified(!0)}return f(b,a),b.prototype.regenerate=function(){this.data=[];var a=this.radius,b=this.flatSegments,c=this.curvedSegments,d=(new e).dual(this.axis),f=this.height/2,j=[],k=[],l=[];i(a,this.height,this.axis,this.sliceStart,this.sliceAngle,d,b,c,j,k,l);for(var m,n,o=0;c>o;o++){0!==a?(m=h.copy(j[k[0][o]]),n=h.copy(j[k[0][o+1]])):(m=h.copy(j[k[1][o]]),n=h.copy(j[k[1][o+1]])),m.setY(0).normalize(),n.setY(0).normalize();for(var p=0;b>p;p++){var q=k[p][o],r=k[p+1][o],s=k[p+1][o+1],t=k[p][o+1],u=m.clone(),v=m.clone(),w=n.clone(),x=n.clone(),y=l[p][o].clone(),z=l[p+1][o].clone(),A=l[p+1][o+1].clone(),B=l[p][o+1].clone();this.triangle([j[r],j[q],j[s]],[v,u,w],[z,y,A]),this.triangle([j[t],j[s],j[q]],[x,w.clone(),u.clone()],[B,A.clone(),y.clone()])}}if(!this.openTop&&a>0){j.push(this.axis.clone().scale(f));for(var o=0;c>o;o++){var q=k[b][o+1],r=j.length-1,s=k[b][o],u=this.axis.clone(),v=this.axis.clone(),w=this.axis.clone(),y=l[b][o+1].clone(),z=new g([y.x,1]),A=l[b][o].clone();this.triangle([j[q],j[r],j[s]],[u,v,w],[y,z,A])}}if(!this.openBottom&&a>0){j.push(this.axis.clone().scale(-f));for(var o=0;c>o;o++){var q=k[0][o],r=j.length-1,s=k[0][o+1],u=this.axis.clone().scale(-1),v=this.axis.clone().scale(-1),w=this.axis.clone().scale(-1),y=l[0][o].clone(),z=new g([y.x,1]),A=l[0][o+1].clone();this.triangle([j[q],j[r],j[s]],[u,v,w],[y,z,A])}}this.setModified(!1)},b}(d);return j});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/PolyhedronGeometry",["require","exports","../geometries/Geometry","../geometries/Simplex","../core/Symbolic","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g,h){function i(a){return Math.atan2(a.z,-a.x)}function j(a){return Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))}function k(a,b){var c=h.copy(a).normalize();b.push(c);var d=i(a)/2/Math.PI+.5,e=j(a)/Math.PI+.5,f=c;return f.uv=new g([d,1-e]),c}function l(a,b,c){return 0>c&&1===a.x&&(a=new g([a.x-1,a.y])),0===b.x&&0===b.z&&(a=new g([c/2/Math.PI+.5,a.y])),a.clone()}var m=function(a){function b(b,c,f,g){function j(a,b,c){var d=(a.x+b.x+c.x)/3,e=(a.y+b.y+c.y)/3,f=(a.z+b.z+c.z)/3;return{x:d,y:e,z:f}}function m(a,b,c){var f=i(j(a,b,c)),g=a,k=b,m=c,n=l(g.uv,a,f),p=l(k.uv,b,f),q=l(m.uv,c,f),r=new d(d.K_FOR_TRIANGLE);r.vertices[0].attributes[e.ATTRIBUTE_POSITION]=h.copy(a),r.vertices[0].attributes[e.ATTRIBUTE_NORMAL]=h.copy(a),r.vertices[0].attributes[e.ATTRIBUTE_TEXTURE_COORDS]=n,r.vertices[1].attributes[e.ATTRIBUTE_POSITION]=h.copy(b),r.vertices[1].attributes[e.ATTRIBUTE_NORMAL]=h.copy(b),r.vertices[1].attributes[e.ATTRIBUTE_TEXTURE_COORDS]=p,r.vertices[2].attributes[e.ATTRIBUTE_POSITION]=h.copy(c),r.vertices[2].attributes[e.ATTRIBUTE_NORMAL]=h.copy(c),r.vertices[2].attributes[e.ATTRIBUTE_TEXTURE_COORDS]=q,o.data.push(r)}function n(a,b,c){for(var d=Math.pow(2,b),f=k(a.vertices[0].attributes[e.ATTRIBUTE_POSITION],c),g=k(a.vertices[1].attributes[e.ATTRIBUTE_POSITION],c),i=k(a.vertices[2].attributes[e.ATTRIBUTE_POSITION],c),j=[],l=0;d>=l;l++){j[l]=[];for(var n=k(h.copy(f).lerp(i,l/d),c),o=k(h.copy(g).lerp(i,l/d),c),p=d-l,q=0;p>=q;q++)0==q&&l==d?j[l][q]=n:j[l][q]=k(h.copy(n).lerp(o,q/p),c)}for(var l=0;d>l;l++)for(var q=0;2*(d-l)-1>q;q++){var r=Math.floor(q/2);q%2==0?m(j[l][r+1],j[l+1][r],j[l][r]):m(j[l][r+1],j[l+1][r+1],j[l+1][r])}}void 0===f&&(f=1),void 0===g&&(g=0),a.call(this);for(var o=this,p=[],q=0,r=b.length;r>q;q+=3)k(new h([b[q],b[q+1],b[q+2]]),p);for(var s=[],q=0,t=0,r=c.length;r>q;q+=3,t++){var u=p[c[q]],v=p[c[q+1]],w=p[c[q+2]],x=new d(d.K_FOR_TRIANGLE);x.vertices[0].attributes[e.ATTRIBUTE_POSITION]=u,x.vertices[0].attributes[e.ATTRIBUTE_NORMAL]=h.copy(u),x.vertices[1].attributes[e.ATTRIBUTE_POSITION]=v,x.vertices[1].attributes[e.ATTRIBUTE_NORMAL]=h.copy(v),x.vertices[2].attributes[e.ATTRIBUTE_POSITION]=w,x.vertices[2].attributes[e.ATTRIBUTE_NORMAL]=h.copy(w),s[t]=x}for(var q=0,y=s.length;y>q;q++)n(s[q],g,p);for(var q=0,z=p.length;z>q;q++)p[q].x*=f,p[q].y*=f,p[q].z*=f;this.mergeVertices()}return f(b,a),b}(c);return m});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/DodecahedronGeometry",["require","exports","../geometries/PolyhedronGeometry"],function(a,b,c){var d=(1+Math.sqrt(5))/2,e=1/d,g=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-e,-d,0,-e,d,0,e,-d,0,e,d,-e,-d,0,-e,d,0,e,-d,0,e,d,0,-d,0,-e,d,0,-e,-d,0,e,d,0,e],h=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],i=function(a){function b(b,c){a.call(this,g,h,b,c)}return f(b,a),b}(c);return i});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/IcosahedronGeometry",["require","exports","../geometries/PolyhedronGeometry"],function(a,b,c){var d=(1+Math.sqrt(5))/2,e=[-1,d,0,1,d,0,-1,-d,0,1,-d,0,0,-1,d,0,1,d,0,-1,-d,0,1,-d,d,0,-1,d,0,1,-d,0,-1,-d,0,1],g=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],h=function(a){function b(b,c){a.call(this,e,g,b,c)}return f(b,a),b}(c);return h}),b("davinci-eight/checks/isFunction",["require","exports"],function(a,b){function c(a){return"function"==typeof a}return c}),b("davinci-eight/checks/mustBeFunction",["require","exports","../checks/mustSatisfy","../checks/isFunction"],function(a,b,c,d){function e(){return"be a function"}function f(a,b,f){return c(a,d(b),e,f),b}return f});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/SurfaceGeometry",["require","exports","../geometries/Simplex","../geometries/Geometry","../core/Symbolic","../math/Vector2","../math/Vector3","../checks/mustBeFunction","../checks/mustBeInteger"],function(a,b,c,d,e,g,h,i,j){var k=function(a){function b(b,d,f){a.call(this),i("parametricFunction",b),j("uSegments",d),j("vSegments",f);var k,l,m=[],n=d+1;for(k=0;f>=k;k++){var o=k/f;for(l=0;d>=l;l++){var p=l/d,q=b(p,o);m.push(h.copy(q))}}var r,s,t,u,v,w,x,y;for(k=0;f>k;k++)for(l=0;d>l;l++){r=k*n+l,s=k*n+l+1,t=(k+1)*n+l+1,u=(k+1)*n+l,v=new g([l/d,k/f]),w=new g([(l+1)/d,k/f]),x=new g([(l+1)/d,(k+1)/f]),y=new g([l/d,(k+1)/f]);var z=new c(c.K_FOR_TRIANGLE);z.vertices[0].attributes[e.ATTRIBUTE_POSITION]=m[r],z.vertices[0].attributes[e.ATTRIBUTE_TEXTURE_COORDS]=v,z.vertices[1].attributes[e.ATTRIBUTE_POSITION]=m[s],z.vertices[1].attributes[e.ATTRIBUTE_TEXTURE_COORDS]=w,z.vertices[2].attributes[e.ATTRIBUTE_POSITION]=m[u],z.vertices[2].attributes[e.ATTRIBUTE_TEXTURE_COORDS]=y,this.data.push(z);var z=new c(c.K_FOR_TRIANGLE);z.vertices[0].attributes[e.ATTRIBUTE_POSITION]=m[s],z.vertices[0].attributes[e.ATTRIBUTE_TEXTURE_COORDS]=w,z.vertices[1].attributes[e.ATTRIBUTE_POSITION]=m[t],z.vertices[1].attributes[e.ATTRIBUTE_TEXTURE_COORDS]=x,z.vertices[2].attributes[e.ATTRIBUTE_POSITION]=m[u],z.vertices[2].attributes[e.ATTRIBUTE_TEXTURE_COORDS]=y,this.data.push(z)}}return f(b,a),b}(d);return k});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/KleinBottleGeometry",["require","exports","../geometries/SurfaceGeometry","../math/Vector3"],function(a,b,c,d){function e(a,b){var c=new d;return a=2*a*i,b=2*b*i,i>a?(c.x=3*g(a)*(1+h(a))+2*(1-g(a)/2)*g(a)*g(b),c.z=-8*h(a)-2*(1-g(a)/2)*h(a)*g(b)):(c.x=3*g(a)*(1+h(a))+2*(1-g(a)/2)*g(b+i),c.z=-8*h(a)),c.y=-2*(1-g(a)/2)*h(b),c.scale(.1)}var g=Math.cos,h=Math.sin,i=Math.PI,j=function(a){function b(b,c){a.call(this,e,b,c)}return f(b,a),b}(c);return j});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/Simplex1Geometry",["require","exports","../geometries/Geometry","../geometries/Simplex","../core/Symbolic","../math/Vector3"],function(a,b,c,d,e,g){var h=function(a){function b(){a.call(this),this.head=new g([1,0,0]),this.tail=new g([0,1,0]),this.calculate()}return f(b,a),b.prototype.calculate=function(){function a(a){for(var c=new d(a.length-1),f=0;f<a.length;f++)c.vertices[f].attributes[e.ATTRIBUTE_POSITION]=b[a[f]];return c}var b=[0,1].map(function(a){return void 0});b[0]=this.tail,b[1]=this.head,this.data=[[0,1]].map(function(b){return a(b)}),this.check()},b}(c);return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/MobiusStripGeometry",["require","exports","../geometries/SurfaceGeometry","../math/Vector3"],function(a,b,c,d){function e(a,b){var c=new d([0,0,0]),e=1,f=.05,j=(2*a-1)*f,k=2*i*b;return c.x=(e+j*g(k/2))*g(k),c.y=(e+j*g(k/2))*h(k),c.z=j*h(k/2),c}var g=Math.cos,h=Math.sin,i=Math.PI,j=function(a){function b(b,c){a.call(this,e,b,c)}return f(b,a),b}(c);return j});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/OctahedronGeometry",["require","exports","../geometries/PolyhedronGeometry"],function(a,b,c){var d=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],e=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],g=function(a){function b(b,c){a.call(this,d,e,b,c)}return f(b,a),b}(c);return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/SphericalPolarGeometry",["require","exports","../geometries/arc3","../checks/mustBeNumber","../math/MutableNumber","../geometries/Simplex","../geometries/SliceGeometry","../math/Spinor3","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g,h,i,j,k){function l(a,b,d,e,f,g,h,l,m,n){for(var o=(new i).dual(b),p=h+1,q=l+1,r=0;p>r;r++)for(var s=r/h,t=f+s*g,u=a*Math.sin(t),v=k.copy(d).scale(u),w=c(v,e,o,l),x=k.copy(b).scale(Math.cos(t)),y=0;q>y;y++){var z=y/l,A=w[y].add(x);m.push(A),n.push(new j([z,1-s]))}}function m(a,b,c){return a*(c+1)+b}function n(a,b,c){switch(b){case 0:return a+1;case 1:return a;case 2:return a+c+1;case 3:return a+c+2}}function o(a,b,c,d,e,f){for(var g=0;d>g;g++)for(var h=0;e>h;h++){var i=m(g,h,e),j=n(i,0,e),l=n(i,1,e),o=n(i,2,e),p=n(i,3,e),q=k.copy(a[j]).normalize(),r=k.copy(a[l]).normalize(),s=k.copy(a[o]).normalize(),t=k.copy(a[p]).normalize(),u=b[j].clone(),v=b[l].clone(),w=b[o].clone(),x=b[p].clone();f.triangle([a[j],a[l],a[p]],[q,r,t],[u,v,x]),f.triangle([a[o],a[p],a[l]],[s,t,r],[w,x,v])}}function p(a,b,c,d,e,f){for(var g=0;d>g;g++)for(var h=0;e>h;h++){var i=m(g,h,e),j=n(i,0,e),l=n(i,1,e),o=n(i,2,e),p=n(i,3,e),q=k.copy(a[j]).normalize(),r=k.copy(a[l]).normalize(),s=k.copy(a[o]).normalize(),t=k.copy(a[p]).normalize(),u=b[j].clone(),v=b[l].clone(),w=b[o].clone(),x=b[p].clone();f.lineSegment([a[j],a[l]],[q,r],[u,v]),f.lineSegment([a[l],a[o]],[r,s],[v,w]),f.lineSegment([a[o],a[p]],[s,t],[w,x]),f.lineSegment([a[p],a[j]],[t,q],[x,u])}}function q(a,b,c,d,e,f){for(var g=0;d>g;g++)for(var h=0;e>h;h++){var i=m(g,h,e),j=n(i,0,e),l=n(i,1,e),o=n(i,2,e),p=n(i,3,e),q=k.copy(a[j]).normalize(),r=k.copy(a[l]).normalize(),s=k.copy(a[o]).normalize(),t=k.copy(a[p]).normalize(),u=b[j].clone(),v=b[l].clone(),w=b[o].clone(),x=b[p].clone();f.point([a[j]],[q],[u]),f.point([a[l]],[r],[v]),f.point([a[o]],[s],[w]),f.point([a[p]],[t],[x])}}var r=function(a){function b(b,c,d,f,g,h){void 0===b&&(b=1),void 0===f&&(f=2*Math.PI),void 0===g&&(g=0),void 0===h&&(h=Math.PI),a.call(this,"SphericalPolarGeometry",c,d,f),this._radius=new e([b]),this.thetaLength=h,this.thetaStart=g,this.setModified(!0),this.regenerate()}return f(b,a),b.prototype.destructor=function(){this._radius=void 0,a.prototype.destructor.call(this)},Object.defineProperty(b.prototype,"radius",{get:function(){return this._radius.x},set:function(a){this._radius.x=d("radius",a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"phiLength",{get:function(){return this.sliceAngle},set:function(a){this.sliceAngle=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"phiStart",{get:function(){return this.sliceStart},set:function(a){this.sliceStart.copy(a)},enumerable:!0,configurable:!0}),b.prototype.isModified=function(){return this._radius.modified||a.prototype.isModified.call(this)},b.prototype.setModified=function(b){return a.prototype.setModified.call(this,b),this._radius.modified=b,this},b.prototype.regenerate=function(){this.data=[];var a=this.curvedSegments,b=this.curvedSegments,c=[],d=[];switch(l(this.radius,this.axis,this.phiStart,this.phiLength,this.thetaStart,this.thetaLength,a,b,c,d),this.k){case g.K_FOR_EMPTY:o(c,d,this.radius,a,b,this);break;case g.K_FOR_POINT:q(c,d,this.radius,a,b,this);break;case g.K_FOR_LINE_SEGMENT:p(c,d,this.radius,a,b,this);break;case g.K_FOR_TRIANGLE:o(c,d,this.radius,a,b,this);break;default:console.warn(this.k+"-simplex is not supported for geometry generation.")}this.setModified(!1)},b}(h);return r});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/TetrahedronGeometry",["require","exports","../geometries/PolyhedronGeometry"],function(a,b,c){var d=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],e=[2,1,0,0,3,2,1,3,0,2,3,1],g=function(a){function b(b,c){a.call(this,d,e,b,c)}return f(b,a),b}(c);return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/Euclidean3Error",["require","exports"],function(a,b){var c=function(a){function b(b){a.call(this,b),this.name="Euclidean3Error"}return f(b,a),b}(Error);return c}),b("davinci-eight/math/mathcore",["require","exports"],function(a,b){function c(a,b){return null!==a&&"object"==typeof a&&"function"==typeof a[b]}function d(a,b){return function(d){if(c(d,a)){return e[a]()}if("number"==typeof d){var e=d,f=e,g=b(f);return g}throw new TypeError("x must support "+a+"(x)")}}function e(a){return(Math.exp(a)+Math.exp(-a))/2}function f(a){return(Math.exp(a)-Math.exp(-a))/2}var g={VERSION:"1.7.2",cos:d("cos",Math.cos),cosh:d("cosh",e),exp:d("exp",Math.exp),norm:d("norm",function(a){return Math.abs(a)}),quad:d("quad",function(a){return a*a}),sin:d("sin",Math.sin),sinh:d("sinh",f),sqrt:d("sqrt",Math.sqrt),unit:d("unit",function(a){return a/Math.abs(a)}),Math:{cosh:e,sinh:f}};return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/NotImplementedError",["require","exports"],function(a,b){var c=function(a){function b(b){a.call(this,b),this.name="NotImplementedError"}return f(b,a),b}(Error);return c});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/DimensionError",["require","exports"],function(a,b){var c=function(a){function b(b){a.call(this,b),this.name="DimensionError"}return f(b,a),b}(Error);return c}),b("davinci-eight/math/Rational",["require","exports","../checks/mustBeInteger"],function(a,b,c){var d=function(){function a(a,b){c("n",a),c("d",b);var d,e=function(a,b){c("a",a),c("b",b);var d;for(0>a&&(a=-a),0>b&&(b=-b),b>a&&(d=a,a=b,b=d);;){if(a%=b,0===a)return b;if(b%=a,0===b)return a}};if(0===b)throw new Error("denominator must not be zero");d=0===a?1:e(Math.abs(a),Math.abs(b)),0>b&&(a=-a,b=-b),this._numer=a/d,this._denom=b/d}return Object.defineProperty(a.prototype,"numer",{get:function(){return this._numer},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"denom",{get:function(){return this._denom},enumerable:!0,configurable:!0}),a.prototype.add=function(b){return new a(this._numer*b._denom+this._denom*b._numer,this._denom*b._denom)},a.prototype.sub=function(b){return new a(this._numer*b._denom-this._denom*b._numer,this._denom*b._denom)},a.prototype.mul=function(b){return new a(this._numer*b._numer,this._denom*b._denom)},a.prototype.div=function(b){return"number"==typeof b?new a(this._numer,this._denom*b):new a(this._numer*b._denom,this._denom*b._numer)},a.prototype.isZero=function(){return 0===this._numer},a.prototype.negative=function(){return new a(-this._numer,this._denom)},a.prototype.equals=function(b){return b instanceof a?this._numer*b._denom===this._denom*b._numer:!1},a.prototype.toString=function(){return""+this._numer+"/"+this._denom},a.ONE=new a(1,1),a.TWO=new a(2,1),a.MINUS_ONE=new a(-1,1),a.ZERO=new a(0,1),a}();return d}),b("davinci-eight/math/Dimensions",["require","exports","../math/DimensionError","../math/Rational"],function(a,b,c,d){var e=d.ZERO,f=d.ONE,g=d.MINUS_ONE,h=function(){function a(a,b,c,e,f,g,h){this.L=b,this.T=c,this.Q=e,this.temperature=f,this.amount=g,this.intensity=h;var i=b,j=c,k=e;if(7!==arguments.length)throw{name:"DimensionError",message:"Expecting 7 arguments"};if(this._mass=a,"number"==typeof i)this.L=new d(i,1);else{if(!(i instanceof d))throw{name:"DimensionError",message:"length must be a Rational or number"};this.L=i}if("number"==typeof j)this.T=new d(j,1);else{if(!(j instanceof d))throw{name:"DimensionError",message:"time must be a Rational or number"};this.T=j}if("number"==typeof k)this.Q=new d(k,1);else{if(!(k instanceof d))throw{name:"DimensionError",message:"charge must be a Rational or number"};this.Q=k}if("number"==typeof f)this.temperature=new d(f,1);else{if(!(f instanceof d))throw{name:"DimensionError",message:"(thermodynamic) temperature must be a Rational or number"};this.temperature=f}if("number"==typeof g)this.amount=new d(g,1);else{if(!(g instanceof d))throw{name:"DimensionError",message:"amount (of substance) must be a Rational or number"};this.amount=g}if("number"==typeof h)this.intensity=new d(h,1);else{if(!(h instanceof d))throw{name:"DimensionError",message:"(luminous) intensity must be a Rational or number"};this.intensity=h}}return Object.defineProperty(a.prototype,"M",{get:function(){return this._mass},enumerable:!0,configurable:!0}),a.prototype.compatible=function(a){if(this._mass.equals(a._mass)&&this.L.equals(a.L)&&this.T.equals(a.T)&&this.Q.equals(a.Q)&&this.temperature.equals(a.temperature)&&this.amount.equals(a.amount)&&this.intensity.equals(a.intensity))return this;throw new c("Dimensions must be equal ("+this+", "+a+")")},a.prototype.mul=function(b){return new a(this._mass.add(b._mass),this.L.add(b.L),this.T.add(b.T),this.Q.add(b.Q),this.temperature.add(b.temperature),this.amount.add(b.amount),this.intensity.add(b.intensity))},a.prototype.div=function(b){return new a(this._mass.sub(b._mass),this.L.sub(b.L),this.T.sub(b.T),this.Q.sub(b.Q),this.temperature.sub(b.temperature),this.amount.sub(b.amount),this.intensity.sub(b.intensity))},a.prototype.pow=function(b){return new a(this._mass.mul(b),this.L.mul(b),this.T.mul(b),this.Q.mul(b),this.temperature.mul(b),this.amount.mul(b),this.intensity.mul(b))},a.prototype.sqrt=function(){return new a(this._mass.div(d.TWO),this.L.div(d.TWO),this.T.div(d.TWO),this.Q.div(d.TWO),this.temperature.div(d.TWO),this.amount.div(d.TWO),this.intensity.div(d.TWO))},a.prototype.dimensionless=function(){return this._mass.isZero()&&this.L.isZero()&&this.T.isZero()&&this.Q.isZero()&&this.temperature.isZero()&&this.amount.isZero()&&this.intensity.isZero()},a.prototype.isZero=function(){return this._mass.isZero()&&this.L.isZero()&&this.T.isZero()&&this.Q.isZero()&&this.temperature.isZero()&&this.amount.isZero()&&this.intensity.isZero()},a.prototype.negative=function(){return new a(this._mass.negative(),this.L.negative(),this.T.negative(),this.Q.negative(),this.temperature.negative(),this.amount.negative(),this.intensity.negative())},a.prototype.toString=function(){var a=function(a,b){return 0===a.numer?null:1===a.denom?1===a.numer?""+b:""+b+" ** "+a.numer:""+b+" ** "+a};return[a(this._mass,"mass"),a(this.L,"length"),a(this.T,"time"),a(this.Q,"charge"),a(this.temperature,"thermodynamic temperature"),a(this.amount,"amount of substance"),a(this.intensity,"luminous intensity")].filter(function(a){return"string"==typeof a}).join(" * ")},a.MASS=new a(f,e,e,e,e,e,e),a.LENGTH=new a(e,f,e,e,e,e,e),a.TIME=new a(e,e,f,e,e,e,e),a.CHARGE=new a(e,e,e,f,e,e,e),a.CURRENT=new a(e,e,g,f,e,e,e),a.TEMPERATURE=new a(e,e,e,e,f,e,e),a.AMOUNT=new a(e,e,e,e,e,f,e),a.INTENSITY=new a(e,e,e,e,e,e,f),a}();return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/UnitError",["require","exports"],function(a,b){var c=function(a){function b(b){a.call(this,b),this.name="UnitError"}return f(b,a),b}(Error);return c}),b("davinci-eight/math/Unit",["require","exports","../math/Dimensions","../math/Rational","../math/UnitError"],function(a,b,c,d,e){function f(a,b){if("number"==typeof b)return b;throw new e("Argument '"+a+"' must be a number")}function g(a,b){if(b instanceof c)return b;throw new e("Argument '"+b+"' must be a Dimensions")}function h(a,b){if(b instanceof d)return b;throw new e("Argument '"+b+"' must be a Rational")}function i(a,b){if(b instanceof s)return b;
throw new e("Argument '"+b+"' must be a Unit")}function j(a,b){return"undefined"==typeof b?b:i(a,b)}function k(a,b){return new s(a.scale+b.scale,a.dimensions.compatible(b.dimensions),a.labels)}function l(a,b){return new s(a.scale-b.scale,a.dimensions.compatible(b.dimensions),a.labels)}function m(a,b){return new s(a.scale*b.scale,a.dimensions.mul(b.dimensions),a.labels)}function n(a,b){return new s(a*b.scale,b.dimensions,b.labels)}function o(a,b){return new s(a.scale/b.scale,a.dimensions.div(b.dimensions),a.labels)}var p=["kg","m","s","C","K","mol","candela"],q=function(a,b,c){f("scale",a),g("dimensions",b);var d,e,h,i=function(a,b){return 0===a.numer?null:1===a.denom?1===a.numer?""+b:""+b+" ** "+a.numer:""+b+" ** "+a};return d=1===a||b.isZero()?"":" ",e=1===a?"":""+a,h=[i(b.M,c[0]),i(b.L,c[1]),i(b.T,c[2]),i(b.Q,c[3]),i(b.temperature,c[4]),i(b.amount,c[5]),i(b.intensity,c[6])].filter(function(a){return"string"==typeof a}).join(" "),""+e+d+h},r=function(a,b,c){for(var d=[[-1,1,-3,1,2,1,2,1,0,1,0,1,0,1],[-1,1,-2,1,1,1,2,1,0,1,0,1,0,1],[-1,1,-2,1,2,1,2,1,0,1,0,1,0,1],[-1,1,3,1,-2,1,0,1,0,1,0,1,0,1],[0,1,0,1,-1,1,0,1,0,1,0,1,0,1],[0,1,0,1,-1,1,1,1,0,1,0,1,0,1],[0,1,1,1,-2,1,0,1,0,1,0,1,0,1],[0,1,1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,-1,1,-2,1,0,1,0,1,0,1,0,1],[1,1,-1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,0,1,-3,1,0,1,0,1,0,1,0,1],[1,1,0,1,-2,1,0,1,0,1,0,1,0,1],[1,1,0,1,-1,1,-1,1,0,1,0,1,0,1],[1,1,1,1,-3,1,0,1,-1,1,0,1,0,1],[1,1,1,1,-2,1,-1,1,0,1,0,1,0,1],[1,1,1,1,-2,1,0,1,0,1,0,1,0,1],[1,1,1,1,0,1,-2,1,0,1,0,1,0,1],[1,1,2,1,-2,1,0,1,-1,1,0,1,0,1],[0,1,2,1,-2,1,0,1,-1,1,0,1,0,1],[1,1,2,1,-2,1,0,1,-1,1,-1,1,0,1],[1,1,2,1,-2,1,0,1,0,1,-1,1,0,1],[1,1,2,1,-2,1,0,1,0,1,0,1,0,1],[1,1,2,1,-1,1,0,1,0,1,0,1,0,1],[1,1,2,1,-3,1,0,1,0,1,0,1,0,1],[1,1,2,1,-2,1,-1,1,0,1,0,1,0,1],[1,1,2,1,-1,1,-2,1,0,1,0,1,0,1],[1,1,2,1,0,1,-2,1,0,1,0,1,0,1],[1,1,2,1,-1,1,-1,1,0,1,0,1,0,1]],e=[["F/m"],["S"],["F"],["Nm ** 2/kg ** 2"],["Hz"],["A"],["m/s ** 2"],["m/s"],["kgm/s"],["Pa"],["Pas"],["W/m ** 2"],["N/m"],["T"],["W/(mK)"],["V/m"],["N"],["H/m"],["J/K"],["J/(kgK)"],["J/(molK)"],["J/mol"],["J"],["Js"],["W"],["V"],[""],["H"],["Wb"]],f=b.M,g=b.L,h=b.T,i=b.Q,j=b.temperature,k=b.amount,l=b.intensity,m=0,n=d.length;n>m;m++){var o=d[m];if(f.numer===o[0]&&f.denom===o[1]&&g.numer===o[2]&&g.denom===o[3]&&h.numer===o[4]&&h.denom===o[5]&&i.numer===o[6]&&i.denom===o[7]&&j.numer===o[8]&&j.denom===o[9]&&k.numer===o[10]&&k.denom===o[11]&&l.numer===o[12]&&l.denom===o[13])return 1!==a?a+" * "+e[m][0]:e[m][0]}return q(a,b,c)},s=function(){function a(a,b,c){if(this.scale=a,this.dimensions=b,this.labels=c,7!==c.length)throw new Error("Expecting 7 elements in the labels array.");this.scale=a,this.dimensions=b,this.labels=c}return a.prototype.compatible=function(b){if(b instanceof a)return this.dimensions.compatible(b.dimensions),this;throw new Error("Illegal Argument for Unit.compatible: "+b)},a.prototype.add=function(a){return i("rhs",a),k(this,a)},a.prototype.__add__=function(b){return b instanceof a?k(this,b):void 0},a.prototype.__radd__=function(b){return b instanceof a?k(b,this):void 0},a.prototype.sub=function(a){return i("rhs",a),l(this,a)},a.prototype.__sub__=function(b){return b instanceof a?l(this,b):void 0},a.prototype.__rsub__=function(b){return b instanceof a?l(b,this):void 0},a.prototype.mul=function(a){return i("rhs",a),m(this,a)},a.prototype.__mul__=function(b){return b instanceof a?m(this,b):"number"==typeof b?n(b,this):void 0},a.prototype.__rmul__=function(b){return b instanceof a?m(b,this):"number"==typeof b?n(b,this):void 0},a.prototype.div=function(a){return i("rhs",a),o(this,a)},a.prototype.__div__=function(b){return b instanceof a?o(this,b):"number"==typeof b?new a(this.scale/b,this.dimensions,this.labels):void 0},a.prototype.__rdiv__=function(b){return b instanceof a?o(b,this):"number"==typeof b?new a(b/this.scale,this.dimensions.negative(),this.labels):void 0},a.prototype.pow=function(b){return h("exponent",b),new a(Math.pow(this.scale,b.numer/b.denom),this.dimensions.pow(b),this.labels)},a.prototype.inverse=function(){return new a(1/this.scale,this.dimensions.negative(),this.labels)},a.prototype.isUnity=function(){return this.dimensions.dimensionless()&&1===this.scale},a.prototype.norm=function(){return new a(Math.abs(this.scale),this.dimensions,this.labels)},a.prototype.quad=function(){return new a(this.scale*this.scale,this.dimensions.mul(this.dimensions),this.labels)},a.prototype.toString=function(){return r(this.scale,this.dimensions,this.labels)},a.isUnity=function(b){if("undefined"==typeof b)return!0;if(b instanceof a)return b.isUnity();throw new Error("isUnity argument must be a Unit or undefined.")},a.assertDimensionless=function(b){if(!a.isUnity(b))throw new e("uom must be dimensionless.")},a.compatible=function(a,b){if(j("lhs",a),j("rhs",b),a){if(b)return a.compatible(b);if(a.isUnity())return void 0;throw new e(a+" is incompatible with 1")}if(b){if(b.isUnity())return void 0;throw new e("1 is incompatible with "+b)}return void 0},a.mul=function(b,c){return b instanceof a?c instanceof a?b.mul(c):a.isUnity(c)?b:void 0:a.isUnity(b)?c:void 0},a.div=function(b,c){return b instanceof a?c instanceof a?b.div(c):b:c instanceof a?c.inverse():void 0},a.sqrt=function(b){return"undefined"!=typeof b?(i("uom",b),b.isUnity()?void 0:new a(Math.sqrt(b.scale),b.dimensions.sqrt(),b.labels)):void 0},a.KILOGRAM=new a(1,c.MASS,p),a.METER=new a(1,c.LENGTH,p),a.SECOND=new a(1,c.TIME,p),a.COULOMB=new a(1,c.CHARGE,p),a.AMPERE=new a(1,c.CURRENT,p),a.KELVIN=new a(1,c.TEMPERATURE,p),a.MOLE=new a(1,c.AMOUNT,p),a.CANDELA=new a(1,c.INTENSITY,p),a}();return s}),b("davinci-eight/math/Euclidean3",["require","exports","../math/Euclidean3Error","../math/mathcore","../math/NotImplementedError","../math/Unit"],function(a,b,c,d,e,f){function g(a,b){if("number"==typeof b)return b;throw new c("Argument '"+a+"' must be a number")}function h(a,b){if(b instanceof v)return b;throw new c("Argument '"+b+"' must be a Euclidean3")}function i(a,b){if("undefined"==typeof b||b instanceof f)return b;throw new c("Argument '"+b+"' must be a Unit or undefined")}function j(a,b,c,d,e,f){var g=d(b,0),h=d(b,1),i=d(b,2),j=d(b,3),k=d(b,4),l=d(b,5),m=d(b,6),n=d(b,7),o=d(c,0),p=d(c,1),q=d(c,2),r=d(c,3),s=d(c,4),t=d(c,5),u=d(c,6),v=d(c,7),w=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,0),x=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,1),y=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,2),z=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,3),A=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,4),B=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,5),C=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,6),D=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,7);return e(w,x,y,z,A,B,C,D,f)}function k(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,d=+d,e=+e,f=+f,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a+j);break;case 1:s=+(b+k);break;case 2:s=+(d+l);break;case 3:s=+(e+m);break;case 4:s=+(f+n);break;case 5:s=+(g+o);break;case 6:s=+(h+p);break;case 7:s=+(i+q);break;default:throw new c("index must be in the range [0..7]")}return+s}function l(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,d=+d,e=+e,f=+f,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a-j);break;case 1:s=+(b-k);break;case 2:s=+(d-l);break;case 3:s=+(e-m);break;case 4:s=+(f-n);break;case 5:s=+(g-o);break;case 6:s=+(h-p);break;case 7:s=+(i-q);break;default:throw new c("index must be in the range [0..7]")}return+s}function m(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,d=+d,e=+e,f=+f,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j+b*k+d*l+e*m-f*n-g*o-h*p-i*q);break;case 1:s=+(a*k+b*j-d*n+e*p+f*l-g*q-h*m-i*o);break;case 2:s=+(a*l+b*n+d*j-e*o-f*k+g*m-h*q-i*p);break;case 3:s=+(a*m-b*p+d*o+e*j-f*q-g*l+h*k-i*n);break;case 4:s=+(a*n+b*l-d*k+e*q+f*j-g*p+h*o+i*m);break;case 5:s=+(a*o+b*q+d*m-e*l+f*p+g*j-h*n+i*k);break;case 6:s=+(a*p-b*m+d*q+e*k-f*o+g*n+h*j+i*l);break;case 7:s=+(a*q+b*o+d*p+e*n+f*m+g*k+h*l+i*j);break;default:throw new c("index must be in the range [0..7]")}return+s}function n(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,d=+d,e=+e,f=+f,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j+b*k+d*l+e*m-f*n-g*o-h*p-i*q);break;case 1:s=0;break;case 2:s=0;break;case 3:s=0;break;case 4:s=0;break;case 5:s=0;break;case 6:s=0;break;case 7:s=0;break;default:throw new c("index must be in the range [0..7]")}return+s}function o(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,d=+d,e=+e,f=+f,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j);break;case 1:s=+(a*k+b*j);break;case 2:s=+(a*l+d*j);break;case 3:s=+(a*m+e*j);break;case 4:s=+(a*n+b*l-d*k+f*j);break;case 5:s=+(a*o+d*m-e*l+g*j);break;case 6:s=+(a*p-b*m+e*k+h*j);break;case 7:s=+(a*q+b*o+d*p+e*n+f*m+g*k+h*l+i*j);break;default:throw new c("index must be in the range [0..7]")}return+s}function p(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,d=+d,e=+e,f=+f,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j+b*k+d*l+e*m-f*n-g*o-h*p-i*q);break;case 1:s=+(a*k-d*n+e*p-g*q);break;case 2:s=+(a*l+b*n-e*o-h*q);break;case 3:s=+(a*m-b*p+d*o-f*q);break;case 4:s=+(a*n+e*q);break;case 5:s=+(a*o+b*q);break;case 6:s=+(a*p+d*q);break;case 7:s=+(a*q);break;default:throw new c("index must be in the range [0..7]")}return+s}function q(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,d=+d,e=+e,f=+f,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j+b*k+d*l+e*m-f*n-g*o-h*p-i*q);break;case 1:s=+(+b*j+f*l-h*m-i*o);break;case 2:s=+(+d*j-f*k+g*m-i*p);break;case 3:s=+(+e*j-g*l+h*k-i*n);break;case 4:s=+(+f*j+i*m);break;case 5:s=+(+g*j+i*k);break;case 6:s=+(+h*j+i*l);break;case 7:s=+(+i*j);break;default:throw new c("index must be in the range [0..7]")}return+s}function r(a,b,c){var d,e,f,g,h=[],i=function(a,c){var d;0!==a&&(a>=0?h.length>0&&h.push("+"):h.push("-"),d=Math.abs(a),1===d?h.push(c):(h.push(b(d)),"1"!==c&&(h.push("*"),h.push(c))))};for(d=e=0,f=a.length-1;f>=0?f>=e:e>=f;d=f>=0?++e:--e)i(a[d],c[d]);return g=h.length>0?h.join(""):"0"}var s=Math.cos,t=(d.Math.cosh,Math.exp,Math.sin),u=(d.Math.sinh,function(a,b,c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s){var t,u,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa;return T=+i,U=+j,V=+k,W=-l,X=+n,Y=-o,Z=-p,$=-q,L=m(i,j,k,n,l,p,-o,q,T,U,V,X,W,Z,-Y,$,0),M=m(i,j,k,n,l,p,-o,q,T,U,V,X,W,Z,-Y,$,1),N=m(i,j,k,n,l,p,-o,q,T,U,V,X,W,Z,-Y,$,2),O=0,P=m(i,j,k,n,l,p,-o,q,T,U,V,X,W,Z,-Y,$,3),Q=0,R=0,S=0,t=+L,u=-M,w=-N,x=-O,y=-P,z=-Q,A=-R,B=+S,_=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,0),aa=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,1),ba=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,2),ca=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,4),da=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,3),ea=-m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,6),fa=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,5),ga=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,7),K=m(i,j,k,n,l,p,-o,q,_,aa,ba,da,ca,fa,-ea,ga,0),C=_/K,D=aa/K,E=ba/K,F=ca/K,G=da/K,H=ea/K,I=fa/K,J=ga/K,ja=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,0),ka=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,1),la=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,2),ma=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,4),na=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,3),oa=-m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,6),pa=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,5),qa=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,7),ha=ja,ia=ka,ta=la,va=na,ra=ma,ua=pa,wa=-oa,sa=qa,"undefined"==typeof s?new v(ha,ia,ta,va,ra,ua,wa,sa,r):(s.w=ha,s.x=ia,s.y=ta,s.z=va,s.xy=ra,s.yz=ua,s.zx=wa,s.xyz=sa,s.uom=r,void 0)}),v=function(){function a(a,b,c,d,e,h,j,k,l){if(this.w=g("w",a),this.x=g("x",b),this.y=g("y",c),this.z=g("z",d),this.xy=g("xy",e),this.yz=g("yz",h),this.zx=g("zx",j),this.xyz=g("xyz",k),this.uom=i("uom",l),this.uom&&1!==this.uom.scale){var m=this.uom.scale;this.w*=m,this.x*=m,this.y*=m,this.z*=m,this.xy*=m,this.yz*=m,this.zx*=m,this.xyz*=m,this.uom=new f(1,l.dimensions,l.labels)}}return a.fromCartesian=function(b,c,d,e,f,h,j,k,l){return g("w",b),g("x",c),g("y",d),g("z",e),g("xy",f),g("yz",h),g("zx",j),g("xyz",k),i("uom",l),new a(b,c,d,e,f,h,j,k,l)},a.prototype.coordinates=function(){return[this.w,this.x,this.y,this.z,this.xy,this.yz,this.zx,this.xyz]},a.prototype.coordinate=function(a){switch(g("index",a),a){case 0:return this.w;case 1:return this.x;case 2:return this.y;case 3:return this.z;case 4:return this.xy;case 5:return this.yz;case 6:return this.zx;case 7:return this.xyz;default:throw new c("index must be in the range [0..7]")}},a.prototype.add=function(b){var c=function(a,b){return a[b]},d=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(k,this.coordinates(),b.coordinates(),c,d,f.compatible(this.uom,b.uom))},a.prototype.__add__=function(b){return b instanceof a?this.add(b):"number"==typeof b?this.add(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__radd__=function(b){return b instanceof a?b.add(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).add(this):void 0},a.prototype.sub=function(b){var c=function(a,b){return a[b]},d=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(l,this.coordinates(),b.coordinates(),c,d,f.compatible(this.uom,b.uom))},a.prototype.__sub__=function(b){return b instanceof a?this.sub(b):"number"==typeof b?this.sub(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rsub__=function(b){return b instanceof a?b.sub(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).sub(this):void 0},a.prototype.mul=function(b){var c=function(a,b){return a[b]},d=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(m,this.coordinates(),b.coordinates(),c,d,f.mul(this.uom,b.uom))},a.prototype.__mul__=function(b){return b instanceof a?this.mul(b):"number"==typeof b?this.mul(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rmul__=function(b){return b instanceof a?b.mul(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).mul(this):void 0},a.prototype.scalarMultiply=function(b){return new a(this.w*b,this.x*b,this.y*b,this.z*b,this.xy*b,this.yz*b,this.zx*b,this.xyz*b,this.uom)},a.prototype.div=function(a){return h("rhs",a),u(this.w,this.x,this.y,this.xy,this.z,-this.zx,this.yz,this.xyz,a.w,a.x,a.y,a.xy,a.z,-a.zx,a.yz,a.xyz,f.div(this.uom,a.uom))},a.prototype.__div__=function(b){return b instanceof a?this.div(b):"number"==typeof b?this.div(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rdiv__=function(b){return b instanceof a?b.div(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).div(this):void 0},a.prototype.splat=function(b){var c=function(a,b){return a[b]},d=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(n,this.coordinates(),b.coordinates(),c,d,f.mul(this.uom,b.uom))},a.prototype.wedge=function(b){var c=function(a,b){return a[b]},d=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(o,this.coordinates(),b.coordinates(),c,d,f.mul(this.uom,b.uom))},a.prototype.__vbar__=function(b){return b instanceof a?this.splat(b):"number"==typeof b?this.splat(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rvbar__=function(b){return b instanceof a?b.splat(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).splat(this):void 0},a.prototype.__wedge__=function(b){return b instanceof a?this.wedge(b):"number"==typeof b?this.wedge(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rwedge__=function(b){return b instanceof a?b.wedge(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).wedge(this):void 0},a.prototype.lshift=function(b){var c=function(a,b){return a[b]},d=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(p,this.coordinates(),b.coordinates(),c,d,f.mul(this.uom,b.uom))},a.prototype.__lshift__=function(b){return b instanceof a?this.lshift(b):"number"==typeof b?this.lshift(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rlshift__=function(b){return b instanceof a?b.lshift(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).lshift(this):void 0},a.prototype.rshift=function(b){var c=function(a,b){return a[b]},d=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(q,[this.w,this.x,this.y,this.z,this.xy,this.yz,this.zx,this.xyz],[b.w,b.x,b.y,b.z,b.xy,b.yz,b.zx,b.xyz],c,d,f.mul(this.uom,b.uom))},a.prototype.__rshift__=function(b){return b instanceof a?this.rshift(b):"number"==typeof b?this.rshift(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rrshift__=function(b){return b instanceof a?b.rshift(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).rshift(this):void 0},a.prototype.pow=function(a){throw new c("pow")},a.prototype.__pos__=function(){return this},a.prototype.__neg__=function(){return new a(-this.w,-this.x,-this.y,-this.z,-this.xy,-this.yz,-this.zx,-this.xyz,this.uom)},a.prototype.__tilde__=function(){return new a(this.w,this.x,this.y,this.z,-this.xy,-this.yz,-this.zx,-this.xyz,this.uom)},a.prototype.grade=function(b){switch(g("index",b),b){case 0:return a.fromCartesian(this.w,0,0,0,0,0,0,0,this.uom);case 1:return a.fromCartesian(0,this.x,this.y,this.z,0,0,0,0,this.uom);case 2:return a.fromCartesian(0,0,0,0,this.xy,this.yz,this.zx,0,this.uom);case 3:return a.fromCartesian(0,0,0,0,0,0,0,this.xyz,this.uom);default:return a.fromCartesian(0,0,0,0,0,0,0,0,this.uom)}},a.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},a.prototype.cross=function(b){var c,d,e,g,h,i,j,k,l;return d=this.x,h=this.y,k=this.z,e=b.x,i=b.y,l=b.z,c=h*l-k*i,g=k*e-d*l,j=d*i-h*e,new a(0,c,g,j,0,0,0,0,f.mul(this.uom,b.uom))},a.prototype.isZero=function(){return 0===this.w&&0===this.x&&0===this.y&&0===this.z&&0===this.yz&&0===this.zx&&0===this.xy&&0===this.xyz},a.prototype.length=function(){return Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z+this.xy*this.xy+this.yz*this.yz+this.zx*this.zx+this.xyz*this.xyz)},a.prototype.cos=function(){f.assertDimensionless(this.uom);var b=s(this.w);return new a(b,0,0,0,0,0,0,0,void 0)},a.prototype.cosh=function(){throw new e("cosh(Euclidean3)")},a.prototype.exp=function(){f.assertDimensionless(this.uom);var b=this.grade(2),c=b.norm();if(c.isZero())return new a(1,0,0,0,0,0,0,0,this.uom);var d=c.cos(),e=c.sin(),g=b.unit();return d.add(g.mul(e))},a.prototype.norm=function(){return new a(Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z+this.xy*this.xy+this.yz*this.yz+this.zx*this.zx+this.xyz*this.xyz),0,0,0,0,0,0,0,this.uom)},a.prototype.quad=function(){return new a(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z+this.xy*this.xy+this.yz*this.yz+this.zx*this.zx+this.xyz*this.xyz,0,0,0,0,0,0,0,f.mul(this.uom,this.uom))},a.prototype.sin=function(){f.assertDimensionless(this.uom);var b=t(this.w);return new a(b,0,0,0,0,0,0,0,void 0)},a.prototype.sinh=function(){throw new c("sinh")},a.prototype.unit=function(){return this.div(this.norm())},a.prototype.scalar=function(){return this.w},a.prototype.sqrt=function(){return new a(Math.sqrt(this.w),0,0,0,0,0,0,0,f.sqrt(this.uom))},a.prototype.toStringCustom=function(a,b){var c=r(this.coordinates(),a,b);if(this.uom){var d=this.uom.toString().trim();return d?c+" "+d:c}return c},a.prototype.toExponential=function(){var a=function(a){return a.toExponential()};return this.toStringCustom(a,["1","e1","e2","e3","e12","e23","e31","e123"])},a.prototype.toFixed=function(a){g("digits",a);var b=function(b){return b.toFixed(a)};return this.toStringCustom(b,["1","e1","e2","e3","e12","e23","e31","e123"])},a.prototype.toString=function(){var a=function(a){return a.toString()};return this.toStringCustom(a,["1","e1","e2","e3","e12","e23","e31","e123"])},a.prototype.toStringIJK=function(){var a=function(a){return a.toString()};return this.toStringCustom(a,["1","i","j","k","ij","jk","ki","I"])},a.prototype.toStringLATEX=function(){var a=function(a){return a.toString()};return this.toStringCustom(a,["1","e_{1}","e_{2}","e_{3}","e_{12}","e_{23}","e_{31}","e_{123}"])},a.zero=new a(0,0,0,0,0,0,0,0),a.one=new a(1,0,0,0,0,0,0,0),a.e1=new a(0,1,0,0,0,0,0,0),a.e2=new a(0,0,1,0,0,0,0,0),a.e3=new a(0,0,0,1,0,0,0,0),a.kilogram=new a(1,0,0,0,0,0,0,0,f.KILOGRAM),a.meter=new a(1,0,0,0,0,0,0,0,f.METER),a.second=new a(1,0,0,0,0,0,0,0,f.SECOND),a.coulomb=new a(1,0,0,0,0,0,0,0,f.COULOMB),a.ampere=new a(1,0,0,0,0,0,0,0,f.AMPERE),a.kelvin=new a(1,0,0,0,0,0,0,0,f.KELVIN),a.mole=new a(1,0,0,0,0,0,0,0,f.MOLE),a.candela=new a(1,0,0,0,0,0,0,0,f.CANDELA),a}();return v});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/geometries/VortexGeometry",["require","exports","../math/Euclidean3","../geometries/Geometry","../checks/mustBeInteger","../checks/mustBeString","../math/Spinor3","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g,h,i,j){function k(a){var b=new j([Math.random(),Math.random(),Math.random()]);return b.cross(a).normalize(),new c(0,b.x,b.y,b.z,0,0,0,0)}var l=function(a){function b(b){void 0===b&&(b="VortexGeometry"),a.call(this,g("type",b)),this.radius=1,this.radiusCone=.08,this.radiusShaft=.01,this.lengthCone=.2,this.lengthShaft=.8,this.arrowSegments=8,this.radialSegments=12,this.generator=new h([0,0,1,0]),this.setModified(!0)}return f(b,a),b.prototype.isModified=function(){return this.generator.modified},b.prototype.setModified=function(a){return this.generator.modified=a,this},b.prototype.regenerate=function(){function a(b){e("index",b);var c=b%p;if(c===p-1)return a(b-1);var d=(b-c)/p;return x*(d+c*y)}function b(a){e("index",a);var b=a%p;return b===p-1?d:f}this.data=[];for(var d=(this.radius,this.radiusCone),f=this.radiusShaft,g=this.radialSegments,h=new c(0,-this.generator.yz,-this.generator.zx,-this.generator.xy,0,0,0,0),l=k(h),m=l.scalarMultiply(this.radius),n=new c(this.generator.w,0,0,0,this.generator.xy,this.generator.yz,this.generator.zx,0),o=h.wedge(l),p=9,q=this.arrowSegments*p,r=2*Math.PI,s=new j([0,0,0]),t=[],u=[],v=[],w=this.lengthShaft/(this.lengthCone+this.lengthShaft),x=r/this.arrowSegments,y=w/(p-2),z=0;g>=z;z++)for(var A=r*z/g,B=0;q>=B;B++){var C=a(B),D=n.scalarMultiply(-C/2).exp();s.copy(m).rotate(D);var E=j.copy(s),F=h.scalarMultiply(b(B)),G=D.mul(o).mul(D.__tilde__()).scalarMultiply(-A/2).exp(),H=G.mul(F).mul(G.__tilde__());E.sum(s,H),u.push(E),v.push(new i([B/q,z/g])),t.push(j.copy(H).normalize())}for(var z=1;g>=z;z++)for(var B=1;q>=B;B++){var I=(q+1)*z+B-1,J=(q+1)*(z-1)+B-1,K=(q+1)*(z-1)+B,L=(q+1)*z+B;this.triangle([u[I],u[J],u[L]],[t[I],t[J],t[L]],[v[I],v[J],v[L]]),this.triangle([u[J],u[K],u[L]],[t[J],t[K],t[L]],[v[J],v[K],v[L]])}this.setModified(!1)},b}(d);return l}),b("davinci-eight/utils/mergeStringMapList",["require","exports"],function(a,b){function c(a){var b={};return a.forEach(function(a){for(var c=Object.keys(a),d=c.length,e=0;d>e;e++){var f=c[e],g=a[f];b[f]=g}}),b}return c}),b("davinci-eight/programs/smartProgram",["require","exports","../scene/MonitorList","../programs/fragmentShader","../utils/mergeStringMapList","../checks/mustBeDefined","./createMaterial","../programs/vColorRequired","../programs/vertexShader","../programs/vLightRequired"],function(a,b,c,d,e,f,g,h,i,j){var k=function(a,b,k,l){c.verify("monitors",a,function(){return"smartProgram"}),f("attributes",b),f("uniformsList",k);var m=e(k),n=h(b,m),o=j(b,m),p=g(a,i(b,m,n,o),d(b,m,n,o),l),q={get programId(){return p.programId},attributes:function(a){return p.attributes(a)},uniforms:function(a){return p.uniforms(a)},get vertexShader(){return p.vertexShader},get fragmentShader(){return p.fragmentShader},addRef:function(){return p.addRef()},release:function(){return p.release()},contextFree:function(a){return p.contextFree(a)},contextGain:function(a){return p.contextGain(a)},contextLost:function(a){return p.contextLost(a)},use:function(a){return p.use(a)},enableAttrib:function(a,b){return p.enableAttrib(a,b)},disableAttrib:function(a,b){return p.disableAttrib(a,b)},uniform1f:function(a,b,c){return p.uniform1f(a,b,c)},uniform2f:function(a,b,c,d){return p.uniform2f(a,b,c,d)},uniform3f:function(a,b,c,d,e){return p.uniform3f(a,b,c,d,e)},uniform4f:function(a,b,c,d,e,f){return p.uniform4f(a,b,c,d,e,f)},uniformMatrix2:function(a,b,c,d){return p.uniformMatrix2(a,b,c,d)},uniformMatrix3:function(a,b,c,d){return p.uniformMatrix3(a,b,c,d)},uniformMatrix4:function(a,b,c,d){return p.uniformMatrix4(a,b,c,d)},uniformCartesian2:function(a,b,c){return p.uniformCartesian2(a,b,c)},uniformCartesian3:function(a,b,c){return p.uniformCartesian3(a,b,c)},uniformCartesian4:function(a,b,c){return p.uniformCartesian4(a,b,c)},vector2:function(a,b,c){return p.vector2(a,b,c)},vector3:function(a,b,c){return p.vector3(a,b,c)},vector4:function(a,b,c){return p.vector4(a,b,c)}};return q};return k}),b("davinci-eight/programs/programFromScripts",["require","exports","../programs/createMaterial","../checks/expectArg","../scene/MonitorList"],function(a,b,c,d,e){function f(a,b,f,g,h){function i(a){d("id",a).toBeString();var b=g.getElementById(a);if(b)return b;throw new Error(a+" is not a valid DOM element identifier.")}void 0===h&&(h=[]),e.verify("monitors",a,function(){return"programFromScripts"}),d("vsId",b).toBeString(),d("fsId",f).toBeString(),d("$document",g).toBeObject();var j=i(b).textContent,k=i(f).textContent;return c(a,j,k,h)}return f});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/materials/HTMLScriptsMaterial",["require","exports","../materials/Material","../checks/mustSatisfy","../programs/programFromScripts"],function(a,b,c,d,e){var g="HTMLScriptsMaterial",h=function(a){function b(b,c,e){void 0===c&&(c=[]),void 0===e&&(e=document),a.call(this,b,g),this.attributeBindings=[],d("scriptIds",2===c.length,function(){return"scriptIds must be [vsId, fsId]"}),this.scriptIds=c.map(function(a){return a}),this.dom=e}return f(b,a),b.prototype.createMaterial=function(){var a=this.scriptIds[0],b=this.scriptIds[1];return e(this.monitors,a,b,this.dom,this.attributeBindings)},b}(c);return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/materials/MeshLambertMaterial",["require","exports","../materials/Material","../materials/SmartMaterialBuilder","../core/Symbolic"],function(a,b,c,d,e){var g="MeshLambertMaterial",h=function(a){function b(b){void 0===b&&(b=[]),a.call(this,b,g)}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.createMaterial=function(){var a=new d;return a.attribute(e.ATTRIBUTE_POSITION,3),a.attribute(e.ATTRIBUTE_NORMAL,3),a.uniform(e.UNIFORM_COLOR,"vec3"),a.uniform(e.UNIFORM_MODEL_MATRIX,"mat4"),a.uniform(e.UNIFORM_NORMAL_MATRIX,"mat3"),a.uniform(e.UNIFORM_PROJECTION_MATRIX,"mat4"),a.uniform(e.UNIFORM_VIEW_MATRIX,"mat4"),a.uniform(e.UNIFORM_DIRECTIONAL_LIGHT_COLOR,"vec3"),a.uniform(e.UNIFORM_DIRECTIONAL_LIGHT_DIRECTION,"vec3"),a.build(this.monitors)},b}(c);return h}),b("davinci-eight/mappers/RoundUniform",["require","exports"],function(a,b){var c=function(){function a(){}return Object.defineProperty(a.prototype,"next",{get:function(){return this._next},set:function(a){this._next=a},enumerable:!0,configurable:!0}),a.prototype.uniform1f=function(a,b,c){this._next&&this._next.uniform1f(a,Math.round(b),c)},a.prototype.uniform2f=function(a,b,c){console.warn("uniform")},a.prototype.uniform3f=function(a,b,c,d){console.warn("uniform")},a.prototype.uniform4f=function(a,b,c,d,e){console.warn("uniform")},a.prototype.uniformMatrix2=function(a,b,c){console.warn("uniform")},a.prototype.uniformMatrix3=function(a,b,c){console.warn("uniform")},a.prototype.uniformMatrix4=function(a,b,c){console.warn("uniform")},a.prototype.uniformCartesian2=function(a,b){console.warn("uniform")},a.prototype.uniformCartesian3=function(a,b){console.warn("uniform")},a.prototype.uniformCartesian4=function(a,b){console.warn("uniform")},a.prototype.vector2=function(a,b,c){this._next.vector2(a,b,c)},a.prototype.vector3=function(a,b,c){this._next.vector3(a,b,c)},a.prototype.vector4=function(a,b,c){this._next.vector4(a,b,c)},a}();return c});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/math/Vector4",["require","exports","../math/VectorN"],function(a,b,c){var d=function(a){function b(b,c){void 0===b&&(b=[0,0,0,0]),void 0===c&&(c=!1),a.call(this,b,c,4)}return f(b,a),Object.defineProperty(b.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.modified=this.modified||this.x!==a,this.data[0]=a},enumerable:!0,configurable:!0}),b.prototype.setX=function(a){return this.x=a,this},Object.defineProperty(b.prototype,"y",{get:function(){return this.data[1]},set:function(a){this.modified=this.modified||this.y!==a,this.data[1]=a},enumerable:!0,configurable:!0}),b.prototype.setY=function(a){return this.y=a,this},Object.defineProperty(b.prototype,"z",{get:function(){return this.data[2]},set:function(a){this.modified=this.modified||this.z!==a,this.data[2]=a},enumerable:!0,configurable:!0}),b.prototype.setZ=function(a){return this.z=a,this},Object.defineProperty(b.prototype,"w",{get:function(){return this.data[3]},set:function(a){this.modified=this.modified||this.w!==a,this.data[3]=a},enumerable:!0,configurable:!0}),b.prototype.setW=function(a){return this.w=a,this},b.prototype.add=function(a){return this},b.prototype.sum=function(a,b){return this},b.prototype.clone=function(){return new b([this.x,this.y,this.z,this.w])},b.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w,this},b.prototype.divideScalar=function(a){return this.x/=a,this.y/=a,this.z/=a,this.w/=a,this},b.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},b.prototype.scale=function(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this},b.prototype.reflect=function(a){return this},b.prototype.rotate=function(a){return this},b.prototype.sub=function(a){return this},b.prototype.difference=function(a,b){return this},b}(c);return d}),b("davinci-eight/mesh/ArrowBuilder",["require","exports","../checks/expectArg","../checks/isUndefined","../math/Vector3"],function(a,b,c,d,e){var f=function(){function a(a){void 0===a&&(a={}),this.$axis=e.e3.clone(),this.setFlavor(d(a.flavor)?0:a.flavor),this.setWireFrame(d(a.wireFrame)?!1:a.wireFrame)}return Object.defineProperty(a.prototype,"axis",{get:function(){return this.$axis},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"flavor",{get:function(){return this.$flavor},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.$height},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"depth",{get:function(){return this.$depth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"widthSegments",{get:function(){return this.$widthSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"heightSegments",{get:function(){return this.$heightSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"depthSegments",{get:function(){return this.$depthSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"coneHeight",{get:function(){return this.$coneHeight},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"wireFrame",{get:function(){return this.$wireFrame},enumerable:!0,configurable:!0}),a.prototype.setAxis=function(a){return c("axis",a).toBeObject(),this.$axis.copy(a),this},a.prototype.setFlavor=function(a){return c("flavor",a).toBeNumber().toSatisfy(a>=0,"flavor must be greater than or equal to zero."),this.$flavor=a,this;
},a.prototype.setHeight=function(a){return c("height",a).toBeNumber().toSatisfy(a>=0,"height must be greater than or equal to zero."),this.$height=a,this},a.prototype.setDepth=function(a){return c("depth",a).toBeNumber().toSatisfy(a>=0,"depth must be greater than or equal to zero."),this.$depth=a,this},a.prototype.setWidthSegments=function(a){return c("widthSegments",a).toBeNumber().toSatisfy(a>0,"widthSegments must be greater than zero."),this.$widthSegments=a,this},a.prototype.setHeightSegments=function(a){return c("heightSegments",a).toBeNumber().toSatisfy(a>0,"heightSegments must be greater than zero."),this.$heightSegments=a,this},a.prototype.setDepthSegments=function(a){return c("depthSegments",a).toBeNumber().toSatisfy(a>0,"depthSegments must be greater than zero."),this.$depthSegments=a,this},a.prototype.setConeHeight=function(a){return c("coneHeight",a).toBeNumber().toSatisfy(a>=0,"coneHeight must be positive."),this.$coneHeight=a,this},a.prototype.setWireFrame=function(a){return c("wireFrame",a).toBeBoolean(),this.$wireFrame=a,this},a}();return f}),b("davinci-eight/mesh/CylinderArgs",["require","exports","../checks/expectArg","../checks/isUndefined","../math/Vector3"],function(a,b,c,d,e){var f=function(){function a(a){void 0===a&&(a={}),this.$axis=e.e3.clone(),this.setRadiusTop(d(a.radiusTop)?1:a.radiusTop),this.setRadiusBottom(d(a.radiusBottom)?1:a.radiusBottom),this.setHeight(d(a.height)?1:a.height),this.setRadialSegments(d(a.radialSegments)?16:a.radialSegments),this.setHeightSegments(d(a.heightSegments)?1:a.heightSegments),this.setOpenEnded(d(a.openEnded)?!1:a.openEnded),this.setThetaStart(d(a.thetaStart)?0:a.thetaStart),this.setThetaLength(d(a.thetaLength)?2*Math.PI:a.thetaLength),this.setWireFrame(d(a.wireFrame)?!1:a.wireFrame)}return Object.defineProperty(a.prototype,"radiusTop",{get:function(){return this.$radiusTop},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"radiusBottom",{get:function(){return this.$radiusBottom},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.$height},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"radialSegments",{get:function(){return this.$radialSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"heightSegments",{get:function(){return this.$heightSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"openEnded",{get:function(){return this.$openEnded},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"thetaStart",{get:function(){return this.$thetaStart},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"thetaLength",{get:function(){return this.$thetaLength},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"wireFrame",{get:function(){return this.$wireFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"axis",{get:function(){return this.$axis},enumerable:!0,configurable:!0}),a.prototype.setRadiusTop=function(a){return c("radiusTop",a).toBeNumber().toSatisfy(a>=0,"radiusTop must be greater than or equal to zero."),this.$radiusTop=a,this},a.prototype.setRadiusBottom=function(a){return c("radiusBottom",a).toBeNumber().toSatisfy(a>=0,"radiusBottom must be greater than or equal to zero."),this.$radiusBottom=a,this},a.prototype.setHeight=function(a){return c("height",a).toBeNumber().toSatisfy(a>=0,"height must be greater than or equal to zero."),this.$height=a,this},a.prototype.setRadialSegments=function(a){return c("radialSegments",a).toBeNumber(),this.$radialSegments=a,this},a.prototype.setHeightSegments=function(a){return c("heightSegments",a).toBeNumber(),this.$heightSegments=a,this},a.prototype.setOpenEnded=function(a){return c("openEnded",a).toBeBoolean(),this.$openEnded=a,this},a.prototype.setThetaStart=function(a){return c("thetaStart",a).toBeNumber(),this.$thetaStart=a,this},a.prototype.setThetaLength=function(a){return c("thetaLength",a).toBeNumber(),this.$thetaLength=a,this},a.prototype.setWireFrame=function(a){return c("wireFrame",a).toBeBoolean(),this.$wireFrame=a,this},a.prototype.setAxis=function(a){return c("axis",a).toBeObject(),this.$axis.copy(a),this},a}();return f});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/models/EulerFacet",["require","exports","../i18n/readOnly","../utils/Shareable","../math/Vector3"],function(a,b,c,d,e){var g=function(a){function b(){a.call(this,"EulerFacet"),this._rotation=new e}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.getProperty=function(a){return void 0},b.prototype.setProperty=function(a,b){},b.prototype.setUniforms=function(a,b){console.warn("EulerFacet.setUniforms")},Object.defineProperty(b.prototype,"rotation",{get:function(){return this._rotation},set:function(a){throw new Error(c("rotation").message)},enumerable:!0,configurable:!0}),b}(d);return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/uniforms/AmbientLight",["require","exports","../core/Color","../utils/Shareable","../core/Symbolic"],function(a,b,c,d,e){var g=function(a){function b(){a.call(this,"AmbientLight"),this.color=c.white.clone(),this.color.red=.2,this.color.green=.2,this.color.blue=.2}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.getProperty=function(a){return void 0},b.prototype.setProperty=function(a,b){},b.prototype.setUniforms=function(a,b){a.vector3(e.UNIFORM_AMBIENT_LIGHT,this.color.data,b)},b}(d);return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/uniforms/DirectionalLight",["require","exports","../core/Color","../utils/Shareable","../core/Symbolic","../math/Vector3"],function(a,b,c,d,e,g){var h=function(a){function b(){a.call(this,"DirectionalLight"),this.direction=new g([-1,-1,-1]).normalize(),this.color=c.white.clone()}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.getProperty=function(a){return void 0},b.prototype.setProperty=function(a,b){},b.prototype.setUniforms=function(a,b){a.vector3(e.UNIFORM_DIRECTIONAL_LIGHT_DIRECTION,this.direction.data,b),a.vector3(e.UNIFORM_DIRECTIONAL_LIGHT_COLOR,this.color.data,b)},b}(d);return h});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/uniforms/PointSize",["require","exports","../checks/mustBeInteger","../utils/Shareable","../core/Symbolic"],function(a,b,c,d,e){var g=function(a){function b(b){void 0===b&&(b=2),a.call(this,"PointSize"),this.pointSize=c("pointSize",b)}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.getProperty=function(a){return void 0},b.prototype.setProperty=function(a,b){},b.prototype.setUniforms=function(a,b){a.uniform1f(e.UNIFORM_POINT_SIZE,this.pointSize,b)},b}(d);return g});var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b("davinci-eight/uniforms/Vector3Uniform",["require","exports","../checks/mustBeObject","../checks/mustBeString","../utils/Shareable"],function(a,b,c,d,e){function g(){return h}var h="Vector3Uniform",i=function(a){function b(b,e){a.call(this,"Vector3Uniform"),this._name=d("name",b,g),this._vector=c("vector",e,g)}return f(b,a),b.prototype.destructor=function(){a.prototype.destructor.call(this)},b.prototype.getProperty=function(a){return void 0},b.prototype.setProperty=function(a,b){},b.prototype.setUniforms=function(a,b){a.uniformCartesian3(this._name,this._vector,b)},b}(e);return i}),b("davinci-eight/utils/workbench3D",["require","exports"],function(a,b){function c(a,b){for(var c=a.getElementsByTagName(b),d=c.length-1;d>=0;d--){var e=c[d];e.parentNode.removeChild(e)}}var d="resize",e="canvas",f=function(a,b,f,g){function h(){var a=g.innerWidth,c=g.innerHeight;b.setSize(a,c),f.aspect=a/c}void 0===g&&(g=window);var i=g.document,j=function(a){h()},k={setUp:function(){i.body.insertBefore(a,i.body.firstChild),g.addEventListener(d,j,!1),h()},tearDown:function(){g.removeEventListener(d,j,!1),c(i,e)}};return k};return f}),b("davinci-eight/utils/windowAnimationRunner",["require","exports","../checks/expectArg"],function(a,b,c){function d(){}function e(a){if(a){var b="Exception raised during animate function: "+a;console.warn(b)}}function f(a){return!1}var g=function(a,b){var g=1,h=2,i=3;b=b||{};var j,k,l=c("options.window",b.window||window).toNotBeNull().value,m=c("options.setUp",b.setUp||d).value,n=c("options.tearDown",b.tearDown||e).value,o=c("options.terminate",b.terminate||f).toNotBeNull().value,p=!1,q=0,r=1e3,s=null,t=g,u=function(b){if(j&&(q=q+b-j),j=b,p||o(q/r)){p=!1,l.cancelAnimationFrame(s),w.isRunning?(t=i,j=void 0):console.error("stopSignal received while not running."),l.document.removeEventListener("keydown",v,!1);try{n(k)}catch(c){console.warn("Exception raised during tearDown function: "+c)}}else{s=l.requestAnimationFrame(u);try{a(q/r)}catch(c){k=c,p=!0}}},v=function(a){27===a.keyCode&&(p=!0,a.preventDefault())},w={start:function(){if(w.isRunning)throw new Error("The `start` method may only be called when not running.");m(),l.document.addEventListener("keydown",v,!1),t=h,s=l.requestAnimationFrame(u)},stop:function(){if(!w.isRunning)throw new Error("The `stop` method may only be called when running.");p=!0},reset:function(){if(!w.isPaused)throw new Error("The `reset` method may only be called when paused.");j=void 0,q=0,t=g},get time(){return q/r},lap:function(){if(!w.isRunning)throw new Error("The `lap` method may only be called when running.")},get isRunning(){return t===h},get isPaused(){return t===i}};return w};return g}),b("davinci-eight",["require","exports","davinci-eight/slideshow/Slide","davinci-eight/slideshow/Director","davinci-eight/slideshow/DirectorKeyboardHandler","davinci-eight/slideshow/animations/WaitAnimation","davinci-eight/slideshow/animations/ColorAnimation","davinci-eight/slideshow/animations/Vector3Animation","davinci-eight/slideshow/animations/Spinor3Animation","davinci-eight/slideshow/commands/AnimateDrawableCommand","davinci-eight/slideshow/commands/CreateCuboidDrawable","davinci-eight/slideshow/commands/DestroyDrawableCommand","davinci-eight/slideshow/commands/TestCommand","davinci-eight/slideshow/commands/TestCommand","davinci-eight/slideshow/commands/UseDrawableInSceneCommand","davinci-eight/cameras/createFrustum","davinci-eight/cameras/createPerspective","davinci-eight/cameras/createView","davinci-eight/cameras/frustumMatrix","davinci-eight/cameras/perspectiveMatrix","davinci-eight/cameras/viewMatrix","davinci-eight/commands/WebGLBlendFunc","davinci-eight/commands/WebGLClearColor","davinci-eight/commands/WebGLDisable","davinci-eight/commands/WebGLEnable","davinci-eight/core/AttribLocation","davinci-eight/core/Color","davinci-eight/core","davinci-eight/core/DrawMode","davinci-eight/core/Symbolic","davinci-eight/core/UniformLocation","davinci-eight/curves/Curve","davinci-eight/devices/Keyboard","davinci-eight/geometries/GeometryAttribute","davinci-eight/geometries/Simplex","davinci-eight/geometries/Vertex","davinci-eight/geometries/toGeometryMeta","davinci-eight/geometries/computeFaceNormals","davinci-eight/geometries/cube","davinci-eight/geometries/quadrilateral","davinci-eight/geometries/square","davinci-eight/geometries/tetrahedron","davinci-eight/geometries/toGeometryData","davinci-eight/geometries/triangle","davinci-eight/scene/createDrawList","davinci-eight/scene/Drawable","davinci-eight/scene/PerspectiveCamera","davinci-eight/scene/Scene","davinci-eight/scene/Canvas3D","davinci-eight/geometries/AxialGeometry","davinci-eight/geometries/GeometryElements","davinci-eight/geometries/RingGeometry","davinci-eight/geometries/ArrowGeometry","davinci-eight/geometries/BarnGeometry","davinci-eight/geometries/ConeGeometry","davinci-eight/geometries/CuboidGeometry","davinci-eight/geometries/CylinderGeometry","davinci-eight/geometries/DodecahedronGeometry","davinci-eight/geometries/IcosahedronGeometry","davinci-eight/geometries/KleinBottleGeometry","davinci-eight/geometries/Simplex1Geometry","davinci-eight/geometries/MobiusStripGeometry","davinci-eight/geometries/OctahedronGeometry","davinci-eight/geometries/SliceGeometry","davinci-eight/geometries/SurfaceGeometry","davinci-eight/geometries/PolyhedronGeometry","davinci-eight/geometries/RevolutionGeometry","davinci-eight/geometries/SphericalPolarGeometry","davinci-eight/geometries/TetrahedronGeometry","davinci-eight/geometries/VortexGeometry","davinci-eight/programs/createMaterial","davinci-eight/programs/smartProgram","davinci-eight/programs/programFromScripts","davinci-eight/materials/Material","davinci-eight/materials/HTMLScriptsMaterial","davinci-eight/materials/LineMaterial","davinci-eight/materials/MeshMaterial","davinci-eight/materials/MeshLambertMaterial","davinci-eight/materials/PointMaterial","davinci-eight/materials/SmartMaterialBuilder","davinci-eight/mappers/RoundUniform","davinci-eight/math/Euclidean3","davinci-eight/math/MutableNumber","davinci-eight/math/Matrix3","davinci-eight/math/Matrix4","davinci-eight/math/Spinor3","davinci-eight/math/Vector2","davinci-eight/math/Vector3","davinci-eight/math/Vector4","davinci-eight/math/VectorN","davinci-eight/mesh/ArrowBuilder","davinci-eight/mesh/CylinderArgs","davinci-eight/models/EulerFacet","davinci-eight/models/ModelFacet","davinci-eight/renderers/initWebGL","davinci-eight/renderers/renderer","davinci-eight/uniforms/AmbientLight","davinci-eight/uniforms/ColorFacet","davinci-eight/uniforms/DirectionalLight","davinci-eight/uniforms/PointSize","davinci-eight/uniforms/Vector3Uniform","davinci-eight/utils/contextProxy","davinci-eight/collections/IUnknownArray","davinci-eight/collections/NumberIUnknownMap","davinci-eight/utils/refChange","davinci-eight/utils/Shareable","davinci-eight/collections/StringIUnknownMap","davinci-eight/utils/workbench3D","davinci-eight/utils/windowAnimationRunner"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab){var bb={get LAST_MODIFIED(){return B.LAST_MODIFIED},get strict(){return B.strict},set strict(a){B.strict=a},get VERSION(){return B.VERSION},get Slide(){return c},get Director(){return d},get DirectorKeyboardHandler(){return e},get ColorAnimation(){return g},get WaitAnimation(){return f},get Vector3Animation(){return h},get Spinor3Animation(){return i},get AnimateDrawableCommand(){return j},get CreateCuboidDrawable(){return k},get DestroyDrawableCommand(){return l},get GeometryCommand(){return m},get TestCommand(){return n},get UseDrawableInSceneCommand(){return o},get Keyboard(){return G},get HTMLScriptsMaterial(){return ua},get Material(){return ta},get LineMaterial(){return va},get MeshMaterial(){return wa},get MeshLambertMaterial(){return xa},get PointMaterial(){return ya},get SmartMaterialBuilder(){return za},get WebGLBlendFunc(){return v},get WebGLClearColor(){return w},get WebGLDisable(){return x},get WebGLEnable(){return y},get initWebGL(){return Oa},get createFrustum(){return p},get createPerspective(){return q},get createView(){return r},get EulerFacet(){return Ma},get ModelFacet(){return Na},get Simplex(){return I},get Vertex(){return J},get frustumMatrix(){return s},get perspectiveMatrix(){return t},get viewMatrix(){return u},get Scene(){return V},get Drawable(){return T},get PerspectiveCamera(){return U},get Canvas3D(){return W},get createDrawList(){return S},get renderer(){return Pa},get webgl(){return Va},workbench:_a,animation:ab,get DrawMode(){return C},get AttribLocation(){return z},get UniformLocation(){return E},get createMaterial(){return qa},get smartProgram(){return ra},get Color(){return A},get CompatcGeometry(){return Y},get RingGeometry(){return Z},get AxialGeometry(){return X},get ArrowGeometry(){return $},get BarnGeometry(){return _},get ConeGeometry(){return aa},get CuboidGeometry(){return ba},get CylinderGeometry(){return ca},get DodecahedronGeometry(){return da},get IcosahedronGeometry(){return ea},get KleinBottleGeometry(){return fa},get Simplex1Geometry(){return ga},get MobiusStripGeometry(){return ha},get OctahedronGeometry(){return ia},get SurfaceGeometry(){return ka},get PolyhedronGeometry(){return la},get RevolutionGeometry(){return ma},get SliceGeometry(){return ja},get SphericalPolarGeometry(){return na},get TetrahedronGeometry(){return oa},get VortexGeometry(){return pa},get Euclidean3(){return Ba},get Matrix3(){return Da},get Matrix4(){return Ea},get Spinor3(){return Fa},get MutableNumber(){return Ca},get Vector2(){return Ga},get Vector3(){return Ha},get Vector4(){return Ia},get VectorN(){return Ja},get Curve(){return F},get RoundUniform(){return Aa},get ArrowBuilder(){return Ka},get toGeometryMeta(){return K},get computeFaceNormals(){return L},get cube(){return M},get quadrilateral(){return N},get square(){return O},get tetrahedron(){return P},get triangle(){return R},get toGeometryData(){return Q},get CylinderArgs(){return La},get Symbolic(){return D},get programFromScripts(){return sa},get GeometryAttribute(){return H},get GeometryElements(){return Y},get AmbientLight(){return Qa},get ColorFacet(){return Ra},get DirectionalLight(){return Sa},get PointSize(){return Ta},get Vector3Uniform(){return Ua},get IUnknownArray(){return Wa},get NumberIUnknownMap(){return Xa},get refChange(){return Ya},get Shareable(){return Za},get StringIUnknownMap(){return $a}};return bb});var g=d("davinci-eight");"undefined"!=typeof module&&module.exports?module.exports=g:e?!function(a){a(function(){return g})}(e):a.EIGHT=g}(this);