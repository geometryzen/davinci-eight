!function(a,b){var c,d,b,e=a.define;!function(a){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.slice(0,n.length-1).concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(b,c){return function(){var d=v.call(arguments,0);return"string"!=typeof d[0]&&1===d.length&&d.push(null),n.apply(a,d.concat([b,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(b){if(e(r,b)){var c=r[b];delete r[b],t[b]=!0,m.apply(a,c)}if(!e(q,b)&&!e(t,b))throw new Error("No "+b);return q[b]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(b,c,d,f){var h,k,l,m,n,s,u=[],v=typeof d;if(f=f||b,"undefined"===v||"function"===v){for(c=!c.length&&d.length?["require","exports","module"]:c,n=0;n<c.length;n+=1)if(m=o(c[n],f),k=m.f,"require"===k)u[n]=p.require(b);else if("exports"===k)u[n]=p.exports(b),s=!0;else if("module"===k)h=u[n]=p.module(b);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(b+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=d?d.apply(q[b],u):void 0,b&&(h&&h.exports!==a&&h.exports!==q[b]?q[b]=h.exports:l===a&&s||(q[b]=l))}else b&&(q[b]=d)},c=d=n=function(b,c,d,e,f){if("string"==typeof b)return p[b]?p[b](c):j(o(b,c).f);if(!b.splice){if(s=b,s.deps&&n(s.deps,s.callback),!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(a,b,c,d):setTimeout(function(){m(a,b,c,d)},4),n},n.config=function(a){return n(a)},c._defined=q,b=function(a,b,c){if("string"!=typeof a)throw new Error("See almond README: incorrect module build, no module name");b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},b.amd={jQuery:!0}}(),b("../vendor/almond/almond",function(){}),b("davinci-eight/checks/isUndefined",["require","exports"],function(a,b){function c(a){return"undefined"==typeof a}return c}),b("davinci-eight/checks/expectArg",["require","exports","../checks/isUndefined"],function(a,b,c){function d(a,b){return c(b)?a:b()}function e(a,b){var e={toSatisfy:function(a,b){if(c(a))throw new Error("condition must be specified");if(c(b))throw new Error("message must be specified");if(!a)throw new Error(b);return e},toBeBoolean:function(c){var f=typeof b;if("boolean"!==f)throw new Error(d("Expecting argument "+a+": "+f+" to be a boolean.",c));return e},toBeDefined:function(){var c=typeof b;if("undefined"===c){var d="Expecting argument "+a+": "+c+" to be defined.";throw new Error(d)}return e},toBeInClosedInterval:function(c,d){if(b>=c&&d>=b)return e;var f="Expecting argument "+a+" => "+b+" to be in the range ["+c+", "+d+"].";throw new Error(f)},toBeFunction:function(){var c=typeof b;if("function"!==c){var d="Expecting argument "+a+": "+c+" to be a function.";throw new Error(d)}return e},toBeNumber:function(c){var f=typeof b;if("number"!==f)throw new Error(d("Expecting argument "+a+": "+f+" to be a number.",c));return e},toBeObject:function(c){var f=typeof b;if("object"!==f)throw new Error(d("Expecting argument "+a+": "+f+" to be an object.",c));return e},toBeString:function(){var c=typeof b;if("string"!==c){var d="Expecting argument "+a+": "+c+" to be a string.";throw new Error(d)}return e},toBeUndefined:function(){var c=typeof b;if("undefined"!==c){var d="Expecting argument "+a+": "+c+" to be undefined.";throw new Error(d)}return e},toNotBeNull:function(){if(null===b){var c="Expecting argument "+a+" to not be null.";throw new Error(c)}return e},get value(){return b}};return e}return e}),b("davinci-eight/checks/isDefined",["require","exports"],function(a,b){function c(a){return"undefined"!=typeof a}return c}),b("davinci-eight/math/VectorN",["require","exports","../checks/expectArg","../checks/isDefined","../checks/isUndefined"],function(a,b,c,d,e){function f(a){return"new VectorN<"+a+">(data: "+a+"[], modified: boolean = false, size?: number)"}function g(a){return"push(value: "+a+"): number"}function h(a){return"pop(): "+a}function i(a,b,c){return b+" must be a "+c+" in "+a}function j(a,b,c){return b+" length must be "+c+" in "+a}function k(){return i(f("T"),"data","T[]")}function l(a){return function(){return j(f("T"),"data",a)}}function m(a){return a+" is not allowed for a fixed size vector"}function n(){return m(g("T"))}function o(){return m(h("T"))}function p(){return i(f("T"),"modified","boolean")}function q(){return i(f("T"),"size","number")}var r=function(){function a(a,b,e){void 0===b&&(b=!1);var f=c("data",a).toBeObject(k);this.modified=c("modified",b).toBeBoolean(p).value,d(e)?(this._size=c("size",e).toBeNumber(q).toSatisfy(e>=0,"size must be positive").value,this._data=f.toSatisfy(a.length===e,l(e)()).value):(this._size=void 0,this._data=f.value)}return Object.defineProperty(a.prototype,"data",{get:function(){if(this._data)return this._data;if(this._callback){var a=this._callback();return d(this._size)&&c("callback()",a).toSatisfy(a.length===this._size,"callback() length must be "+this._size),this._callback()}throw new Error("Vector"+this._size+" is undefined.")},set:function(a){d(this._size)&&c("data",a).toSatisfy(a.length===this._size,"data length must be "+this._size),this._data=a,this._callback=void 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"callback",{get:function(){return this._callback},set:function(a){this._callback=a,this._data=void 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"length",{get:function(){return this.data.length},enumerable:!0,configurable:!0}),a.prototype.clone=function(){return new a(this._data,this.modified,this._size)},a.prototype.getComponent=function(a){return this.data[a]},a.prototype.pop=function(){if(e(this._size))return this.data.pop();throw new Error(o())},a.prototype.push=function(a){if(e(this._size)){var b=this.data,c=b.push(a);return this.data=b,c}throw new Error(n())},a.prototype.setComponent=function(a,b){var c=this.data;c[a]=b,this.data=c},a.prototype.toArray=function(a,b){void 0===a&&(a=[]),void 0===b&&(b=0);for(var c=this.data,d=c.length,e=0;d>e;e++)a[b+e]=c[e];return a},a.prototype.toLocaleString=function(){return this.data.toLocaleString()},a.prototype.toString=function(){return this.data.toString()},a}();return r});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/math/Vector3",["require","exports","../checks/expectArg","../math/VectorN"],function(a,b,c,d){var e=function(a){function b(b,c){void 0===b&&(b=[0,0,0]),void 0===c&&(c=!1),a.call(this,b,c,3)}return f(b,a),b.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z},Object.defineProperty(b.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.modified=this.modified||this.x!==a,this.data[0]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this.data[1]},set:function(a){this.modified=this.modified||this.y!==a,this.data[1]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"z",{get:function(){return this.data[2]},set:function(a){this.modified=this.modified||this.z!==a,this.data[2]=a},enumerable:!0,configurable:!0}),b.prototype.add=function(a){return this.addVectors(this,a)},b.prototype.addVectors=function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},b.prototype.applyMatrix3=function(a){var b=this.x,c=this.y,d=this.z,e=a.data;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this},b.prototype.applyMatrix4=function(a){var b=this.x,c=this.y,d=this.z,e=a.data;return this.x=e[0]*b+e[4]*c+e[8]*d+e[12],this.y=e[1]*b+e[5]*c+e[9]*d+e[13],this.z=e[2]*b+e[6]*c+e[10]*d+e[14],this},b.prototype.applyQuaternion=function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,h=a.w,i=h*b+f*d-g*c,j=h*c+g*b-e*d,k=h*d+e*c-f*b,l=-e*b-f*c-g*d;return this.x=i*h+l*-e+j*-g-k*-f,this.y=j*h+l*-f+k*-e-i*-g,this.z=k*h+l*-g+i*-f-j*-e,this},b.prototype.applySpinor=function(a){var b=this.x,c=this.y,d=this.z,e=a.yz,f=a.zx,g=a.xy,h=a.w,i=h*b+f*d-g*c,j=h*c+g*b-e*d,k=h*d+e*c-f*b,l=-e*b-f*c-g*d;return this.x=i*h+l*-e+j*-g-k*-f,this.y=j*h+l*-f+k*-e-i*-g,this.z=k*h+l*-g+i*-f-j*-e,this},b.prototype.clone=function(){return new b([this.x,this.y,this.z])},b.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},b.prototype.cross=function(a){return this.crossVectors(this,a)},b.prototype.crossVectors=function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this},b.prototype.distanceTo=function(a){return Math.sqrt(this.quadranceTo(a))},b.prototype.quadranceTo=function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},b.prototype.divideScalar=function(a){if(0!==a){var b=1/a;this.x*=b,this.y*=b,this.z*=b}else this.x=0,this.y=0,this.z=0;return this},b.prototype.dot=function(a){return b.dot(this,a)},b.prototype.magnitude=function(){return Math.sqrt(this.quaditude())},b.prototype.quaditude=function(){var a=this.x,b=this.y,c=this.z;return a*a+b*b+c*c},b.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},b.prototype.normalize=function(){return this.divideScalar(this.magnitude())},b.prototype.multiply=function(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this},b.prototype.multiplyScalar=function(a){return this.x*=a,this.y*=a,this.z*=a,this},b.prototype.set=function(a,b,d){return this.x=c("x",a).toBeNumber().value,this.y=c("y",b).toBeNumber().value,this.z=c("z",d).toBeNumber().value,this},b.prototype.setMagnitude=function(a){var b=this.magnitude();if(0!==b)return a!==b?this.multiplyScalar(a/b):this;throw new Error("Attempting to set the magnitude of a null vector.")},b.prototype.setX=function(a){return this.x=a,this},b.prototype.setY=function(a){return this.y=a,this},b.prototype.setZ=function(a){return this.z=a,this},b.prototype.sub=function(a){return this.subVectors(this,a)},b.prototype.subVectors=function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},b.prototype.toString=function(){return"Vector3({x: "+this.x+", y: "+this.y+", z: "+this.z+"})"},b.copy=function(a){return new b([a.x,a.y,a.z])},b.e1=new b([1,0,0]),b.e2=new b([0,1,0]),b.e3=new b([0,0,1]),b}(d);return e}),b("davinci-eight/math/AbstractMatrix",["require","exports","../checks/expectArg"],function(a,b,c){var d=function(){function a(a,b){c("data",a).toSatisfy(a.length===b,"data must have length "+b),this._data=a,this._length=b,this.modified=!1}return Object.defineProperty(a.prototype,"data",{get:function(){if(this._data)return this._data;if(this._callback){var a=this._callback();return c("callback()",a).toSatisfy(a.length===this._length,"callback() length must be "+this._length),this._callback()}throw new Error("Matrix"+Math.sqrt(this._length)+" is undefined.")},set:function(a){c("data",a).toSatisfy(a.length===this._length,"data length must be "+this._length),this._data=a,this._callback=void 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"callback",{get:function(){return this._callback},set:function(a){this._callback=a,this._data=void 0},enumerable:!0,configurable:!0}),a}();return d});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/math/Matrix4",["require","exports","../math/AbstractMatrix","../checks/expectArg","../checks/isDefined"],function(a,b,c,d,e){var g=function(a){function b(b){a.call(this,b,16)}return f(b,a),b.identity=function(){return new b(new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]))},b.scaling=function(a){return b.identity().scaling(a)},b.translation=function(a){return b.identity().translation(a)},b.rotation=function(a){return b.identity().rotation(a)},b.prototype.clone=function(){return b.identity().copy(this)},b.prototype.compose=function(a,b,c){return this.scaling(a),this.rotate(b),this.translate(c),this},b.prototype.copy=function(a){return this.data.set(a.data),this},b.prototype.determinant=function(){var a=this.data,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14],n=a[3],o=a[7],p=a[11],q=a[15],r=b*g,s=b*h,t=b*i,u=c*f,v=c*h,w=c*i,x=d*f,y=d*g,z=d*i,A=e*f,B=e*g,C=e*h;return n*((C-z)*k+(w-B)*l+(y-v)*m)+o*((z-C)*j+(A-t)*l+(s-x)*m)+p*((B-w)*j+(t-A)*k+(u-r)*m)+q*((v-y)*j+(x-s)*k+(r-u)*l)},b.prototype.invert=function(a,b){void 0===b&&(b=!1);var c=this.data,d=a.data,e=d[0],f=d[4],g=d[8],h=d[12],i=d[1],j=d[5],k=d[9],l=d[13],m=d[2],n=d[6],o=d[10],p=d[14],q=d[3],r=d[7],s=d[11],t=d[15];c[0]=k*p*r-l*o*r+l*n*s-j*p*s-k*n*t+j*o*t,c[4]=h*o*r-g*p*r-h*n*s+f*p*s+g*n*t-f*o*t,c[8]=g*l*r-h*k*r+h*j*s-f*l*s-g*j*t+f*k*t,c[12]=h*k*n-g*l*n-h*j*o+f*l*o+g*j*p-f*k*p,c[1]=l*o*q-k*p*q-l*m*s+i*p*s+k*m*t-i*o*t,c[5]=g*p*q-h*o*q+h*m*s-e*p*s-g*m*t+e*o*t,c[9]=h*k*q-g*l*q-h*i*s+e*l*s+g*i*t-e*k*t,c[13]=g*l*m-h*k*m+h*i*o-e*l*o-g*i*p+e*k*p,c[2]=j*p*q-l*n*q+l*m*r-i*p*r-j*m*t+i*n*t,c[6]=h*n*q-f*p*q-h*m*r+e*p*r+f*m*t-e*n*t,c[10]=f*l*q-h*j*q+h*i*r-e*l*r-f*i*t+e*j*t,c[14]=h*j*m-f*l*m-h*i*n+e*l*n+f*i*p-e*j*p,c[3]=k*n*q-j*o*q-k*m*r+i*o*r+j*m*s-i*n*s,c[7]=f*o*q-g*n*q+g*m*r-e*o*r-f*m*s+e*n*s,c[11]=g*j*q-f*k*q-g*i*r+e*k*r+f*i*s-e*j*s,c[15]=f*k*m-g*j*m+g*i*n-e*k*n-f*i*o+e*j*o;var u=e*c[0]+i*c[4]+m*c[8]+q*c[12];if(0!==u)return this.multiplyScalar(1/u);var v="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(b)throw new Error(v);return console.warn(v),this.identity(),this},b.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},b.prototype.multiplyScalar=function(a){var b=this.data;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},b.prototype.transpose=function(){var a,b=this.data;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},b.prototype.frustum=function(a,b,c,d,e,f){var g=this.data,h=2*e/(b-a),i=2*e/(d-c),j=(b+a)/(b-a),k=(d+c)/(d-c),l=-(f+e)/(f-e),m=-2*f*e/(f-e);return g[0]=h,g[4]=0,g[8]=j,g[12]=0,g[1]=0,g[5]=i,g[9]=k,g[13]=0,g[2]=0,g[6]=0,g[10]=l,g[14]=m,g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},b.prototype.rotationAxis=function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1)},b.prototype.mul=function(a){return b.mul(this.data,a.data,this.data),this},b.prototype.multiplyMatrices=function(a,c){return b.mul(a.data,c.data,this.data),this},b.mul=function(a,b,c){var d=a[0],e=a[4],f=a[8],g=a[12],h=a[1],i=a[5],j=a[9],k=a[13],l=a[2],m=a[6],n=a[10],o=a[14],p=a[3],q=a[7],r=a[11],s=a[15],t=b[0],u=b[4],v=b[8],w=b[12],x=b[1],y=b[5],z=b[9],A=b[13],B=b[2],C=b[6],D=b[10],E=b[14],F=b[3],G=b[7],H=b[11],I=b[15];return c[0]=d*t+e*x+f*B+g*F,c[4]=d*u+e*y+f*C+g*G,c[8]=d*v+e*z+f*D+g*H,c[12]=d*w+e*A+f*E+g*I,c[1]=h*t+i*x+j*B+k*F,c[5]=h*u+i*y+j*C+k*G,c[9]=h*v+i*z+j*D+k*H,c[13]=h*w+i*A+j*E+k*I,c[2]=l*t+m*x+n*B+o*F,c[6]=l*u+m*y+n*C+o*G,c[10]=l*v+m*z+n*D+o*H,c[14]=l*w+m*A+n*E+o*I,c[3]=p*t+q*x+r*B+s*F,c[7]=p*u+q*y+r*C+s*G,c[11]=p*v+q*z+r*D+s*H,c[15]=p*w+q*A+r*E+s*I,c},b.prototype.rotate=function(a){var c=b.rotation(a);return b.mul(c.data,this.data,this.data),this},b.prototype.rotation=function(a){var b=-d("spinor.yz",a.yz).toBeNumber().value,c=-d("spinor.zx",a.zx).toBeNumber().value,e=-d("spinor.xy",a.xy).toBeNumber().value,f=d("spinor.w",a.w).toBeNumber().value,g=b+b,h=c+c,i=e+e,j=b*g,k=b*h,l=b*i,m=c*h,n=c*i,o=e*i,p=f*g,q=f*h,r=f*i;return this.set(1-m-o,k-r,l+q,0,k+r,1-j-o,n-p,0,l-q,n+p,1-j-m,0,0,0,0,1),this},b.prototype.row=function(a){var b=this.data;return[b[0+a],b[4+a],b[8+a],b[12+a]]},b.prototype.scale=function(a){var c=b.scaling(a);return b.mul(c.data,this.data,this.data),this},b.prototype.scaling=function(a){return this.set(a.x,0,0,0,0,a.y,0,0,0,0,a.z,0,0,0,0,1)},b.prototype.set=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.data;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},b.prototype.toFixed=function(a){e(a)&&d("digits",a).toBeNumber();for(var b=[],c=0;3>=c;c++)b.push(this.row(c).map(function(b,c){return b.toFixed(a)}).join(" "));return b.join("\n")},b.prototype.toString=function(){for(var a=[],b=0;3>=b;b++)a.push(this.row(b).map(function(a,b){return a.toString()}).join(" "));return a.join("\n")},b.prototype.translate=function(a){var c=b.translation(a);return b.mul(c.data,this.data,this.data),this},b.prototype.translation=function(a){return this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1)},b.prototype.__mul__=function(a){return a instanceof b?b.identity().multiplyMatrices(this,a):"number"==typeof a?this.clone().multiplyScalar(a):void 0},b.prototype.__rmul__=function(a){return a instanceof b?b.identity().multiplyMatrices(a,this):"number"==typeof a?this.clone().multiplyScalar(a):void 0},b}(c);return g}),b("davinci-eight/core/Symbolic",["require","exports"],function(a,b){var c=function(){function a(){}return a.ATTRIBUTE_COLOR="aVertexColor",a.ATTRIBUTE_NORMAL="aVertexNormal",a.ATTRIBUTE_POSITION="aVertexPosition",a.ATTRIBUTE_TEXTURE="aTexCoord",a.UNIFORM_AMBIENT_LIGHT="uAmbientLight",a.UNIFORM_COLOR="uColor",a.UNIFORM_DIRECTIONAL_LIGHT_COLOR="uDirectionalLightColor",a.UNIFORM_DIRECTIONAL_LIGHT_DIRECTION="uDirectionalLightDirection",a.UNIFORM_POINT_LIGHT_COLOR="uPointLightColor",a.UNIFORM_POINT_LIGHT_POSITION="uPointLightPosition",a.UNIFORM_PROJECTION_MATRIX="uProjectionMatrix",a.UNIFORM_MODEL_MATRIX="uModelMatrix",a.UNIFORM_NORMAL_MATRIX="uNormalMatrix",a.UNIFORM_VIEW_MATRIX="uViewMatrix",a.VARYING_COLOR="vColor",a.VARYING_LIGHT="vLight",a}();return c}),b("davinci-eight/cameras/viewArray",["require","exports","../math/Vector3","../checks/expectArg","../checks/isDefined"],function(a,b,c,d,e){function f(a,b,f,g){var h=e(g)?g:new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);d("matrix",h).toSatisfy(16===h.length,"matrix must have length 16");var i=(new c).subVectors(a,b);0===i.x&&0===i.y&&0===i.z?i.z=1:i.normalize();var j=(new c).crossVectors(f,i),k=(new c).crossVectors(i,j),l=new c([c.dot(a,j),c.dot(a,k),c.dot(a,i)]).multiplyScalar(-1);return h[0]=j.x,h[4]=j.y,h[8]=j.z,h[12]=l.x,h[1]=k.x,h[5]=k.y,h[9]=k.z,h[13]=l.y,h[2]=i.x,h[6]=i.y,h[10]=i.z,h[14]=l.z,h[3]=0,h[7]=0,h[11]=0,h[15]=1,h}return f}),b("davinci-eight/cameras/viewMatrix",["require","exports","../checks/isDefined","../math/Matrix4","../cameras/viewArray"],function(a,b,c,d,e){function f(a,b,f,g){var h=c(g)?g:d.identity();return e(a,b,f,h.data),h}return f}),b("davinci-eight/cameras/view",["require","exports","../math/Vector3","../math/Matrix4","../core/Symbolic","../checks/expectArg","../checks/isUndefined","../cameras/viewMatrix"],function(a,b,c,d,e,f,g,h){var i=function(a){var b=new c,i=new c,j=c.e2,k=d.identity(),l=g(a.viewMatrixName)?e.UNIFORM_VIEW_MATRIX:a.viewMatrixName;b.modified=!0,i.modified=!0,j.modified=!0;var m={get eye(){return b},set eye(a){m.setEye(a)},setEye:function(a){return f("eye",a).toBeObject(),b.x=a.x,b.y=a.y,b.z=a.z,m},get look(){return i},set look(a){m.setLook(a)},setLook:function(a){return f("look",a).toBeObject(),i.x=a.x,i.y=a.y,i.z=a.z,m},get up(){return j},set up(a){m.setUp(a)},setUp:function(a){return f("up",a).toBeObject(),j.x=a.x,j.y=a.y,j.z=a.z,j.normalize(),m},accept:function(a){(b.modified||i.modified||j.modified)&&(h(b,i,j,k),b.modified=!1,i.modified=!1,j.modified=!1),a.uniformMatrix4(l,!1,k)}};return m};return i});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/math/Vector1",["require","exports","../math/VectorN"],function(a,b,c){var d=function(a){function b(b,c){void 0===b&&(b=[0]),void 0===c&&(c=!1),a.call(this,b,c,1)}return f(b,a),Object.defineProperty(b.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.modified=this.modified||this.x!==a,this.data[0]=a},enumerable:!0,configurable:!0}),b.prototype.set=function(a){return this.x=a,this},b.prototype.setX=function(a){return this.x=a,this},b.prototype.copy=function(a){return this.x=a.x,this},b.prototype.add=function(a){return this.x+=a.x,this},b.prototype.addScalar=function(a){return this.x+=a,this},b.prototype.addVectors=function(a,b){return this.x=a.x+b.x,this},b.prototype.exp=function(){return this.x=Math.exp(this.x),this},b.prototype.sub=function(a){return this.x-=a.x,this},b.prototype.subScalar=function(a){return this.x-=a,this},b.prototype.subVectors=function(a,b){return this.x=a.x-b.x,this},b.prototype.multiply=function(a){return this.x*=a.x,this},b.prototype.multiplyScalar=function(a){return this.x*=a,this},b.prototype.divide=function(a){return this.x/=a.x,this},b.prototype.divideScalar=function(a){if(0!==a){var b=1/a;this.x*=b}else this.x=0;return this},b.prototype.min=function(a){return this.x>a.x&&(this.x=a.x),this},b.prototype.max=function(a){return this.x<a.x&&(this.x=a.x),this},b.prototype.floor=function(){return this.x=Math.floor(this.x),this},b.prototype.ceil=function(){return this.x=Math.ceil(this.x),this},b.prototype.round=function(){return this.x=Math.round(this.x),this},b.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this},b.prototype.negate=function(){return this.x=-this.x,this},b.prototype.distanceTo=function(a){return Math.sqrt(this.quadranceTo(a))},b.prototype.dot=function(a){return this.x*a.x},b.prototype.magnitude=function(){return Math.sqrt(this.quaditude())},b.prototype.normalize=function(){return this.divideScalar(this.magnitude())},b.prototype.quaditude=function(){return this.x*this.x},b.prototype.quadranceTo=function(a){var b=this.x-a.x;return b*b},b.prototype.setMagnitude=function(a){var b=this.magnitude();return 0!==b&&a!==b&&this.multiplyScalar(a/b),this},b.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this},b.prototype.lerpVectors=function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a),this},b.prototype.equals=function(a){return a.x===this.x},b.prototype.fromArray=function(a,b){return void 0===b&&(b=0),this.x=a[b],this},b.prototype.toArray=function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a},b.prototype.fromAttribute=function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this},b.prototype.clone=function(){return new b([this.x])},b}(c);return d}),b("davinci-eight/cameras/frustum",["require","exports","davinci-eight/cameras/view","davinci-eight/math/Matrix4","../math/Vector1"],function(a,b,c,d,e){var f=function(a,b){function f(){n.frustum(h.x,i.x,j.x,k.x,l.x,m.x)}var g=c(a),h=new e,i=new e,j=new e,k=new e,l=new e,m=new e,n=d.identity();f();var o={get eye(){return g.eye},set eye(a){g.eye=a},setEye:function(a){return g.setEye(a),o},get look(){return g.look},set look(a){g.look=a},setLook:function(a){return g.setLook(a),o},get up(){return g.up},set up(a){g.setUp(a)},setUp:function(a){return g.setUp(a),o},get left(){return h.x},set left(a){h.x=a,f()},get right(){return i.x},set right(a){i.x=a,f()},get bottom(){return j.x},set bottom(a){j.x=a,f()},get top(){return k.x},set top(a){k.x=a,f()},get near(){return l.x},set near(a){l.x=a,f()},get far(){return m.x},set far(a){m.x=a,f()},accept:function(a){a.uniformMatrix4(b,!1,n),g.accept(a)}};return o};return f}),b("davinci-eight/cameras/frustumMatrix",["require","exports","../checks/expectArg","../checks/isDefined"],function(a,b,c,d){function e(a,b,e,f,g,h,i){c("left",a).toBeNumber(),c("right",b).toBeNumber(),c("bottom",e).toBeNumber(),c("top",f).toBeNumber(),c("near",g).toBeNumber(),c("far",h).toBeNumber();var j=d(i)?i:new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);c("m",j).toSatisfy(16===j.length,"elements must have length 16");var k=2*g/(b-a),l=2*g/(f-e),m=(b+a)/(b-a),n=(f+e)/(f-e),o=-(h+g)/(h-g),p=-2*h*g/(h-g);return j[0]=k,j[4]=0,j[8]=m,j[12]=0,j[1]=0,j[5]=l,j[9]=n,j[13]=0,j[2]=0,j[6]=0,j[10]=o,j[14]=p,j[3]=0,j[7]=0,j[11]=-1,j[15]=0,j}return e}),b("davinci-eight/cameras/perspectiveArray",["require","exports","../cameras/frustumMatrix","../checks/expectArg"],function(a,b,c,d){function e(a,b,e,f,g){d("fov",a).toBeNumber(),d("aspect",b).toBeNumber(),d("near",e).toBeNumber(),d("far",f).toBeNumber();var h=e*Math.tan(.5*a),i=-h,j=i*b,k=h*b;return c(j,k,i,h,e,f,g)}return e}),b("davinci-eight/cameras/perspectiveMatrix",["require","exports","../checks/isDefined","../math/Matrix4","../cameras/perspectiveArray"],function(a,b,c,d,e){function f(a,b,f,g,h){var i=c(h)?h:d.identity();return e(a,b,f,g,i.data),i}return f}),b("davinci-eight/cameras/perspective",["require","exports","davinci-eight/cameras/view","davinci-eight/math/Matrix4","davinci-eight/core/Symbolic","../math/Vector1","../checks/isUndefined","../checks/expectArg","../cameras/perspectiveMatrix"],function(a,b,c,d,e,f,g,h,i){var j=function(a){a=a||{};var b=new f([g(a.fov)?75*Math.PI/180:a.fov]),j=new f([g(a.aspect)?1:a.aspect]),k=new f([g(a.near)?.1:a.near]),l=new f([h("options.far",g(a.far)?2e3:a.far).toBeNumber().value]),m=g(a.projectionMatrixName)?e.UNIFORM_PROJECTION_MATRIX:a.projectionMatrixName,n=c(a),o=d.identity(),p=!0,q={get eye(){return n.eye},set eye(a){n.eye=a},setEye:function(a){return n.setEye(a),q},get look(){return n.look},set look(a){n.look=a},setLook:function(a){return n.setLook(a),q},get up(){return n.up},set up(a){n.up=a},setUp:function(a){return n.setUp(a),q},get fov(){return b.x},set fov(a){q.setFov(a)},setFov:function(a){return h("fov",a).toBeNumber(),p=p||b.x!==a,b.x=a,q},get aspect(){return j.x},set aspect(a){q.setAspect(a)},setAspect:function(a){return h("aspect",a).toBeNumber(),p=p||j.x!==a,j.x=a,q},get near(){return k.x},set near(a){q.setNear(a)},setNear:function(a){return h("near",a).toBeNumber(),p=p||k.x!==a,k.x=a,q},get far(){return l.x},set far(a){q.setFar(a)},setFar:function(a){return h("far",a).toBeNumber(),p=p||l.x!==a,l.x=a,q},accept:function(a){p&&(i(b.x,j.x,k.x,l.x,o),p=!1),a.uniformMatrix4(m,!1,o),n.accept(a)}};return q};return j}),b("davinci-eight/core/AttribLocation",["require","exports","../checks/expectArg"],function(a,b,c){var d=function(){function a(a,b){this._enabled=void 0,this._monitor=c("monitor",a).toBeObject().value,this._name=c("name",b).toBeString().value}return Object.defineProperty(a.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),a.prototype.contextFree=function(){this.contextLoss()},a.prototype.contextGain=function(a,b){this.contextLoss(),this._index=a.getAttribLocation(b,this._name),this._context=a},a.prototype.contextLoss=function(){this._index=void 0,this._context=void 0,this._enabled=void 0},a.prototype.vertexPointer=function(a,b,c,d){void 0===b&&(b=!1),void 0===c&&(c=0),void 0===d&&(d=0),this._context.vertexAttribPointer(this._index,a,this._context.FLOAT,b,c,d)},a.prototype.enable=function(){this._monitor.mirror?this._enabled!==!0&&(this._context.enableVertexAttribArray(this._index),this._enabled=!0):this._context.enableVertexAttribArray(this._index)},a.prototype.disable=function(){this._enabled!==!1&&(this._context.disableVertexAttribArray(this._index),this._enabled=!1)},a.prototype.toString=function(){return["attribute",this._name].join(" ")},a}();return d}),b("davinci-eight/core/IdentityAttribProvider",["require","exports"],function(a,b){var c=function(){function a(){this._refCount=1}return a.prototype.draw=function(){},a.prototype.update=function(){},a.prototype.getAttribData=function(){var a={};return a},a.prototype.getAttribMeta=function(){var a={};return a},a.prototype.addRef=function(){return this._refCount++,this._refCount},a.prototype.release=function(){return this._refCount--,0===this._refCount,this._refCount},a.prototype.contextFree=function(){this._context=void 0},a.prototype.contextGain=function(a){this._context=a},a.prototype.contextLoss=function(){this._context=void 0},a}();return c});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/core/DefaultAttribProvider",["require","exports","../core/IdentityAttribProvider","../core/Symbolic"],function(a,b,c,d){var e=function(a){function b(){a.call(this)}return f(b,a),b.prototype.draw=function(){},b.prototype.update=function(){return a.prototype.update.call(this)},b.prototype.getAttribMeta=function(){var b=a.prototype.getAttribMeta.call(this);return b[d.ATTRIBUTE_POSITION]={glslType:"vec3",size:3},b},b}(c);return e}),b("davinci-eight/core/Color",["require","exports","../checks/expectArg"],function(a,b,c){var d=function(){function a(a){void 0===a&&(a=[0,0,0]),this.modified=!1,c("data",a).toSatisfy(3===a.length,"data must have length equal to 3"),this.data=a}return Object.defineProperty(a.prototype,"r",{get:function(){return this.data[0]},set:function(a){this.data[0]=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"g",{get:function(){return this.data[1]},set:function(a){this.data[1]=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"b",{get:function(){return this.data[2]},set:function(a){this.data[2]=a},enumerable:!0,configurable:!0}),a.prototype.clone=function(){return new a([this.data[0],this.data[1],this.data[2]])},a.prototype.luminance=function(){return a.luminance(this.r,this.g,this.b)},a.prototype.toString=function(){return"Color("+this.r+", "+this.g+", "+this.b+")"},a.luminance=function(a,b,c){var d=2.2;return.2126*Math.pow(a,d)+.7152*Math.pow(b,d)+.0722*Math.pow(c,d)},a.fromHSL=function(b,c,d){function e(a){return a>2*Math.PI?e(a-2*Math.PI):0>a?e(a+2*Math.PI):a}function f(b,c,e){var f=(a.luminance(b,c,e),d-.5*g);return new a([b+f,c+f,e+f])}var g=(1-Math.abs(2*d-1))*c,h=e(b)/Math.PI*3%6,i=g*(1-Math.abs(h%2-1));return h>=0&&1>h?f(g,i,0):h>=1&&2>h?f(i,g,0):h>=2&&3>h?f(0,g,g*(h-2)):h>=3&&4>h?f(0,g*(4-h),g):h>=4&&5>h?f(i,0,g):h>=5&&6>h?f(g,0,i):f(0,0,0)},a.fromRGB=function(b,d,e){return c("red",b).toBeNumber().toBeInClosedInterval(0,1),c("green",d).toBeNumber().toBeInClosedInterval(0,1),c("blue",e).toBeNumber().toBeInClosedInterval(0,1),new a([b,d,e])},a.copy=function(b){return new a([b.r,b.g,b.b])},a}();return d}),b("davinci-eight/core",["require","exports"],function(a,b){var c={VERSION:"2.86.0"};return c}),b("davinci-eight/core/DrawMode",["require","exports"],function(a,b){var c;return function(a){a[a.POINTS=0]="POINTS",a[a.LINES=1]="LINES",a[a.TRIANGLES=2]="TRIANGLES"}(c||(c={})),c}),b("davinci-eight/core/Face3",["require","exports","../math/Vector3","../core/Color"],function(a,b,c,d){var e=function(){function a(a,b,e,f){void 0===f&&(f=[]),this.normal=new c,this.color=new d,this.a=a,this.b=b,this.c=e,this.vertexNormals=f}return a.prototype.clone=function(){var b=new a(this.a,this.b,this.c);b.normal=c.copy(this.normal),b.color=d.copy(this.color),b.materialIndex=this.materialIndex;for(var e=0,f=this.vertexNormals.length;f>e;e++)b.vertexNormals[e]=c.copy(this.vertexNormals[e]);
for(var e=0,f=this.vertexColors.length;f>e;e++)b.vertexColors[e]=d.copy(this.vertexColors[e]);for(var e=0,f=this.vertexTangents.length;f>e;e++)b.vertexTangents[e]=c.copy(this.vertexTangents[e]);return b},a}();return e}),b("davinci-eight/objects/primitive",["require","exports","../checks/isDefined"],function(a,b,c){var d=function(a,b,d){var e,f=1;a.addRef(),b.addRef();var g={get mesh(){return a},get program(){return b},get model(){return d},addRef:function(){return f++,f},release:function(){return f--,0===f&&(a.release(),a=void 0,b.release(),b=void 0),f},contextFree:function(){c(e)&&(e=void 0,a.contextFree(),b.contextFree())},contextGain:function(c){e!==c&&(e=c,a.contextGain(c),b.contextGain(c))},contextLoss:function(){c(e)&&(e=void 0,a.contextLoss(),b.contextLoss())},accept:function(c){c.primitive(a,b,d)}};return g};return d}),b("davinci-eight/core/UniformLocation",["require","exports","../checks/expectArg"],function(a,b,c){function d(a,b){return a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[3]!==b[3]||a[4]!==b[4]||a[5]!==b[5]||a[6]!==b[6]||a[7]!==b[7]||a[8]!==b[8]||a[9]!==b[9]||a[10]!==b[10]||a[11]!==b[11]||a[12]!==b[12]||a[13]!==b[13]||a[14]!==b[14]||a[15]!==b[15]}var e=function(){function a(a,b){this._x=void 0,this._y=void 0,this._z=void 0,this._w=void 0,this._matrix4=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(){return void 0}),this._transpose=void 0,this._monitor=c("monitor",a).toBeObject().value,this._name=c("name",b).toBeString().value}return a.prototype.contextFree=function(){this.contextLoss()},a.prototype.contextGain=function(a,b){this.contextLoss(),this._context=a,this._location=a.getUniformLocation(b,this._name),this._program=b},a.prototype.contextLoss=function(){this._context=void 0,this._location=void 0,this._program=void 0,this._x=void 0,this._y=void 0,this._z=void 0,this._w=void 0,this._matrix4.map(function(){return void 0}),this._transpose=void 0},a.prototype.uniform1f=function(a){this._context.useProgram(this._program),this._monitor.mirror?this._x!==a&&(this._context.uniform1f(this._location,a),this._x=a):(this._context.uniform1f(this._location,a),this._x=void 0)},a.prototype.uniform2f=function(a,b){return this._context.useProgram(this._program),this._context.uniform2f(this._location,a,b)},a.prototype.uniform3f=function(a,b,c){return this._context.useProgram(this._program),this._context.uniform3f(this._location,a,b,c)},a.prototype.uniform4f=function(a,b,c,d){return this._context.useProgram(this._program),this._context.uniform4f(this._location,a,b,c,d)},a.prototype.matrix1=function(a,b){return this._context.useProgram(this._program),this._context.uniform1fv(this._location,b.data)},a.prototype.matrix2=function(a,b){return this._context.useProgram(this._program),this._context.uniformMatrix2fv(this._location,a,b.data)},a.prototype.matrix3=function(a,b){return this._context.useProgram(this._program),this._context.uniformMatrix3fv(this._location,a,b.data)},a.prototype.matrix4=function(a,b){this._context.useProgram(this._program);var c=this._matrix4,e=b.data;(d(c,e)||this._transpose!=a)&&(this._context.uniformMatrix4fv(this._location,a,e),c[0]=e[0],c[1]=e[1],c[2]=e[2],c[3]=e[3],c[4]=e[4],c[5]=e[5],c[6]=e[6],c[7]=e[7],c[8]=e[8],c[9]=e[9],c[10]=e[10],c[11]=e[11],c[12]=e[12],c[13]=e[13],c[14]=e[14],c[15]=e[15],this._transpose=a)},a.prototype.vector1=function(a){return this._context.useProgram(this._program),this._context.uniform1fv(this._location,a.data)},a.prototype.vector2=function(a){return this._context.useProgram(this._program),this._context.uniform2fv(this._location,a.data)},a.prototype.vector3=function(a){this._context.useProgram(this._program);var b=a.data,c=b[0],d=b[1],e=b[2];(this._x!==c||this._y!==d||this._z!==e)&&(this._context.uniform3fv(this._location,b),this._x=c,this._y=d,this._z=e)},a.prototype.vector4=function(a){return this._context.useProgram(this._program),this._context.uniform4fv(this._location,a.data)},a.prototype.toString=function(){return["uniform",this._name].join(" ")},a}();return e}),b("davinci-eight/curves/Curve",["require","exports"],function(a,b){var c=function(){function a(){}return a.prototype.getPoint=function(a){throw new Error("Curve.getPoint() not implemented!")},a.prototype.getPointAt=function(a){var b=this.getUtoTmapping(a);return this.getPoint(b)},a.prototype.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;a>=b;b++)c.push(this.getPoint(b/a));return c},a.prototype.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;a>=b;b++)c.push(this.getPointAt(b/a));return c},a.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]},a.prototype.getLengths=function(a){if(a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b,c,d=[],e=this.getPoint(0),f=0;for(d.push(0),c=1;a>=c;c++)b=this.getPoint(c/a),f+=b.distanceTo(e),d.push(f),e=b;return this.cacheArcLengths=d,d},a.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},a.prototype.getUtoTmapping=function(a,b){var c,d=this.getLengths(),e=0,f=d.length;c=b?b:a*d[f-1];for(var g,h=0,i=f-1;i>=h;)if(e=Math.floor(h+(i-h)/2),g=d[e]-c,0>g)h=e+1;else{if(!(g>0)){i=e;break}i=e-1}if(e=i,d[e]==c){var j=e/(f-1);return j}var k=d[e],l=d[e+1],m=l-k,n=(c-k)/m,j=(e+n)/(f-1);return j},a.prototype.getTangent=function(a){var b=1e-4,c=a-b,d=a+b;0>c&&(c=0),d>1&&(d=1);var e=this.getPoint(c),f=this.getPoint(d),g=f.clone().sub(e);return g.normalize()},a.prototype.getTangentAt=function(a){var b=this.getUtoTmapping(a);return this.getTangent(b)},a}();return c}),b("davinci-eight/dfx/Elements",["require","exports","../checks/expectArg","../math/VectorN"],function(a,b,c,d){var e=function(){function a(a,b){this.attributes={},c("indices",a).toBeObject().toSatisfy(a instanceof d,"indices must be a VectorN<number>"),c("attributes",b).toBeObject(),this.indices=a,this.attributes=b}return a}();return e}),b("davinci-eight/dfx/Vertex",["require","exports","../checks/expectArg"],function(a,b,c){function d(a,b){return b?a+b.toString():a}function e(a){var b=a.attributes,c=Object.keys(b).map(function(a){var c=b[a];return d(a,c)}).join(" ");return d("P",a.position)+c}var f=function(){function a(a){this.attributes={},c("position",a).toBeObject(),this.position=a}return a.prototype.toString=function(){return e(this)},a}();return f}),b("davinci-eight/dfx/Simplex",["require","exports","../checks/expectArg","../dfx/Vertex","../math/VectorN"],function(a,b,c,d,e){function f(a,b){return c(a,b).toSatisfy(b instanceof e,a+" must be a VectorN").value}function g(a,b,d,e){void 0===e&&(e=[]),c("b",b).toSatisfy(a.length===b.length,"a must be the same length as b");var f,g=a.length,h=1-d;for(f=0;g>f;f++)e.push(h*a[f]+d*b[f]);return e}var h=function(){function a(a){this.vertices=[],this.vertices=a.map(function(a,b){return new d(f("point",a))});var b=this;this.vertices.forEach(function(a){a.parent=b})}return a.indices=function(a){return a.vertices.map(function(a){return a.index})},a.subdivideOne=function(b){c("simplex",b).toBeObject();var d=new Array,f=b.vertices,h=f.length;if(3===h){var i=f[0].position,j=f[1].position,k=f[2].position,l=new e(g(i.data,j.data,.5)),m=new e(g(j.data,k.data,.5)),n=new e(g(k.data,i.data,.5)),o=new a([k,n,m]),p=new a([i,l,n]),q=new a([j,m,l]),r=new a([l,m,n]);d.push(o),d.push(p),d.push(q),d.push(r)}else if(2===h){var i=f[0].position,j=f[1].position,s=new e(g(i.data,j.data,.5)),t=new a([i,s]),u=new a([s,j]);d.push(t),d.push(u)}else if(1===h)d.push(b);else{if(0!==h)throw new Error(h+"-simplex is not supported");d.push(b)}return d},a.subdivide=function(b){return b.map(a.subdivideOne).reduce(function(a,b){return a.concat(b)},[])},a}();return h}),b("davinci-eight/dfx/computeFaceNormals",["require","exports","../checks/expectArg","../core/Symbolic","../math/Vector3"],function(a,b,c,d,e){function f(a){c("simplex",a).toBeObject(),c("name",name).toBeString();var b=a.vertices[0],f=a.vertices[1],g=a.vertices[2],h=new e(b.position.data),i=new e(f.position.data),j=new e(g.position.data),k=(new e).subVectors(j,i),l=(new e).subVectors(h,i),m=(new e).crossVectors(k,l).normalize();b.attributes[d.ATTRIBUTE_NORMAL]=m,f.attributes[d.ATTRIBUTE_NORMAL]=m,g.attributes[d.ATTRIBUTE_NORMAL]=m}return f}),b("davinci-eight/dfx/quad",["require","exports","../dfx/computeFaceNormals","../checks/expectArg","../dfx/Simplex","../core/Symbolic"],function(a,b,c,d,e,f){function g(a,b){d("vecs",a).toBeObject().toSatisfy(4===a.length,""),d("coords",b).toBeObject().toSatisfy(4===b.length,"");var g=new Array,h=new e([a[0],a[1],a[2]]);c(h),h.vertices[0].attributes[f.ATTRIBUTE_TEXTURE]=b[0],h.vertices[1].attributes[f.ATTRIBUTE_TEXTURE]=b[1],h.vertices[2].attributes[f.ATTRIBUTE_TEXTURE]=b[2],g.push(h);var i=new e([a[0],a[2],a[3]]);return c(i),i.vertices[0].attributes[f.ATTRIBUTE_TEXTURE]=h.vertices[0].attributes[f.ATTRIBUTE_TEXTURE],i.vertices[1].attributes[f.ATTRIBUTE_TEXTURE]=h.vertices[2].attributes[f.ATTRIBUTE_TEXTURE],i.vertices[2].attributes[f.ATTRIBUTE_TEXTURE]=b[3],g.push(i),g}return g});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/math/Vector2",["require","exports","../math/VectorN"],function(a,b,c){var d=function(a){function b(b,c){void 0===b&&(b=[0,0]),void 0===c&&(c=!1),a.call(this,b,c,2)}return f(b,a),Object.defineProperty(b.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.modified=this.modified||this.x!==a,this.data[0]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"y",{get:function(){return this.data[1]},set:function(a){this.modified=this.modified||this.y!==a,this.data[1]=a},enumerable:!0,configurable:!0}),b.prototype.set=function(a,b){return this.x=a,this.y=b,this},b.prototype.setX=function(a){return this.x=a,this},b.prototype.setY=function(a){return this.y=a,this},b.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this},b.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},b.prototype.addScalar=function(a){return this.x+=a,this.y+=a,this},b.prototype.addVectors=function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},b.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},b.prototype.subScalar=function(a){return this.x-=a,this.y-=a,this},b.prototype.subVectors=function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},b.prototype.multiply=function(a){return this.x*=a.x,this.y*=a.y,this},b.prototype.multiplyScalar=function(a){return this.x*=a,this.y*=a,this},b.prototype.divide=function(a){return this.x/=a.x,this.y/=a.y,this},b.prototype.divideScalar=function(a){if(0!==a){var b=1/a;this.x*=b,this.y*=b}else this.x=0,this.y=0;return this},b.prototype.min=function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this},b.prototype.max=function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this},b.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},b.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},b.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},b.prototype.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},b.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},b.prototype.distanceTo=function(a){return Math.sqrt(this.quadranceTo(a))},b.prototype.dot=function(a){return this.x*a.x+this.y*a.y},b.prototype.magnitude=function(){return Math.sqrt(this.quaditude())},b.prototype.normalize=function(){return this.divideScalar(this.magnitude())},b.prototype.quaditude=function(){return this.x*this.x+this.y*this.y},b.prototype.quadranceTo=function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},b.prototype.setMagnitude=function(a){var b=this.magnitude();return 0!==b&&a!==b&&this.multiplyScalar(a/b),this},b.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},b.prototype.lerpVectors=function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a),this},b.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},b.prototype.fromArray=function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this},b.prototype.fromAttribute=function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this.y=a.array[b+1],this},b.prototype.clone=function(){return new b([this.x,this.y])},b}(c);return d}),b("davinci-eight/dfx/cube",["require","exports","../dfx/quad","../math/Vector2","../math/Vector3"],function(a,b,c,d,e){function f(){var a=new e([1,1,1]),b=new e([-1,1,1]),f=new e([-1,-1,1]),g=new e([1,-1,1]),h=new e([1,-1,-1]),i=new e([1,1,-1]),j=new e([-1,1,-1]),k=new e([-1,-1,-1]),l=new d([0,0]),m=new d([0,1]),n=new d([1,0]),o=new d([1,1]),p=[o,m,l,n],q=c([a,b,f,g],p),r=c([a,g,h,i],p),s=c([a,i,j,b],p),t=c([b,j,k,f],p),u=c([k,h,g,f],p),v=c([h,k,j,i],p),w=[q,r,s,t,u,v];return w.reduce(function(a,b){return a.concat(b)},[])}return f}),b("davinci-eight/dfx/square",["require","exports","../dfx/quad","../math/Vector2","../math/Vector3"],function(a,b,c,d,e){function f(){var a=new e([1,1,0]),b=new e([-1,1,0]),f=new e([-1,-1,0]),g=new e([1,-1,0]),h=new d([0,0]),i=new d([0,1]),j=new d([1,0]),k=new d([1,1]),l=[k,i,h,j];return c([a,b,f,g],l)}return f}),b("davinci-eight/dfx/ElementsAttribute",["require","exports"],function(a,b){var c=function(){function a(a,b){this.vector=a,this.size=b}return a}();return c}),b("davinci-eight/dfx/uniqueVertices",["require","exports"],function(a,b){function c(a){function b(a){var b=a.toString();if(c[b]){var e=c[b];a.index=e.index}else a.index=d.length,d.push(a),c[b]=a}var c={},d=[];return a.forEach(function(a){a.vertices.forEach(function(a){b(a)})}),d}return c}),b("davinci-eight/dfx/triangles",["require","exports","../dfx/Elements","../dfx/ElementsAttribute","../checks/expectArg","../dfx/Simplex","../core/Symbolic","../dfx/uniqueVertices","../math/VectorN"],function(a,b,c,d,e,f,g,h,i){function j(a,b){for(var c=[],d=0;a>d;d++)c.push(b);return c}function k(a,b){e("name",a).toBeString(),e("attribMap",b).toBeObject();var c=b[a];if(c){var d=c.name;return d?d:a}throw new Error("Unable to compute name; missing attribute specification for "+a)}function l(a,b){e("key",a).toBeString(),e("attribMap",b).toBeObject();var c=b[a];if(c){var d=c.size;return e("size",d).toBeNumber(),c.size}throw new Error("Unable to compute size; missing attribute specification for "+a)}function m(a,b){return a.concat(b)}function n(){return"missing specification for "+g.ATTRIBUTE_POSITION}function o(a,b){e("faces",a).toBeObject(),e("attribMap",b).toBeObject();var o=h(a),p={};Object.keys(b).forEach(function(a){p[a]=j(o.length*l(a,b),void 0)});var q=p[g.ATTRIBUTE_POSITION];e(g.ATTRIBUTE_POSITION,q).toBeObject(n);var r=a.map(f.indices).reduce(m,[]);o.forEach(function(a){var c=a.position,d=a.index;c.toArray(q,d*l(g.ATTRIBUTE_POSITION,b)),Object.keys(b).forEach(function(c){var e=p[c],f=a.attributes[c];f&&a.attributes[c].toArray(e,d*l(c,b))})});var s={};return Object.keys(b).forEach(function(a){var c=(p[a],p[a]),e=new i(c,!1,c.length);s[k(a,b)]=new d(e,l(a,b))}),new c(new i(r,!1,r.length),s)}return o}),b("davinci-eight/drawLists/scene",["require","exports","../checks/expectArg","../checks/isDefined"],function(a,b,c,d){var e=function(){function a(a){this.drawables=[],this.program=a}return a}(),f=function(){function a(a){Object.keys(f).forEach(function(b){a(f[b].program)})}var b,f={},g=1,h={addRef:function(){return g++,g},release:function(){return g--,0===g&&h.traverse(function(a){a.release()}),g},contextFree:function(){h.traverse(function(a){a.contextFree()})},contextGain:function(a){b!==a&&(b=c("context",a).toSatisfy(a instanceof WebGLRenderingContext,"context must implement WebGLRenderingContext").value,Object.keys(f).forEach(function(b){f[b].drawables.forEach(function(b){b.contextGain(a);var c=b.program;c.programId})}))},contextLoss:function(){d(b)&&(b=void 0,Object.keys(f).forEach(function(a){f[a].drawables.forEach(function(a){a.contextLoss()})}))},add:function(a){a.addRef();var c=a.program,d=c.programId;f[d]||(f[d]=new e(c)),f[d].drawables.push(a),b&&(c.contextGain(b),a.contextGain(b))},remove:function(a){var b=a.program,c=b.programId;if(!f[c])throw new Error("drawable not found.");var d=new e(b),g=d.drawables.indexOf(a);g>=0&&(d.drawables.splice(g,1),0===d.drawables.length&&delete f[c])},uniform1f:function(b,c){a(function(a){a.use(),a.uniform1f(b,c)})},uniform2f:function(b,c,d){a(function(a){a.use(),a.uniform2f(b,c,d)})},uniform3f:function(b,c,d,e){a(function(a){a.use(),a.uniform3f(b,c,d,e)})},uniform4f:function(b,c,d,e,f){a(function(a){a.use(),a.uniform4f(b,c,d,e,f)})},uniformMatrix1:function(b,c,d){a(function(a){a.use(),a.uniformMatrix1(b,c,d)})},uniformMatrix2:function(b,c,d){a(function(a){a.use(),a.uniformMatrix2(b,c,d)})},uniformMatrix3:function(b,c,d){a(function(a){a.use(),a.uniformMatrix3(b,c,d)})},uniformMatrix4:function(b,c,d){a(function(a){a.use(),a.uniformMatrix4(b,c,d)})},uniformVector1:function(b,c){a(function(a){a.use(),a.uniformVector1(b,c)})},uniformVector2:function(b,c){a(function(a){a.use(),a.uniformVector2(b,c)})},uniformVector3:function(b,c){a(function(a){a.use(),a.uniformVector3(b,c)})},uniformVector4:function(b,c){a(function(a){a.use(),a.uniformVector4(b,c)})},traverse:function(a){Object.keys(f).forEach(function(b){f[b].drawables.forEach(a)})}};return h};return f}),b("davinci-eight/math/Sphere",["require","exports"],function(a,b){var c=function(){function a(a,b){this.center=void 0!==a?a:{x:0,y:0,z:0},this.radius=void 0!==b?b:0}return a.prototype.setFromPoints=function(a){throw new Error("Not Implemented: Sphere.setFromPoints")},a}();return c}),b("davinci-eight/geometries/Geometry3",["require","exports","../math/Sphere","../math/Vector3"],function(a,b,c,d){function e(a,b){a.vertexNormals=[];var c=b[a.a],e=b[a.b],f=b[a.c],g=(new d).subVectors(f,e),h=(new d).subVectors(c,e),i=(new d).crossVectors(g,h).normalize();a.vertexNormals.push(i),a.vertexNormals.push(i),a.vertexNormals.push(i)}var f=function(){function a(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]],this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.boundingSphere=new c({x:0,y:0,z:0},1/0)}return a.prototype.computeBoundingSphere=function(){this.boundingSphere.setFromPoints(this.vertices)},a.prototype.computeFaceNormals=function(){var a=this.vertices,b=function(b){return e(b,a)};this.faces.forEach(b)},a.prototype.computeVertexNormals=function(a){var b,c,e,f,g=this.vertices.length,h=new Array(this.vertices.length);for(b=0,g=this.vertices.length;g>b;b++)h[b]=new d;if(a){var i,j,k,l=new d,m=new d;for(c=0,e=this.faces.length;e>c;c++)f=this.faces[c],i=this.vertices[f.a],j=this.vertices[f.b],k=this.vertices[f.c],l.subVectors(k,j),m.subVectors(i,j),l.cross(m),h[f.a].add(l),h[f.b].add(l),h[f.c].add(l)}else for(c=0,e=this.faces.length;e>c;c++)f=this.faces[c],h[f.a].add(f.vertexNormals[0]),h[f.b].add(f.vertexNormals[0]),h[f.c].add(f.vertexNormals[0]);for(b=0,g=this.vertices.length;g>b;b++)h[b].normalize();for(c=0,e=this.faces.length;e>c;c++)f=this.faces[c],f.vertexNormals[0]=h[f.a].clone(),f.vertexNormals[1]=h[f.b].clone(),f.vertexNormals[2]=h[f.c].clone()},a.prototype.mergeVertices=function(a){void 0===a&&(a=4);var b,c,d,e,f,g={},h=[],i=[],j=Math.pow(10,a);for(b=0,c=this.vertices.length;c>b;b++){var k=this.vertices[b],l=Math.round(k.x*j)+"_"+Math.round(k.y*j)+"_"+Math.round(k.z*j);void 0===g[l]?(g[l]=b,h.push(this.vertices[b]),i[b]=h.length-1):i[b]=i[g[l]]}var m=[];for(b=0,c=this.faces.length;c>b;b++){var n=this.faces[b];n.a=i[n.a],n.b=i[n.b],n.c=i[n.c],d=[n.a,n.b,n.c];for(var o=-1,p=0;3>p;p++)if(d[p]==d[(p+1)%3]){o=p,m.push(b);break}}for(b=m.length-1;b>=0;b--){var q=m[b];for(this.faces.splice(q,1),e=0,f=this.faceVertexUvs.length;f>e;e++)this.faceVertexUvs[e].splice(q,1)}var r=this.vertices.length-h.length;return this.vertices=h,r},a}();return f}),b("davinci-eight/core/Line3",["require","exports"],function(a,b){var c=function(){function a(a,b){this.a=a,this.b=b}return a}();return c}),b("davinci-eight/core/Point3",["require","exports"],function(a,b){var c=function(){function a(a){this.a=a}return a}();return c}),b("davinci-eight/utils/refChange",["require","exports"],function(a,b){function c(){var a=Object.keys(f);a.forEach(function(a){var b=f[a];0===b.refCount&&delete f[a]})}function d(){g&&console.warn("Nothing to see because skip mode is "+g),c(),console.log(JSON.stringify(f,null,2))}function e(a,b,c){if(0===b||!g)if(h&&(i?c===i&&console.log(b+" on "+a+" @ "+c):console.log(b+" on "+a+" @ "+c)),1===b){var e=f[a];e||(e={refCount:0,name:c,zombie:!1},f[a]=e),e.refCount+=b}else if(-1===b){var e=f[a];e.refCount+=b,0===e.refCount&&(e.zombie=!0)}else{if(0!==b)throw new Error("change must be +1 or -1 for normal recording, or 0 for logging to the console.");var j=""+a+" @ "+c;if(console.log(j),"dump"===a)d();else if("reset"===a)f={},g=!1,h=!1;else if("skip"===a)f={},g=!0,h=!1,i=void 0;else{if("trace"!==a)throw new Error("Unexpected command "+j);g=!1,h=!0,i=c}}}var f={},g=!0,h=!1,i=void 0;return e}),b("davinci-eight/utils/uuid4",["require","exports"],function(a,b){function c(){var a=function(a){return Math.pow(2,a)},b=(a(4),a(6)),c=a(8),d=a(12),e=(a(14),a(16)),f=a(32),g=(a(40),a(48),function(a,b){return Math.floor(Math.random()*(b-a+1))+a}),h=function(){return g(0,b-1)},i=function(){return g(0,c-1)},j=function(){return g(0,d-1)},k=function(){return g(0,e-1)},l=function(){return g(0,f-1)},m=function(){return(0|Math.random()*(1<<30))+(0|Math.random()*(1<<18))*(1<<30)},n=function(a,b,c){a=String(a),c=c?c:"0";for(var d=b-a.length;d>0;d>>>=1,c+=c)1&d&&(a=c+a);return a},o=function(a,b,c,d,e,f){var g=n(a.toString(16),8)+"-"+n(b.toString(16),4)+"-"+n(c.toString(16),4)+"-"+n(d.toString(16),2)+n(e.toString(16),2)+"-"+n(f.toString(16),12);return g};return{generate:function(){return o(l(),k(),16384|j(),128|h(),i(),m())},validate:function(a){var b=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return b.test(a)}}}return c}),b("davinci-eight/core/ArrayBuffer",["require","exports","../checks/expectArg","../utils/refChange","../utils/uuid4"],function(a,b,c,d,e){var f=function(){function a(a){this._refCount=1,this._uuid=e().generate(),this._monitor=c("montor",a).toBeObject().value,d(this._uuid,1,"ArrayBuffer")}return a.prototype.addRef=function(){return d(this._uuid,1,"ArrayBuffer"),this._refCount++,this._refCount},a.prototype.release=function(){return d(this._uuid,-1,"ArrayBuffer"),this._refCount--,0===this._refCount&&this.contextFree(),this._refCount},a.prototype.contextFree=function(){this._buffer&&(this._context.deleteBuffer(this._buffer),this._buffer=void 0),this._context=void 0},a.prototype.contextGain=function(a){this._context!==a&&(this.contextFree(),this._context=a,this._buffer=a.createBuffer())},a.prototype.contextLoss=function(){this._buffer=void 0,this._context=void 0},a.prototype.bind=function(a){this._context?this._context.bindBuffer(a,this._buffer):console.warn("ArrayBuffer.bind() missing WebGLRenderingContext.")},a.prototype.unbind=function(a){this._context?this._context.bindBuffer(a,null):console.warn("ArrayBuffer.unbind() missing WebGLRenderingContext.")},a}();return f}),b("davinci-eight/core/ElementBuffer",["require","exports","../checks/isDefined"],function(a,b,c){var d=function(){function a(){this._refCount=0}return a.prototype.addRef=function(){this._refCount++},a.prototype.release=function(){this._refCount--,0===this._refCount&&this.contextFree()},a.prototype.contextFree=function(){this._buffer&&(this._context.deleteBuffer(this._buffer),this._buffer=void 0),this._context=void 0},a.prototype.contextGain=function(a){this._context!==a&&(this.contextFree(),this._context=a,this._buffer=a.createBuffer())},a.prototype.contextLoss=function(){this._buffer=void 0,this._context=void 0},a.prototype.bind=function(){this._context?this._context.bindBuffer(this._context.ELEMENT_ARRAY_BUFFER,this._buffer):console.warn("ElementBuffer.bind() missing WebGLRenderingContext")},a.prototype.data=function(a,b){this._context?(b=c(b)?b:this._context.STREAM_DRAW,this._context.bufferData(this._context.ELEMENT_ARRAY_BUFFER,a,b)):console.warn("ElementBuffer.data() missing WebGLRenderingContext")},a}();return d});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/GeometryAdapter",["require","exports","../checks/expectArg","../core/Line3","../core/Point3","../core/Symbolic","../core/DefaultAttribProvider","../core/DrawMode","../core/ArrayBuffer","../core/ElementBuffer"],function(a,b,c,d,e,g,h,i,j,k){function l(a,b,c,d,e){var f={};return f[a]={buffer:b,size:3},e===i.TRIANGLES&&(f[c]={buffer:d,size:3}),f}var m=function(a){function b(b,d,e){a.call(this),this.$drawMode=i.TRIANGLES,this.grayScale=!1,this.lines=[],this.points=[],c("monitor",b).toBeObject(),c("geometry",d).toBeObject(),e=e||{},e.drawMode="undefined"!=typeof e.drawMode?e.drawMode:i.TRIANGLES,this.indexBuffer=new k,this.indexBuffer.addRef(),this.positionVarName=e.positionVarName||g.ATTRIBUTE_POSITION,this.positionBuffer=new j(b),this.positionBuffer.addRef(),this.normalVarName=e.normalVarName||g.ATTRIBUTE_NORMAL,this.normalBuffer=new j(b),this.normalBuffer.addRef(),this.geometry=d,this.geometry.dynamic=!1,this.$drawMode=e.drawMode,this.elementsUsage=e.elementsUsage,this.attributeDataInfos=l(this.positionVarName,this.positionBuffer,this.normalVarName,this.normalBuffer,this.drawMode)}return f(b,a),b.prototype.addRef=function(){return this._refCount++,this._refCount},b.prototype.release=function(){return this._refCount--,0===this._refCount&&(this.indexBuffer.release(),this.indexBuffer=void 0,this.positionBuffer.release(),this.positionBuffer=void 0,this.normalBuffer.release(),this.normalBuffer=void 0),this._refCount},b.prototype.contextFree=function(){this.indexBuffer.contextFree(),this.positionBuffer.contextFree(),this.normalBuffer.contextFree(),a.prototype.contextFree.call(this)},b.prototype.contextGain=function(b){a.prototype.contextGain.call(this,b),this.elementsUsage="undefined"!=typeof this.elementsUsage?this.elementsUsage:b.STREAM_DRAW,this.indexBuffer.contextGain(b),this.positionBuffer.contextGain(b),this.normalBuffer.contextGain(b),this.update()},b.prototype.contextLoss=function(){this.indexBuffer.contextLoss(),this.positionBuffer.contextLoss(),this.normalBuffer.contextLoss(),a.prototype.contextLoss.call(this)},Object.defineProperty(b.prototype,"drawMode",{get:function(){return this.$drawMode},set:function(a){throw new Error("The drawMode property is readonly")},enumerable:!0,configurable:!0}),b.prototype.draw=function(){if(this._context)switch(this.drawMode){case i.POINTS:this._context.drawArrays(this._context.POINTS,0,1*this.points.length);break;case i.LINES:this._context.drawArrays(this._context.LINES,0,2*this.lines.length);break;case i.TRIANGLES:this._context.drawArrays(this._context.TRIANGLES,0,3*this.geometry.faces.length)}else console.warn("GeometryAdapter.draw() missing WebGLRenderingContext")},Object.defineProperty(b.prototype,"dynamic",{get:function(){return this.geometry.dynamic},enumerable:!0,configurable:!0}),b.prototype.getAttribData=function(){return this.attributeDataInfos},b.prototype.getAttribMeta=function(){var a={};return a[g.ATTRIBUTE_POSITION]={name:this.positionVarName,glslType:"vec3",size:3,normalized:!1,stride:0,offset:0},this.drawMode===i.TRIANGLES&&(a[g.ATTRIBUTE_NORMAL]={name:this.normalVarName,glslType:"vec3",size:3,normalized:!1,stride:0,offset:0}),a},b.prototype.update=function(){var a=[],b=[],c=[],d=this.geometry.vertices;switch(this.drawMode){case i.POINTS:this.points=[],this.computePoints(),this.points.forEach(function(b){c.push(b.a);var e=d[b.a];a.push(e.x),a.push(e.y),a.push(e.z)});break;case i.LINES:this.lines=[],this.computeLines(),this.lines.forEach(function(b){c.push(b.a),c.push(b.b);var e=d[b.a];a.push(e.x),a.push(e.y),a.push(e.z);var f=d[b.b];a.push(f.x),a.push(f.y),a.push(f.z)});break;case i.TRIANGLES:this.geometry.faces.forEach(function(e){c.push(e.a),c.push(e.b),c.push(e.c);var f=d[e.a];a.push(f.x),a.push(f.y),a.push(f.z);var g=d[e.b];a.push(g.x),a.push(g.y),a.push(g.z);var h=d[e.c];if(a.push(h.x),a.push(h.y),a.push(h.z),3===e.vertexNormals.length){var i=e.vertexNormals[0],j=e.vertexNormals[1],k=e.vertexNormals[2];b.push(i.x),b.push(i.y),b.push(i.z),b.push(j.x),b.push(j.y),b.push(j.z),b.push(k.x),b.push(k.y),b.push(k.z)}else if(1===e.vertexNormals.length){var l=e.vertexNormals[0];b.push(l.x),b.push(l.y),b.push(l.z),b.push(l.x),b.push(l.y),b.push(l.z),b.push(l.x),b.push(l.y),b.push(l.z)}})}this.elementArray=new Uint16Array(c),this.indexBuffer.bind(),this._context.bufferData(this._context.ELEMENT_ARRAY_BUFFER,this.elementArray,this._context.DYNAMIC_DRAW),this.aVertexPositionArray=new Float32Array(a),this.positionBuffer.bind(this._context.ARRAY_BUFFER),this._context.bufferData(this._context.ARRAY_BUFFER,this.aVertexPositionArray,this._context.DYNAMIC_DRAW),this.aVertexNormalArray=new Float32Array(b),this.normalBuffer.bind(this._context.ARRAY_BUFFER),this._context.bufferData(this._context.ARRAY_BUFFER,this.aVertexNormalArray,this._context.DYNAMIC_DRAW)},b.prototype.computeLines=function(){var a=this.lines;this.geometry.faces.forEach(function(b){a.push(new d(b.a,b.b)),a.push(new d(b.b,b.c)),a.push(new d(b.c,b.a))})},b.prototype.computePoints=function(){var a=this.points;this.geometry.faces.forEach(function(b){a.push(new e(b.a)),a.push(new e(b.b)),a.push(new e(b.c))})},b}(h);return m});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/math/Spinor3",["require","exports","../math/VectorN"],function(a,b,c){var d=function(a){function b(b,c){void 0===b&&(b=[0,0,0,1]),void 0===c&&(c=!1),a.call(this,b,c,4)}return f(b,a),Object.defineProperty(b.prototype,"yz",{get:function(){return this.data[0]},set:function(a){this.modified=this.modified||this.yz!==a,this.data[0]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"zx",{get:function(){return this.data[1]},set:function(a){this.modified=this.modified||this.zx!==a,this.data[1]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"xy",{get:function(){return this.data[2]},set:function(a){this.modified=this.modified||this.xy!==a,this.data[2]=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"w",{get:function(){return this.data[3]},set:function(a){this.modified=this.modified||this.w!==a,this.data[3]=a},enumerable:!0,configurable:!0}),b.prototype.add=function(a){return this},b.prototype.addVectors=function(a,b){return this},b.prototype.clone=function(){return new b([this.yz,this.zx,this.xy,this.w])},b.prototype.copy=function(a){return this.yz=a.yz,this.zx=a.zx,this.xy=a.xy,this.w=a.w,this},b.prototype.divideScalar=function(a){return this.yz/=a,this.zx/=a,this.xy/=a,this.w/=a,this},b.prototype.exp=function(){var a=this.w,b=this.yz,c=this.zx,d=this.xy,e=Math.exp(a),f=Math.sqrt(b*b+c*c+d*d),g=e*(0!==f?Math.sin(f)/f:1);return this.w=e*Math.cos(f),this.yz=b*g,this.zx=c*g,this.xy=d*g,this},b.prototype.lerp=function(a,b){return this.xy+=(a.xy-this.xy)*b,this.yz+=(a.yz-this.yz)*b,this.zx+=(a.zx-this.zx)*b,this.w+=(a.w-this.w)*b,this},b.prototype.magnitude=function(){return Math.sqrt(this.quaditude())},b.prototype.multiply=function(a){var b=this.w,c=this.yz,d=this.zx,e=this.xy,f=a.w,g=a.yz,h=a.zx,i=a.xy;return this.w=b*f-c*g-d*h-e*i,this.yz=b*g+c*f-d*i+e*h,this.zx=b*h+c*i+d*f-e*g,this.xy=b*i-c*h+d*g+e*f,this},b.prototype.multiplyScalar=function(a){return this.yz*=a,this.zx*=a,this.xy*=a,this.w*=a,this},b.prototype.quaditude=function(){var a=this.w,b=this.yz,c=this.zx,d=this.xy;return a*a+b*b+c*c+d*d},b.prototype.sub=function(a){return this},b.prototype.toString=function(){return"Spinor3({yz: "+this.yz+", zx: "+this.zx+", xy: "+this.xy+", w: "+this.w+"})";
},b}(c);return d});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/RevolutionGeometry",["require","exports","../core/Face3","../geometries/Geometry3","../math/Spinor3","../math/Vector2"],function(a,b,c,d,e,g){var h=function(a){function b(b,d,f,h,i,j){a.call(this),f=f||12,h=h||0,i=i||2*Math.PI;var k,l,m,n,o=Math.abs(2*Math.PI-Math.abs(i-h))<1e-4,p=o?f:f+1,q=1/f,r=(i-h)*q;for(k=0,m=p;m>k;k++){var s=h+k*r,t=s/2,u=Math.cos(t),v=Math.sin(t),w=new e([d.yz*v,d.zx*v,d.xy*v,u]);for(l=0,n=b.length;n>l;l++){var x=b[l].clone();x.applySpinor(w),j&&x.applySpinor(j),this.vertices.push(x)}}var y=1/(b.length-1),z=b.length,A=z*p;for(k=0,m=f;m>k;k++)for(l=0,n=b.length-1;n>l;l++){var B=l+z*k,C=B%A,D=(B+z)%A,E=(B+1+z)%A,F=(B+1)%A,G=k*q,H=l*y,I=G+q,J=H+y;this.faces.push(new c(F,D,C)),this.faceVertexUvs[0].push([new g([G,H]),new g([I,H]),new g([G,J])]),this.faces.push(new c(F,E,D)),this.faceVertexUvs[0].push([new g([I,H]),new g([I,J]),new g([G,J])])}this.computeFaceNormals(),this.computeVertexNormals()}return f(b,a),b}(d);return h});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/ArrowGeometry",["require","exports","../geometries/RevolutionGeometry","../math/Spinor3","../math/Vector3"],function(a,b,c,d,e){var g=function(a){function b(b,c,f,g,h,i,j,k){void 0===b&&(b=1),void 0===c&&(c=new d),void 0===f&&(f=12),void 0===g&&(g=1),void 0===h&&(h=.01),void 0===i&&(i=.08),void 0===j&&(j=.2),void 0===k&&(k=e.e3.clone()),b=b||1,c=c||new d,g=(g||1)*b,h=(h||.01)*b,i=(i||.08)*b,j=(j||.2)*b,k=k||e.e3.clone();var l=g-j,m=g/2,n=function(a){return a.x?2:a.y?1:0},o=function(a){return a.x>0?1:a.x<0?-1:a.y>0?1:a.y<0?-1:a.z>0?1:a.z<0?-1:0},p=function(a){var b=n(a),c=o(a),f=(b+0)%3,g=(b+1)%3,j=(b+2)%3,k=[[0,0,m*c],[i,0,(l-m)*c],[h,0,(l-m)*c],[h,0,-m*c],[0,0,-m*c]],p=k.map(function(a){return new e([a[f],a[g],a[j]])}),q=new d([a.x,a.y,a.z,0]);return{points:p,generator:q}},q=p(k);a.call(this,q.points,q.generator,f,0,2*Math.PI,c)}return f(b,a),b}(c);return g});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/BarnGeometry",["require","exports","../geometries/Geometry3","../core/Face3","../math/Vector3"],function(a,b,c,d,e){var g=function(a){function b(){function b(a,b,d){c.push(new e([a,b,d]))}a.call(this);var c=this.vertices;b(-.5,0,-1),this.vertices.push(new e([.5,0,-1])),this.vertices.push(new e([.5,1,-1])),this.vertices.push(new e([0,1.5,-1])),this.vertices.push(new e([-.5,1,-1])),this.vertices.push(new e([-.5,0,1])),this.vertices.push(new e([.5,0,1])),this.vertices.push(new e([.5,1,1])),this.vertices.push(new e([0,1.5,1])),this.vertices.push(new e([-.5,1,1])),this.faces.push(new d(1,0,2)),this.faces.push(new d(2,0,4)),this.faces.push(new d(2,4,3)),this.faces.push(new d(5,6,7)),this.faces.push(new d(5,7,9)),this.faces.push(new d(9,7,8)),this.faces.push(new d(6,1,2)),this.faces.push(new d(6,2,7)),this.faces.push(new d(9,0,5)),this.faces.push(new d(9,4,0)),this.faces.push(new d(8,3,4)),this.faces.push(new d(8,4,9)),this.faces.push(new d(7,2,3)),this.faces.push(new d(7,3,8)),this.faces.push(new d(5,0,1)),this.faces.push(new d(5,1,6)),this.computeFaceNormals()}return f(b,a),b}(c);return g});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/BoxGeometry",["require","exports","../core/Face3","../geometries/Geometry3","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g){var h=function(a){function b(b,d,f,h,i,j,k){function l(a,b,d,f,k,l,m,n,o){var p,q,r,s=h,t=i,u=k/2,v=l/2,w=o.vertices.length;"x"===a&&"y"===b||"y"===a&&"x"===b?p="z":"x"===a&&"z"===b||"z"===a&&"x"===b?(p="y",t=j):("z"===a&&"y"===b||"y"===a&&"z"===b)&&(p="x",s=j);var x=s+1,y=t+1,z=k/s,A=l/t,B=new g;for(B[p]=m>0?1:-1,r=0;y>r;r++)for(q=0;x>q;q++){var C=new g;C[a]=(q*z-u)*d,C[b]=(r*A-v)*f,C[p]=m,o.vertices.push(C)}for(r=0;t>r;r++)for(q=0;s>q;q++){var D=q+x*r,E=q+x*(r+1),F=q+1+x*(r+1),G=q+1+x*r,H=new e([q/s,1-r/t]),I=new e([q/s,1-(r+1)/t]),J=new e([(q+1)/s,1-(r+1)/t]),K=new e([(q+1)/s,1-r/t]),L=new c(D+w,E+w,G+w);L.vertexNormals.push(B),o.faces.push(L),o.faceVertexUvs[0].push([H,I,K]),L=new c(E+w,F+w,G+w),L.vertexNormals.push(B),o.faces.push(L),o.faceVertexUvs[0].push([I.clone(),J,K.clone()])}}void 0===b&&(b=1),void 0===d&&(d=1),void 0===f&&(f=1),void 0===h&&(h=1),void 0===i&&(i=1),void 0===j&&(j=1),void 0===k&&(k=!1),a.call(this);var m=b/2,n=d/2,o=f/2;l("z","y",-1,-1,f,d,+m,0,this),l("z","y",1,-1,f,d,-m,1,this),l("x","z",1,1,b,f,+n,2,this),l("x","z",1,-1,b,f,-n,3,this),l("x","y",1,-1,b,d,+o,4,this),l("x","y",-1,-1,b,d,-o,5,this),this.mergeVertices()}return f(b,a),b}(d);return h});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/CylinderGeometry",["require","exports","../core/Face3","../geometries/Geometry3","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g){var h=function(a){function b(b,d,f,h,i,j,k,l){void 0===b&&(b=1),void 0===d&&(d=1),void 0===f&&(f=1),void 0===h&&(h=16),void 0===i&&(i=1),void 0===j&&(j=!1),void 0===k&&(k=0),void 0===l&&(l=2*Math.PI),h=Math.max(h,3),i=Math.max(i,1),a.call(this);var m,n,o=f/2,p=[],q=[];for(n=0;i>=n;n++){var r=[],s=[],t=n/i,u=t*(d-b)+b;for(m=0;h>=m;m++){var v=m/h,w=new g;w.x=u*Math.sin(v*l+k),w.y=-t*f+o,w.z=u*Math.cos(v*l+k),this.vertices.push(w),r.push(this.vertices.length-1),s.push(new e([v,1-t]))}p.push(r),q.push(s)}var x,y,z=(d-b)/f;for(m=0;h>m;m++)for(0!==b?(x=g.copy(this.vertices[p[0][m]]),y=g.copy(this.vertices[p[0][m+1]])):(x=g.copy(this.vertices[p[1][m]]),y=g.copy(this.vertices[p[1][m+1]])),x.setY(Math.sqrt(x.x*x.x+x.z*x.z)*z).normalize(),y.setY(Math.sqrt(y.x*y.x+y.z*y.z)*z).normalize(),n=0;i>n;n++){var A=p[n][m],B=p[n+1][m],C=p[n+1][m+1],D=p[n][m+1],E=x.clone(),F=x.clone(),G=y.clone(),H=y.clone(),I=q[n][m].clone(),J=q[n+1][m].clone(),K=q[n+1][m+1].clone(),L=q[n][m+1].clone();this.faces.push(new c(A,B,D,[E,F,H])),this.faceVertexUvs[0].push([I,J,L]),this.faces.push(new c(B,C,D,[F.clone(),G,H.clone()])),this.faceVertexUvs[0].push([J.clone(),K,L.clone()])}if(!j&&b>0)for(this.vertices.push(g.e2.clone().multiplyScalar(o)),m=0;h>m;m++){var A=p[0][m],B=p[0][m+1],C=this.vertices.length-1,E=g.e2.clone(),F=g.e2.clone(),G=g.e2.clone(),I=q[0][m].clone(),J=q[0][m+1].clone(),K=new e([J.x,0]);this.faces.push(new c(A,B,C,[E,F,G])),this.faceVertexUvs[0].push([I,J,K])}if(!j&&d>0)for(this.vertices.push(g.e2.clone().multiplyScalar(-o)),m=0;h>m;m++){var A=p[i][m+1],B=p[i][m],C=this.vertices.length-1,E=g.e2.clone().multiplyScalar(-1),F=g.e2.clone().multiplyScalar(-1),G=g.e2.clone().multiplyScalar(-1),I=q[i][m+1].clone(),J=q[i][m].clone(),K=new e([J.x,1]);this.faces.push(new c(A,B,C,[E,F,G])),this.faceVertexUvs[0].push([I,J,K])}}return f(b,a),b}(d);return h});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/PolyhedronGeometry",["require","exports","../core/Face3","../geometries/Geometry3","../math/Sphere","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g,h){var i=function(a){function b(b,d,f,i){function j(a){var b=h.copy(a).normalize();b.index=q.vertices.push(b)-1;var c=n(a)/2/Math.PI+.5,d=o(a)/Math.PI+.5;return b.uv=new g([c,1-d]),b}function k(a,b,c){var d=(a.x+b.x+c.x)/3,e=(a.y+b.y+c.y)/3,f=(a.z+b.z+c.z)/3;return{x:d,y:e,z:f}}function l(a,b,d){var e=new c(a.index,b.index,d.index,[h.copy(a),h.copy(b),h.copy(d)]);q.faces.push(e);var f=n(k(a,b,d));q.faceVertexUvs[0].push([p(a.uv,a,f),p(b.uv,b,f),p(d.uv,d,f)])}function m(a,b){for(var c=Math.pow(2,b),d=j(q.vertices[a.a]),e=j(q.vertices[a.b]),f=j(q.vertices[a.c]),g=[],i=0;c>=i;i++){g[i]=[];for(var k=j(h.copy(d).lerp(f,i/c)),m=j(h.copy(e).lerp(f,i/c)),n=c-i,o=0;n>=o;o++)0==o&&i==c?g[i][o]=k:g[i][o]=j(h.copy(k).lerp(m,o/n))}for(var i=0;c>i;i++)for(var o=0;2*(c-i)-1>o;o++){var p=Math.floor(o/2);o%2==0?l(g[i][p+1],g[i+1][p],g[i][p]):l(g[i][p+1],g[i+1][p+1],g[i+1][p])}}function n(a){return Math.atan2(a.z,-a.x)}function o(a){return Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))}function p(a,b,c){return 0>c&&1===a.x&&(a=new g([a.x-1,a.y])),0===b.x&&0===b.z&&(a=new g([c/2/Math.PI+.5,a.y])),a.clone()}void 0===f&&(f=1),void 0===i&&(i=0),a.call(this);for(var q=this,r=0,s=b.length;s>r;r+=3)j(new h([b[r],b[r+1],b[r+2]]));for(var t=this.vertices,u=[],r=0,v=0,s=d.length;s>r;r+=3,v++){var w=t[d[r]],x=t[d[r+1]],y=t[d[r+2]];u[v]=new c(w.index,x.index,y.index,[h.copy(w),h.copy(x),h.copy(y)])}for(var r=0,z=u.length;z>r;r++)m(u[r],i);for(var r=0,A=this.faceVertexUvs[0].length;A>r;r++){var B=this.faceVertexUvs[0][r],C=B[0].x,D=B[1].x,E=B[2].x,F=Math.max(C,Math.max(D,E)),G=Math.min(C,Math.min(D,E));F>.9&&.1>G&&(.2>C&&(B[0].x+=1),.2>D&&(B[1].x+=1),.2>E&&(B[2].x+=1))}for(var r=0,H=this.vertices.length;H>r;r++)this.vertices[r].x*=f,this.vertices[r].y*=f,this.vertices[r].z*=f;this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new e(new h([0,0,0]),f)}return f(b,a),b}(d);return i});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/DodecahedronGeometry",["require","exports","../geometries/PolyhedronGeometry"],function(a,b,c){var d=(1+Math.sqrt(5))/2,e=1/d,g=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-e,-d,0,-e,d,0,e,-d,0,e,d,-e,-d,0,-e,d,0,e,-d,0,e,d,0,-d,0,-e,d,0,-e,-d,0,e,d,0,e],h=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],i=function(a){function b(b,c){a.call(this,g,h,b,c)}return f(b,a),b}(c);return i}),b("davinci-blade/NotImplementedError",["require","exports"],function(a,b){function c(a){this.name="NotImplementedError",this.message=a||""}return c.prototype=new Error,c}),b("davinci-blade/Rational",["require","exports","davinci-blade/Unit"],function(a,b,c){function d(a){this.name="RationalError",this.message=a||""}function e(a,b){if("number"==typeof b)return b;throw new d("Argument '"+a+"' must be a number")}function f(a,b){if(b instanceof g)return b;throw new d("Argument '"+b+"' must be a Rational")}d.prototype=new Error;var g=function(){function a(a,b){e("n",a),e("d",b);var c,d=function(a,b){e("a",a),e("b",b);var c;for(0>a&&(a=-a),0>b&&(b=-b),b>a&&(c=a,a=b,b=c);;){if(a%=b,0===a)return b;if(b%=a,0===b)return a}};if(0===b)throw new Error("denominator must not be zero");c=0===a?1:d(Math.abs(a),Math.abs(b)),0>b&&(a=-a,b=-b),this._numer=a/c,this._denom=b/c}return Object.defineProperty(a.prototype,"numer",{get:function(){return this._numer},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"denom",{get:function(){return this._denom},enumerable:!0,configurable:!0}),a.prototype.add=function(b){return f("rhs",b),new a(this._numer*b._denom+this._denom*b._numer,this._denom*b._denom)},a.prototype.sub=function(b){return f("rhs",b),new a(this._numer*b._denom-this._denom*b._numer,this._denom*b._denom)},a.prototype.mul=function(b){return f("rhs",b),new a(this._numer*b._numer,this._denom*b._denom)},a.prototype.div=function(b){return"number"==typeof b?new a(this._numer,this._denom*b):new a(this._numer*b._denom,this._denom*b._numer)},a.prototype.isZero=function(){return 0===this._numer},a.prototype.negative=function(){return new a(-this._numer,this._denom)},a.prototype.equals=function(b){return b instanceof a?this._numer*b._denom===this._denom*b._numer:!1},a.prototype.toString=function(){return""+this._numer+"/"+this._denom},a.ONE=new a(1,1),a.TWO=new a(2,1),a.MINUS_ONE=new a(-1,1),a.ZERO=new a(0,1),a}();return g}),b("davinci-blade/Dimensions",["require","exports","davinci-blade/Rational"],function(a,b,c){function d(a){this.name="DimensionError",this.message=a||""}d.prototype=new Error;var e=function(){function a(a,b,d,e,f,g,h){this.L=b,this.T=d,this.Q=e,this.temperature=f,this.amount=g,this.intensity=h;var i=b,j=d,k=e;if(7!==arguments.length)throw{name:"DimensionError",message:"Expecting 7 arguments"};if("number"==typeof a)this._mass=new c(a,1);else{if(!(a instanceof c))throw{name:"DimensionError",message:"mass must be a Rational or number"};this._mass=a}if("number"==typeof i)this.L=new c(i,1);else{if(!(i instanceof c))throw{name:"DimensionError",message:"length must be a Rational or number"};this.L=i}if("number"==typeof j)this.T=new c(j,1);else{if(!(j instanceof c))throw{name:"DimensionError",message:"time must be a Rational or number"};this.T=j}if("number"==typeof k)this.Q=new c(k,1);else{if(!(k instanceof c))throw{name:"DimensionError",message:"charge must be a Rational or number"};this.Q=k}if("number"==typeof f)this.temperature=new c(f,1);else{if(!(f instanceof c))throw{name:"DimensionError",message:"(thermodynamic) temperature must be a Rational or number"};this.temperature=f}if("number"==typeof g)this.amount=new c(g,1);else{if(!(g instanceof c))throw{name:"DimensionError",message:"amount (of substance) must be a Rational or number"};this.amount=g}if("number"==typeof h)this.intensity=new c(h,1);else{if(!(h instanceof c))throw{name:"DimensionError",message:"(luminous) intensity must be a Rational or number"};this.intensity=h}}return Object.defineProperty(a.prototype,"M",{get:function(){return this._mass},enumerable:!0,configurable:!0}),a.prototype.compatible=function(a){if(this._mass.equals(a._mass)&&this.L.equals(a.L)&&this.T.equals(a.T)&&this.Q.equals(a.Q)&&this.temperature.equals(a.temperature)&&this.amount.equals(a.amount)&&this.intensity.equals(a.intensity))return this;throw new d("Dimensions must be equal ("+this+", "+a+")")},a.prototype.mul=function(b){return new a(this._mass.add(b._mass),this.L.add(b.L),this.T.add(b.T),this.Q.add(b.Q),this.temperature.add(b.temperature),this.amount.add(b.amount),this.intensity.add(b.intensity))},a.prototype.div=function(b){return new a(this._mass.sub(b._mass),this.L.sub(b.L),this.T.sub(b.T),this.Q.sub(b.Q),this.temperature.sub(b.temperature),this.amount.sub(b.amount),this.intensity.sub(b.intensity))},a.prototype.pow=function(b){return new a(this._mass.mul(b),this.L.mul(b),this.T.mul(b),this.Q.mul(b),this.temperature.mul(b),this.amount.mul(b),this.intensity.mul(b))},a.prototype.sqrt=function(){return new a(this._mass.div(c.TWO),this.L.div(c.TWO),this.T.div(c.TWO),this.Q.div(c.TWO),this.temperature.div(c.TWO),this.amount.div(c.TWO),this.intensity.div(c.TWO))},a.prototype.dimensionless=function(){return this._mass.isZero()&&this.L.isZero()&&this.T.isZero()&&this.Q.isZero()&&this.temperature.isZero()&&this.amount.isZero()&&this.intensity.isZero()},a.prototype.isZero=function(){return this._mass.isZero()&&this.L.isZero()&&this.T.isZero()&&this.Q.isZero()&&this.temperature.isZero()&&this.amount.isZero()&&this.intensity.isZero()},a.prototype.negative=function(){return new a(this._mass.negative(),this.L.negative(),this.T.negative(),this.Q.negative(),this.temperature.negative(),this.amount.negative(),this.intensity.negative())},a.prototype.toString=function(){var a=function(a,b){return 0===a.numer?null:1===a.denom?1===a.numer?""+b:""+b+" ** "+a.numer:""+b+" ** "+a};return[a(this._mass,"mass"),a(this.L,"length"),a(this.T,"time"),a(this.Q,"charge"),a(this.temperature,"thermodynamic temperature"),a(this.amount,"amount of substance"),a(this.intensity,"luminous intensity")].filter(function(a){return"string"==typeof a}).join(" * ")},a}();return e}),b("davinci-blade/Unit",["require","exports","davinci-blade/Dimensions","davinci-blade/Rational"],function(a,b,c,d){function e(a){this.name="UnitError",this.message=a||""}function f(a,b){if("number"==typeof b)return b;throw new e("Argument '"+a+"' must be a number")}function g(a,b){if(b instanceof c)return b;throw new e("Argument '"+b+"' must be a Dimensions")}function h(a,b){if(b instanceof d)return b;throw new e("Argument '"+b+"' must be a Rational")}function i(a,b){if(b instanceof r)return b;throw new e("Argument '"+b+"' must be a Unit")}function j(a,b){return"undefined"==typeof b?b:i(a,b)}function k(a,b){return new r(a.scale+b.scale,a.dimensions.compatible(b.dimensions),a.labels)}function l(a,b){return new r(a.scale-b.scale,a.dimensions.compatible(b.dimensions),a.labels)}function m(a,b){return new r(a.scale*b.scale,a.dimensions.mul(b.dimensions),a.labels)}function n(a,b){return new r(a*b.scale,b.dimensions,b.labels)}function o(a,b){return new r(a.scale/b.scale,a.dimensions.div(b.dimensions),a.labels)}e.prototype=new Error;var p=function(a,b,c){f("scale",a),g("dimensions",b);var d,e,h,i=function(a,b){return 0===a.numer?null:1===a.denom?1===a.numer?""+b:""+b+" ** "+a.numer:""+b+" ** "+a};return d=1===a||b.isZero()?"":" ",e=1===a?"":""+a,h=[i(b.M,c[0]),i(b.L,c[1]),i(b.T,c[2]),i(b.Q,c[3]),i(b.temperature,c[4]),i(b.amount,c[5]),i(b.intensity,c[6])].filter(function(a){return"string"==typeof a}).join(" "),""+e+d+h},q=function(a,b,c){for(var d=[[-1,1,-3,1,2,1,2,1,0,1,0,1,0,1],[-1,1,-2,1,1,1,2,1,0,1,0,1,0,1],[-1,1,-2,1,2,1,2,1,0,1,0,1,0,1],[-1,1,3,1,-2,1,0,1,0,1,0,1,0,1],[0,1,0,1,-1,1,0,1,0,1,0,1,0,1],[0,1,0,1,-1,1,1,1,0,1,0,1,0,1],[0,1,1,1,-2,1,0,1,0,1,0,1,0,1],[0,1,1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,-1,1,-2,1,0,1,0,1,0,1,0,1],[1,1,-1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,0,1,-3,1,0,1,0,1,0,1,0,1],[1,1,0,1,-2,1,0,1,0,1,0,1,0,1],[1,1,0,1,-1,1,-1,1,0,1,0,1,0,1],[1,1,1,1,-3,1,0,1,-1,1,0,1,0,1],[1,1,1,1,-2,1,-1,1,0,1,0,1,0,1],[1,1,1,1,-2,1,0,1,0,1,0,1,0,1],[1,1,1,1,0,1,-2,1,0,1,0,1,0,1],[1,1,2,1,-2,1,0,1,-1,1,0,1,0,1],[0,1,2,1,-2,1,0,1,-1,1,0,1,0,1],[1,1,2,1,-2,1,0,1,-1,1,-1,1,0,1],[1,1,2,1,-2,1,0,1,0,1,-1,1,0,1],[1,1,2,1,-2,1,0,1,0,1,0,1,0,1],[1,1,2,1,-1,1,0,1,0,1,0,1,0,1],[1,1,2,1,-3,1,0,1,0,1,0,1,0,1],[1,1,2,1,-2,1,-1,1,0,1,0,1,0,1],[1,1,2,1,-1,1,-2,1,0,1,0,1,0,1],[1,1,2,1,0,1,-2,1,0,1,0,1,0,1],[1,1,2,1,-1,1,-1,1,0,1,0,1,0,1]],e=[["F/m"],["S"],["F"],["Nm ** 2/kg ** 2"],["Hz"],["A"],["m/s ** 2"],["m/s"],["kgm/s"],["Pa"],["Pas"],["W/m ** 2"],["N/m"],["T"],["W/(mK)"],["V/m"],["N"],["H/m"],["J/K"],["J/(kgK)"],["J/(molK)"],["J/mol"],["J"],["Js"],["W"],["V"],[""],["H"],["Wb"]],f=b.M,g=b.L,h=b.T,i=b.Q,j=b.temperature,k=b.amount,l=b.intensity,m=0,n=d.length;n>m;m++){var o=d[m];if(f.numer===o[0]&&f.denom===o[1]&&g.numer===o[2]&&g.denom===o[3]&&h.numer===o[4]&&h.denom===o[5]&&i.numer===o[6]&&i.denom===o[7]&&j.numer===o[8]&&j.denom===o[9]&&k.numer===o[10]&&k.denom===o[11]&&l.numer===o[12]&&l.denom===o[13])return 1!==a?a+" * "+e[m][0]:e[m][0]}return p(a,b,c)},r=function(){function a(a,b,c){if(this.scale=a,this.dimensions=b,this.labels=c,7!==c.length)throw new Error("Expecting 7 elements in the labels array.");this.scale=a,this.dimensions=b,this.labels=c}return a.prototype.compatible=function(b){if(b instanceof a)return this.dimensions.compatible(b.dimensions),this;throw new Error("Illegal Argument for Unit.compatible: "+b)},a.prototype.add=function(a){return i("rhs",a),k(this,a)},a.prototype.__add__=function(b){return b instanceof a?k(this,b):void 0},a.prototype.__radd__=function(b){return b instanceof a?k(b,this):void 0},a.prototype.sub=function(a){return i("rhs",a),l(this,a)},a.prototype.__sub__=function(b){return b instanceof a?l(this,b):void 0},a.prototype.__rsub__=function(b){return b instanceof a?l(b,this):void 0},a.prototype.mul=function(a){return i("rhs",a),m(this,a)},a.prototype.__mul__=function(b){return b instanceof a?m(this,b):"number"==typeof b?n(b,this):void 0},a.prototype.__rmul__=function(b){return b instanceof a?m(b,this):"number"==typeof b?n(b,this):void 0},a.prototype.div=function(a){return i("rhs",a),o(this,a)},a.prototype.__div__=function(b){return b instanceof a?o(this,b):"number"==typeof b?new a(this.scale/b,this.dimensions,this.labels):void 0},a.prototype.__rdiv__=function(b){return b instanceof a?o(b,this):"number"==typeof b?new a(b/this.scale,this.dimensions.negative(),this.labels):void 0},a.prototype.pow=function(b){return h("exponent",b),new a(Math.pow(this.scale,b.numer/b.denom),this.dimensions.pow(b),this.labels)},a.prototype.inverse=function(){return new a(1/this.scale,this.dimensions.negative(),this.labels)},a.prototype.isUnity=function(){return this.dimensions.dimensionless()&&1===this.scale},a.prototype.norm=function(){return new a(Math.abs(this.scale),this.dimensions,this.labels)},a.prototype.quad=function(){return new a(this.scale*this.scale,this.dimensions.mul(this.dimensions),this.labels)},a.prototype.toString=function(){return q(this.scale,this.dimensions,this.labels)},a.isUnity=function(b){if("undefined"==typeof b)return!0;if(b instanceof a)return b.isUnity();throw new Error("isUnity argument must be a Unit or undefined.")},a.assertDimensionless=function(b){if(!a.isUnity(b))throw new e("uom must be dimensionless.")},a.compatible=function(a,b){if(j("lhs",a),j("rhs",b),a){if(b)return a.compatible(b);if(a.isUnity())return void 0;throw new e(a+" is incompatible with 1")}if(b){if(b.isUnity())return void 0;throw new e("1 is incompatible with "+b)}return void 0},a.mul=function(b,c){return b instanceof a?c instanceof a?b.mul(c):a.isUnity(c)?b:void 0:a.isUnity(b)?c:void 0},a.div=function(b,c){return b instanceof a?c instanceof a?b.div(c):b:c instanceof a?c.inverse():void 0},a.sqrt=function(b){return"undefined"!=typeof b?(i("uom",b),b.isUnity()?void 0:new a(Math.sqrt(b.scale),b.dimensions.sqrt(),b.labels)):void 0},a}();return r}),b("davinci-blade/core",["require","exports"],function(a,b){function c(a,b){return null!==a&&"object"==typeof a&&"function"==typeof a[b]}function d(a,b){return function(d){if(c(d,a))return d[a]();if("number"==typeof d){var e=d,f=e,g=b(f);return g}throw new TypeError("x must support "+a+"(x)")}}function e(a){return(Math.exp(a)+Math.exp(-a))/2}function f(a){return(Math.exp(a)-Math.exp(-a))/2}var g={VERSION:"1.7.2",cos:d("cos",Math.cos),cosh:d("cosh",e),exp:d("exp",Math.exp),norm:d("norm",function(a){return Math.abs(a)}),quad:d("quad",function(a){return a*a}),sin:d("sin",Math.sin),sinh:d("sinh",f),sqrt:d("sqrt",Math.sqrt),unit:d("unit",function(a){return a/Math.abs(a)}),Math:{cosh:e,sinh:f}};return g}),b("davinci-blade/e3ga/Euclidean3",["require","exports","davinci-blade/NotImplementedError","davinci-blade/Unit","davinci-blade/core"],function(a,b,c,d,e){function f(a){this.name="Euclidean3Error",this.message=a||""}function g(a,b){if("number"==typeof b)return b;throw new f("Argument '"+a+"' must be a number")}function h(a,b){if(b instanceof v)return b;throw new f("Argument '"+b+"' must be a Euclidean3")}function i(a,b){if("undefined"==typeof b||b instanceof d)return b;throw new f("Argument '"+b+"' must be a Unit or undefined")}function j(a,b,c,d,e,f){var g=d(b,0),h=d(b,1),i=d(b,2),j=d(b,3),k=d(b,4),l=d(b,5),m=d(b,6),n=d(b,7),o=d(c,0),p=d(c,1),q=d(c,2),r=d(c,3),s=d(c,4),t=d(c,5),u=d(c,6),v=d(c,7),w=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,0),x=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,1),y=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,2),z=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,3),A=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,4),B=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,5),C=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,6),D=a(g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,7);return e(w,x,y,z,A,B,C,D,f)}function k(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,c=+c,d=+d,e=+e,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a+j);break;case 1:s=+(b+k);break;case 2:s=+(c+l);break;case 3:s=+(d+m);break;case 4:s=+(e+n);break;case 5:s=+(g+o);break;case 6:s=+(h+p);break;case 7:s=+(i+q);break;default:throw new f("index must be in the range [0..7]")}return+s}function l(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,c=+c,d=+d,e=+e,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a-j);break;case 1:s=+(b-k);break;case 2:s=+(c-l);break;case 3:s=+(d-m);break;case 4:s=+(e-n);break;case 5:s=+(g-o);break;case 6:s=+(h-p);break;case 7:s=+(i-q);break;default:throw new f("index must be in the range [0..7]")}return+s}function m(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,c=+c,d=+d,e=+e,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j+b*k+c*l+d*m-e*n-g*o-h*p-i*q);break;case 1:s=+(a*k+b*j-c*n+d*p+e*l-g*q-h*m-i*o);break;case 2:s=+(a*l+b*n+c*j-d*o-e*k+g*m-h*q-i*p);break;case 3:s=+(a*m-b*p+c*o+d*j-e*q-g*l+h*k-i*n);break;case 4:s=+(a*n+b*l-c*k+d*q+e*j-g*p+h*o+i*m);break;case 5:s=+(a*o+b*q+c*m-d*l+e*p+g*j-h*n+i*k);break;case 6:s=+(a*p-b*m+c*q+d*k-e*o+g*n+h*j+i*l);break;case 7:s=+(a*q+b*o+c*p+d*n+e*m+g*k+h*l+i*j);break;default:throw new f("index must be in the range [0..7]")}return+s}function n(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,c=+c,d=+d,e=+e,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j+b*k+c*l+d*m-e*n-g*o-h*p-i*q);break;case 1:s=0;break;case 2:s=0;break;case 3:s=0;break;case 4:s=0;break;case 5:s=0;break;case 6:s=0;break;case 7:s=0;break;default:throw new f("index must be in the range [0..7]")}return+s}function o(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,c=+c,d=+d,e=+e,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j);break;case 1:s=+(a*k+b*j);break;case 2:s=+(a*l+c*j);break;case 3:s=+(a*m+d*j);break;case 4:s=+(a*n+b*l-c*k+e*j);break;case 5:s=+(a*o+c*m-d*l+g*j);break;case 6:s=+(a*p-b*m+d*k+h*j);break;case 7:s=+(a*q+b*o+c*p+d*n+e*m+g*k+h*l+i*j);break;default:throw new f("index must be in the range [0..7]")}return+s}function p(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,c=+c,d=+d,e=+e,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j+b*k+c*l+d*m-e*n-g*o-h*p-i*q);break;case 1:s=+(a*k-c*n+d*p-g*q);break;case 2:s=+(a*l+b*n-d*o-h*q);break;case 3:s=+(a*m-b*p+c*o-e*q);break;case 4:s=+(a*n+d*q);break;case 5:s=+(a*o+b*q);break;case 6:s=+(a*p+c*q);break;case 7:s=+(a*q);break;default:throw new f("index must be in the range [0..7]")}return+s}function q(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r){a=+a,b=+b,c=+c,d=+d,e=+e,g=+g,h=+h,i=+i,j=+j,k=+k,l=+l,m=+m,n=+n,o=+o,p=+p,q=+q,r=0|r;var s=0;switch(~~r){case 0:s=+(a*j+b*k+c*l+d*m-e*n-g*o-h*p-i*q);break;case 1:s=+(+b*j+e*l-h*m-i*o);break;case 2:s=+(+c*j-e*k+g*m-i*p);break;case 3:s=+(+d*j-g*l+h*k-i*n);break;case 4:s=+(+e*j+i*m);break;case 5:s=+(+g*j+i*k);break;case 6:s=+(+h*j+i*l);break;case 7:s=+(+i*j);break;default:throw new f("index must be in the range [0..7]")}return+s}function r(a,b,c){var d,e,f,g,h=[],i=function(a,c){var d;0!==a&&(a>=0?h.length>0&&h.push("+"):h.push("-"),d=Math.abs(a),1===d?h.push(c):(h.push(b(d)),"1"!==c&&(h.push("*"),h.push(c))))};for(d=e=0,f=a.length-1;f>=0?f>=e:e>=f;d=f>=0?++e:--e)i(a[d],c[d]);return g=h.length>0?h.join(""):"0"}var s=Math.cos,t=(e.Math.cosh,Math.exp,Math.sin);e.Math.sinh;f.prototype=new Error;var u=function(a,b,c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s){var t,u,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa;return T=+i,U=+j,V=+k,W=-l,X=+n,Y=-o,Z=-p,$=-q,L=m(i,j,k,n,l,p,-o,q,T,U,V,X,W,Z,-Y,$,0),M=m(i,j,k,n,l,p,-o,q,T,U,V,X,W,Z,-Y,$,1),N=m(i,j,k,n,l,p,-o,q,T,U,V,X,W,Z,-Y,$,2),O=0,P=m(i,j,k,n,l,p,-o,q,T,U,V,X,W,Z,-Y,$,3),Q=0,R=0,S=0,t=+L,u=-M,w=-N,x=-O,y=-P,z=-Q,A=-R,B=+S,_=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,0),aa=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,1),ba=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,2),ca=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,4),da=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,3),ea=-m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,6),fa=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,5),ga=m(T,U,V,X,W,Z,-Y,$,t,u,w,y,x,A,-z,B,7),K=m(i,j,k,n,l,p,-o,q,_,aa,ba,da,ca,fa,-ea,ga,0),C=_/K,D=aa/K,E=ba/K,F=ca/K,G=da/K,H=ea/K,I=fa/K,J=ga/K,ja=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,0),ka=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,1),la=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,2),ma=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,4),na=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,3),oa=-m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,6),pa=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,5),qa=m(a,b,c,e,d,g,-f,h,C,D,E,G,F,I,-H,J,7),ha=ja,ia=ka,ta=la,va=na,ra=ma,ua=pa,wa=-oa,sa=qa,"undefined"==typeof s?new v(ha,ia,ta,va,ra,ua,wa,sa,r):(s.w=ha,s.x=ia,s.y=ta,s.z=va,s.xy=ra,s.yz=ua,s.zx=wa,s.xyz=sa,s.uom=r,void 0)},v=function(){function a(a,b,c,e,f,h,j,k,l){if(this.w=g("w",a),this.x=g("x",b),this.y=g("y",c),this.z=g("z",e),this.xy=g("xy",f),this.yz=g("yz",h),this.zx=g("zx",j),this.xyz=g("xyz",k),this.uom=i("uom",l),this.uom&&1!==this.uom.scale){var m=this.uom.scale;this.w*=m,this.x*=m,this.y*=m,this.z*=m,this.xy*=m,this.yz*=m,this.zx*=m,this.xyz*=m,this.uom=new d(1,l.dimensions,l.labels)}}return a.fromCartesian=function(b,c,d,e,f,h,j,k,l){return g("w",b),g("x",c),g("y",d),g("z",e),g("xy",f),g("yz",h),g("zx",j),g("xyz",k),i("uom",l),new a(b,c,d,e,f,h,j,k,l)},a.prototype.coordinates=function(){return[this.w,this.x,this.y,this.z,this.xy,this.yz,this.zx,this.xyz]},a.prototype.coordinate=function(a){switch(g("index",a),a){case 0:return this.w;case 1:return this.x;case 2:return this.y;case 3:return this.z;case 4:return this.xy;case 5:return this.yz;case 6:return this.zx;case 7:return this.xyz;default:throw new f("index must be in the range [0..7]")}},a.prototype.add=function(b){var c=function(a,b){return a[b]},e=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(k,this.coordinates(),b.coordinates(),c,e,d.compatible(this.uom,b.uom))},a.prototype.__add__=function(b){return b instanceof a?this.add(b):"number"==typeof b?this.add(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__radd__=function(b){return b instanceof a?b.add(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).add(this):void 0},a.prototype.sub=function(b){var c=function(a,b){return a[b]},e=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(l,this.coordinates(),b.coordinates(),c,e,d.compatible(this.uom,b.uom))},a.prototype.__sub__=function(b){return b instanceof a?this.sub(b):"number"==typeof b?this.sub(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rsub__=function(b){return b instanceof a?b.sub(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).sub(this):void 0},a.prototype.mul=function(b){var c=function(a,b){return a[b]},e=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(m,this.coordinates(),b.coordinates(),c,e,d.mul(this.uom,b.uom))},a.prototype.__mul__=function(b){return b instanceof a?this.mul(b):"number"==typeof b?this.mul(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rmul__=function(b){return b instanceof a?b.mul(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).mul(this):void 0},a.prototype.scalarMultiply=function(b){return new a(this.w*b,this.x*b,this.y*b,this.z*b,this.xy*b,this.yz*b,this.zx*b,this.xyz*b,this.uom)},a.prototype.div=function(a){return h("rhs",a),u(this.w,this.x,this.y,this.xy,this.z,-this.zx,this.yz,this.xyz,a.w,a.x,a.y,a.xy,a.z,-a.zx,a.yz,a.xyz,d.div(this.uom,a.uom))},a.prototype.__div__=function(b){return b instanceof a?this.div(b):"number"==typeof b?this.div(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rdiv__=function(b){return b instanceof a?b.div(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).div(this):void 0},a.prototype.splat=function(b){var c=function(a,b){return a[b]},e=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(n,this.coordinates(),b.coordinates(),c,e,d.mul(this.uom,b.uom))},a.prototype.wedge=function(b){var c=function(a,b){return a[b]},e=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(o,this.coordinates(),b.coordinates(),c,e,d.mul(this.uom,b.uom))},a.prototype.__vbar__=function(b){
return b instanceof a?this.splat(b):"number"==typeof b?this.splat(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rvbar__=function(b){return b instanceof a?b.splat(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).splat(this):void 0},a.prototype.__wedge__=function(b){return b instanceof a?this.wedge(b):"number"==typeof b?this.wedge(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rwedge__=function(b){return b instanceof a?b.wedge(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).wedge(this):void 0},a.prototype.lshift=function(b){var c=function(a,b){return a[b]},e=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(p,this.coordinates(),b.coordinates(),c,e,d.mul(this.uom,b.uom))},a.prototype.__lshift__=function(b){return b instanceof a?this.lshift(b):"number"==typeof b?this.lshift(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rlshift__=function(b){return b instanceof a?b.lshift(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).lshift(this):void 0},a.prototype.rshift=function(b){var c=function(a,b){return a[b]},e=function(b,c,d,e,f,g,h,i,j){return a.fromCartesian(b,c,d,e,f,g,h,i,j)};return j(q,[this.w,this.x,this.y,this.z,this.xy,this.yz,this.zx,this.xyz],[b.w,b.x,b.y,b.z,b.xy,b.yz,b.zx,b.xyz],c,e,d.mul(this.uom,b.uom))},a.prototype.__rshift__=function(b){return b instanceof a?this.rshift(b):"number"==typeof b?this.rshift(new a(b,0,0,0,0,0,0,0,void 0)):void 0},a.prototype.__rrshift__=function(b){return b instanceof a?b.rshift(this):"number"==typeof b?new a(b,0,0,0,0,0,0,0,void 0).rshift(this):void 0},a.prototype.pow=function(a){throw new f("pow")},a.prototype.__pos__=function(){return this},a.prototype.__neg__=function(){return new a(-this.w,-this.x,-this.y,-this.z,-this.xy,-this.yz,-this.zx,-this.xyz,this.uom)},a.prototype.__tilde__=function(){return new a(this.w,this.x,this.y,this.z,-this.xy,-this.yz,-this.zx,-this.xyz,this.uom)},a.prototype.grade=function(b){switch(g("index",b),b){case 0:return a.fromCartesian(this.w,0,0,0,0,0,0,0,this.uom);case 1:return a.fromCartesian(0,this.x,this.y,this.z,0,0,0,0,this.uom);case 2:return a.fromCartesian(0,0,0,0,this.xy,this.yz,this.zx,0,this.uom);case 3:return a.fromCartesian(0,0,0,0,0,0,0,this.xyz,this.uom);default:return a.fromCartesian(0,0,0,0,0,0,0,0,this.uom)}},a.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},a.prototype.cross=function(b){var c,e,f,g,h,i,j,k,l;return e=this.x,h=this.y,k=this.z,f=b.x,i=b.y,l=b.z,c=h*l-k*i,g=k*f-e*l,j=e*i-h*f,new a(0,c,g,j,0,0,0,0,d.mul(this.uom,b.uom))},a.prototype.isZero=function(){return 0===this.w&&0===this.x&&0===this.y&&0===this.z&&0===this.yz&&0===this.zx&&0===this.xy&&0===this.xyz},a.prototype.length=function(){return Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z+this.xy*this.xy+this.yz*this.yz+this.zx*this.zx+this.xyz*this.xyz)},a.prototype.cos=function(){d.assertDimensionless(this.uom);var b=s(this.w);return new a(b,0,0,0,0,0,0,0,void 0)},a.prototype.cosh=function(){throw new c("cosh(Euclidean3)")},a.prototype.exp=function(){d.assertDimensionless(this.uom);var b=this.grade(2),c=b.norm();if(c.isZero())return new a(1,0,0,0,0,0,0,0,this.uom);var e=c.cos(),f=c.sin(),g=b.unit();return e.add(g.mul(f))},a.prototype.norm=function(){return new a(Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z+this.xy*this.xy+this.yz*this.yz+this.zx*this.zx+this.xyz*this.xyz),0,0,0,0,0,0,0,this.uom)},a.prototype.quad=function(){return new a(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z+this.xy*this.xy+this.yz*this.yz+this.zx*this.zx+this.xyz*this.xyz,0,0,0,0,0,0,0,d.mul(this.uom,this.uom))},a.prototype.sin=function(){d.assertDimensionless(this.uom);var b=t(this.w);return new a(b,0,0,0,0,0,0,0,void 0)},a.prototype.sinh=function(){throw new f("sinh")},a.prototype.unit=function(){return this.div(this.norm())},a.prototype.scalar=function(){return this.w},a.prototype.sqrt=function(){return new a(Math.sqrt(this.w),0,0,0,0,0,0,0,d.sqrt(this.uom))},a.prototype.toStringCustom=function(a,b){var c=r(this.coordinates(),a,b);if(this.uom){var d=this.uom.toString().trim();return d?c+" "+d:c}return c},a.prototype.toExponential=function(){var a=function(a){return a.toExponential()};return this.toStringCustom(a,["1","e1","e2","e3","e12","e23","e31","e123"])},a.prototype.toFixed=function(a){g("digits",a);var b=function(b){return b.toFixed(a)};return this.toStringCustom(b,["1","e1","e2","e3","e12","e23","e31","e123"])},a.prototype.toString=function(){var a=function(a){return a.toString()};return this.toStringCustom(a,["1","e1","e2","e3","e12","e23","e31","e123"])},a.prototype.toStringIJK=function(){var a=function(a){return a.toString()};return this.toStringCustom(a,["1","i","j","k","ij","jk","ki","I"])},a.prototype.toStringLATEX=function(){var a=function(a){return a.toString()};return this.toStringCustom(a,["1","e_{1}","e_{2}","e_{3}","e_{12}","e_{23}","e_{31}","e_{123}"])},a}();return v}),b("davinci-blade/e3ga/scalarE3",["require","exports","davinci-blade/e3ga/Euclidean3"],function(a,b,c){var d=function(a,b){return new c(a,0,0,0,0,0,0,0,b)};return d}),b("davinci-blade/e3ga/vectorE3",["require","exports","davinci-blade/e3ga/Euclidean3"],function(a,b,c){var d=function(a,b,d,e){return new c(0,a,b,d,0,0,0,0,e)};return d}),b("davinci-blade/e3ga/bivectorE3",["require","exports","davinci-blade/e3ga/Euclidean3"],function(a,b,c){var d=function(a,b,d,e){return new c(0,0,0,0,a,b,d,0,e)};return d}),b("davinci-blade/e3ga/pseudoscalarE3",["require","exports","davinci-blade/e3ga/Euclidean3"],function(a,b,c){var d=function(a,b){return new c(0,0,0,0,0,0,0,a,b)};return d});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/EllipticalCylinderGeometry",["require","exports","davinci-blade/e3ga/Euclidean3","davinci-blade/e3ga/scalarE3","davinci-blade/e3ga/vectorE3","davinci-blade/e3ga/bivectorE3","davinci-blade/e3ga/pseudoscalarE3","../geometries/Geometry3"],function(a,b,c,d,e,g,h,i){var j=function(a){function b(){a.call(this);var b=d(1);console.log("s: "+b);var f=new c(1,2,3,4,5,6,7,8);console.log("m: "+f);var i=e(1,2,3);console.log("v: "+i);var j=g(3,4,5);console.log("B: "+j);var k=h(6);console.log("I: "+k)}return f(b,a),b}(i);return j});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/IcosahedronGeometry",["require","exports","../geometries/PolyhedronGeometry"],function(a,b,c){var d=(1+Math.sqrt(5))/2,e=[-1,d,0,1,d,0,-1,-d,0,1,-d,0,0,-1,d,0,1,d,0,-1,-d,0,1,-d,d,0,-1,d,0,1,-d,0,-1,-d,0,1],g=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],h=function(a){function b(b,c){a.call(this,e,g,b,c),this.type="IcosahedronGeometry"}return f(b,a),b}(c);return h});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/SurfaceGeometry",["require","exports","../core/Face3","../geometries/Geometry3","../math/Vector2","../checks/expectArg"],function(a,b,c,d,e,g){var h=function(a){function b(b,d,f){a.call(this),g("parametricFunction",b).toBeFunction(),g("uSegments",d).toBeNumber(),g("vSegments",f).toBeNumber();var h,i,j=this.vertices,k=this.faces,l=this.faceVertexUvs[0],m=d+1;for(h=0;f>=h;h++){var n=h/f;for(i=0;d>=i;i++){var o=i/d,p=b(o,n);j.push({x:p.x,y:p.y,z:p.z})}}var q,r,s,t,u,v,w,x;for(h=0;f>h;h++)for(i=0;d>i;i++)q=h*m+i,r=h*m+i+1,s=(h+1)*m+i+1,t=(h+1)*m+i,u=new e([i/d,h/f]),v=new e([(i+1)/d,h/f]),w=new e([(i+1)/d,(h+1)/f]),x=new e([i/d,(h+1)/f]),k.push(new c(q,r,t)),l.push([u,v,x]),k.push(new c(r,s,t)),l.push([v.clone(),w,x.clone()]);this.computeFaceNormals(),this.computeVertexNormals()}return f(b,a),b}(d);return h});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/KleinBottleGeometry",["require","exports","../geometries/SurfaceGeometry","../math/Vector3"],function(a,b,c,d){function e(a,b){var c=new d;return a=2*a*i,b=2*b*i,i>a?(c.x=3*g(a)*(1+h(a))+2*(1-g(a)/2)*g(a)*g(b),c.z=-8*h(a)-2*(1-g(a)/2)*h(a)*g(b)):(c.x=3*g(a)*(1+h(a))+2*(1-g(a)/2)*g(b+i),c.z=-8*h(a)),c.y=-2*(1-g(a)/2)*h(b),c}var g=Math.cos,h=Math.sin,i=Math.PI,j=function(a){function b(b,c){a.call(this,e,b,c)}return f(b,a),b}(c);return j});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/MobiusStripGeometry",["require","exports","../geometries/SurfaceGeometry","../math/Vector3"],function(a,b,c,d){function e(a,b){var c=new d([0,0,0]),e=1,f=.05,j=(2*a-1)*f,k=2*i*b;return c.x=(e+j*g(k/2))*g(k),c.y=(e+j*g(k/2))*h(k),c.z=j*h(k/2),c}var g=Math.cos,h=Math.sin,i=Math.PI,j=function(a){function b(b,c){a.call(this,e,b,c)}return f(b,a),b}(c);return j});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/OctahedronGeometry",["require","exports","../geometries/PolyhedronGeometry"],function(a,b,c){var d=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],e=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],g=function(a){function b(b,c){a.call(this,d,e,b,c)}return f(b,a),b}(c);return g});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/SphereGeometry",["require","exports","../core/Face3","../geometries/Geometry3","../math/Sphere","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g,h){var i=function(a){function b(b,d,f,i,j,k,l){void 0===b&&(b=1),void 0===d&&(d=16),void 0===f&&(f=12),void 0===i&&(i=0),void 0===j&&(j=2*Math.PI),void 0===k&&(k=0),void 0===l&&(l=Math.PI),a.call(this);var m,n,o=[],p=[];for(n=0;f>=n;n++){var q=[],r=[];for(m=0;d>=m;m++){var s=m/d,t=n/f,u=new h([0,0,0]);u.x=-b*Math.cos(i+s*j)*Math.sin(k+t*l),u.y=b*Math.cos(k+t*l),u.z=b*Math.sin(i+s*j)*Math.sin(k+t*l),this.vertices.push(u),q.push(this.vertices.length-1),r.push(new g([s,1-t]))}o.push(q),p.push(r)}for(n=0;f>n;n++)for(m=0;d>m;m++){var v=o[n][m+1],w=o[n][m],x=o[n+1][m],y=o[n+1][m+1],z=h.copy(this.vertices[v]).normalize(),A=h.copy(this.vertices[w]).normalize(),B=h.copy(this.vertices[x]).normalize(),C=h.copy(this.vertices[y]).normalize(),D=p[n][m+1].clone(),E=p[n][m].clone(),F=p[n+1][m].clone(),G=p[n+1][m+1].clone();Math.abs(this.vertices[v].y)===b?(D.x=(D.x+E.x)/2,this.faces.push(new c(v,x,y,[z,B,C])),this.faceVertexUvs[0].push([D,F,G])):Math.abs(this.vertices[x].y)===b?(F.x=(F.x+G.x)/2,this.faces.push(new c(v,w,x,[z,A,B])),this.faceVertexUvs[0].push([D,E,F])):(this.faces.push(new c(v,w,y,[z,A,C])),this.faceVertexUvs[0].push([D,E,G]),this.faces.push(new c(w,x,y,[A.clone(),B,C.clone()])),this.faceVertexUvs[0].push([E.clone(),F,G.clone()]))}this.boundingSphere=new e(new h([0,0,0]),b)}return f(b,a),b}(d);return i});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/TetrahedronGeometry",["require","exports","../geometries/PolyhedronGeometry"],function(a,b,c){var d=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],e=[2,1,0,0,3,2,1,3,0,2,3,1],g=function(a){function b(b,c){a.call(this,d,e,b,c)}return f(b,a),b}(c);return g}),b("davinci-eight/math/clamp",["require","exports"],function(a,b){function c(a,b,c){return b>a?b:a>c?c:a}return c});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/TubeGeometry",["require","exports","../math/clamp","../core/Face3","../geometries/Geometry3","../math/Matrix4","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g,h,i){var j=function(a){function b(c,e,f,g,j,l){function m(a,b,c){return J.vertices.push(new i([a,b,c]))-1}a.call(this),e=e||64,f=f||.05,g=g||16,j=j||!1,l=l||b.NoTaper;var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=[],J=this,K=e+1,L=new i([0,0,0]),M=new k(c,e,j),N=M.tangents,O=M.normals,P=M.binormals;for(this.tangents=N,this.normals=O,this.binormals=P,w=0;K>w;w++)for(I[w]=[],q=w/(K-1),v=c.getPointAt(q),n=N[w],o=O[w],p=P[w],s=f*l(q),x=0;g>x;x++)r=x/g*2*Math.PI,t=-s*Math.cos(r),u=s*Math.sin(r),L.copy(v),L.x+=t*o.x+u*p.x,L.y+=t*o.y+u*p.y,L.z+=t*o.z+u*p.z,I[w][x]=m(L.x,L.y,L.z);for(w=0;e>w;w++)for(x=0;g>x;x++)y=j?(w+1)%e:w+1,z=(x+1)%g,A=I[w][x],B=I[y][x],C=I[y][z],D=I[w][z],E=new h([w/e,x/g]),F=new h([(w+1)/e,x/g]),G=new h([(w+1)/e,(x+1)/g]),H=new h([w/e,(x+1)/g]),this.faces.push(new d(A,B,D)),this.faceVertexUvs[0].push([E,F,H]),this.faces.push(new d(B,C,D)),this.faceVertexUvs[0].push([F.clone(),G,H.clone()]);this.computeFaceNormals(),this.computeVertexNormals()}return f(b,a),b.NoTaper=function(a){return 1},b.SinusoidalTaper=function(a){return Math.sin(Math.PI*a)},b}(e),k=function(){function a(a,b,d){function e(){q[0]=new i([0,0,0]),r[0]=new i([0,0,0]),h=Number.MAX_VALUE,j=Math.abs(p[0].x),k=Math.abs(p[0].y),l=Math.abs(p[0].z),h>=j&&(h=j,o.set(1,0,0)),h>=k&&(h=k,o.set(0,1,0)),h>=l&&o.set(0,0,1),s.crossVectors(p[0],o).normalize(),q[0].crossVectors(p[0],s),r[0].crossVectors(p[0],q[0])}var f,h,j,k,l,m,n,o=new i([0,0,0]),p=[],q=[],r=[],s=new i([0,0,0]),t=g.identity(),u=b+1,v=1e-4;for(this.tangents=p,this.normals=q,this.binormals=r,m=0;u>m;m++)n=m/(u-1),p[m]=a.getTangentAt(n),p[m].normalize();for(e(),m=1;u>m;m++)q[m]=q[m-1].clone(),r[m]=r[m-1].clone(),s.crossVectors(p[m-1],p[m]),s.magnitude()>v&&(s.normalize(),f=Math.acos(c(p[m-1].dot(p[m]),-1,1)),q[m].applyMatrix4(t.rotationAxis(s,f))),r[m].crossVectors(p[m],q[m]);if(d)for(f=Math.acos(c(q[0].dot(q[u-1]),-1,1)),f/=u-1,p[0].dot(s.crossVectors(q[0],q[u-1]))>0&&(f=-f),m=1;u>m;m++)q[m].applyMatrix4(t.rotationAxis(p[m],f*m)),r[m].crossVectors(p[m],q[m])}return a}();return j});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/geometries/VortexGeometry",["require","exports","../core/Face3","../geometries/Geometry3","../math/Vector2","../math/Vector3"],function(a,b,c,d,e,g){var h=function(a){function b(b,d,f,h,i,j,k){function l(a,b){var c=b%n;if(c===n-1)return l(a,b-1);var d=(b-c)/n;return v*(d+c*w)}function m(a){var b=a%n;return b===n-1?d:f}void 0===b&&(b=1),void 0===d&&(d=.08),void 0===f&&(f=.01),void 0===h&&(h=.2),void 0===i&&(i=.8),void 0===j&&(j=8),void 0===k&&(k=12),a.call(this);var n=9;b=b||1,d=d||.08,f=f||.01,h=h||.2,i=i||.8,j=j||8;var o=j*n;k=k||12;for(var p=2*Math.PI,q=b,r=new g([0,0,0]),s=[],t=[],u=i/(h+i),v=p/j,w=u/(n-2),x=0;k>=x;x++)for(var y=p*x/k,z=Math.cos(y),A=Math.sin(y),B=0;o>=B;B++){var C=l(o,B),D=Math.cos(C),E=Math.sin(C);r.x=q*D,r.y=q*E;var F=new g([0,0,0]),G=m(B);F.x=(q+G*z)*D,F.y=(q+G*z)*E,F.z=G*A,this.vertices.push(F),s.push(new e([B/o,x/k])),t.push(F.clone().sub(r).normalize())}for(var x=1;k>=x;x++)for(var B=1;o>=B;B++){var H=(o+1)*x+B-1,I=(o+1)*(x-1)+B-1,J=(o+1)*(x-1)+B,K=(o+1)*x+B,L=new c(H,I,K,[t[H],t[I],t[K]]);this.faces.push(L),this.faceVertexUvs[0].push([s[H].clone(),s[I].clone(),s[K].clone()]),L=new c(I,J,K,[t[I],t[J],t[K]]),this.faces.push(L),this.faceVertexUvs[0].push([s[I].clone(),s[J].clone(),s[K].clone()])}}return f(b,a),b}(d);return h}),b("davinci-eight/programs/shaderProgram",["require","exports","../checks/isDefined","../utils/uuid4","../core/AttribLocation","../core/UniformLocation","../utils/refChange"],function(a,b,c,d,e,f,g){function h(a,b,c){var d=a.createShader(c);a.shaderSource(d,b),a.compileShader(d);var e=a.getShaderParameter(d,a.COMPILE_STATUS);if(e)return d;if(a.isContextLost())throw new Error("Context lost while compiling shader");var f=a.getShaderInfoLog(d);throw a.deleteShader(d),new Error("Error compiling shader: "+f)}function i(a,b,c,d){var e=h(a,b,a.VERTEX_SHADER),f=h(a,c,a.FRAGMENT_SHADER),g=a.createProgram();a.attachShader(g,e),a.attachShader(g,f);for(var i=0;i<d.length;++i)a.bindAttribLocation(g,i,d[i]);a.linkProgram(g);var j=a.getProgramParameter(g,a.LINK_STATUS);if(j||a.isContextLost())return g;var k=a.getProgramInfoLog(g);throw a.detachShader(g,e),a.deleteShader(e),a.detachShader(g,f),a.deleteShader(f),a.deleteProgram(g),new Error("Error linking program: "+k)}var j=function(a,b,h,j){if("string"!=typeof b)throw new Error("vertexShader argument must be a string.");if("string"!=typeof h)throw new Error("fragmentShader argument must be a string.");var k,l,m=1,n=d().generate(),o={},p={},q={get vertexShader(){return b},get fragmentShader(){return h},get attributes(){return o},get uniforms(){return p},addRef:function(){return g(n,1,"ShaderProgram"),m++,m},release:function(){return g(n,-1,"ShaderProgram"),m--,0===m&&q.contextFree(),m},contextFree:function(){if(c(l)){k&&(l.deleteProgram(k),k=void 0),l=void 0;for(var a in o)o[a].contextFree();for(var b in p)p[b].contextFree()}},contextGain:function(c){if(l!==c){q.contextFree(),l=c,k=i(c,b,h,j);for(var d=c.getProgramParameter(k,c.ACTIVE_ATTRIBUTES),g=0;d>g;g++){var m=c.getActiveAttrib(k,g),n=m.name;o[n]||(o[n]=new e(a,n))}for(var r=c.getProgramParameter(k,c.ACTIVE_UNIFORMS),s=0;r>s;s++){var t=c.getActiveUniform(k,s),u=t.name;p[u]||(p[u]=new f(a,u))}for(var v in o)o[v].contextGain(c,k);for(var w in p)p[w].contextGain(c,k)}},contextLoss:function(){k=void 0,l=void 0;for(var a in o)o[a].contextLoss();for(var b in p)p[b].contextLoss()},get program(){return k},get programId(){return n},use:function(){return l?l.useProgram(k):console.warn("shaderProgram.use() missing WebGLRenderingContext"),q},enableAttrib:function(a){var b=o[a];b&&b.enable()},setAttributes:function(a){for(var b in o){var c=o[b],d=a[b];if(!d)throw new Error("The mesh does not support the attribute variable named "+b);d.buffer.bind(l.ARRAY_BUFFER),c.vertexPointer(d.size,d.normalized,d.stride,d.offset)}},uniform1f:function(a,b){var c=p[a];c&&c.uniform1f(b)},uniform2f:function(a,b,c){var d=p[a];d&&d.uniform2f(b,c)},uniform3f:function(a,b,c,d){var e=p[a];e&&e.uniform3f(b,c,d)},uniform4f:function(a,b,c,d,e){var f=p[a];f&&f.uniform4f(b,c,d,e)},uniformMatrix1:function(a,b,c){var d=p[a];d&&d.matrix1(b,c)},uniformMatrix2:function(a,b,c){var d=p[a];d&&d.matrix2(b,c)},uniformMatrix3:function(a,b,c){var d=p[a];d&&d.matrix3(b,c)},uniformMatrix4:function(a,b,c){var d=p[a];d&&d.matrix4(b,c)},uniformVector1:function(a,b){var c=p[a];c&&c.vector1(b)},uniformVector2:function(a,b){var c=p[a];c&&c.vector2(b)},uniformVector3:function(a,b){var c=p[a];c&&c.vector3(b)},uniformVector4:function(a,b){var c=p[a];c&&c.vector4(b)}};return g(n,1,"ShaderProgram"),q};return j}),b("davinci-eight/programs/fragmentShader",["require","exports"],function(a,b){function c(a,b,c,d){var e=[];c&&e.push("varying highp vec4 vColor;"),d&&e.push("varying highp vec3 vLight;"),e.push("void main(void) {");d?c?e.push("  gl_FragColor = vec4(vColor.xyz * vLight, vColor.a);"):e.push("  gl_FragColor = vec4(vLight, 1.0);"):c?e.push("  gl_FragColor = vColor;"):e.push("  gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);"),e.push("}");var f=e.join("\n");return f}return c}),b("davinci-eight/core/getAttribVarName",["require","exports","../checks/isDefined","../checks/expectArg"],function(a,b,c,d){function e(a,b){return d("attribute",a).toBeObject(),d("varName",b).toBeString(),c(a.name)?d("attribute.name",a.name).toBeString().value:b}return e}),b("davinci-eight/core/getUniformVarName",["require","exports","../checks/isDefined","../checks/expectArg"],function(a,b,c,d){function e(a,b){return d("uniform",a).toBeObject(),d("varName",b).toBeString(),c(a.name)?d("uniform.name",a.name).toBeString().value:b}return e}),b("davinci-eight/programs/vertexShader",["require","exports","../core/getAttribVarName","../core/getUniformVarName","../core/Symbolic"],function(a,b,c,d,e){function f(a,b){return d(a[b],b)}function g(a,b,d,g){var r=[];for(var s in a)r.push(i+a[s].glslType+h+c(a[s],s)+l);for(var t in b)r.push(j+b[t].glslType+h+f(b,t)+l);d&&r.push("varying highp vec4 vColor;"),g&&r.push("varying highp vec3 vLight;"),r.push("void main(void) {");var u=[];if(u.unshift(l),a[e.ATTRIBUTE_POSITION]?(u.unshift(n),u.unshift("1.0"),u.unshift(k),u.unshift(c(a[e.ATTRIBUTE_POSITION],e.ATTRIBUTE_POSITION)),u.unshift(m),u.unshift("vec4")):u.unshift("vec4(0.0, 0.0, 0.0, 1.0)"),b[e.UNIFORM_MODEL_MATRIX]&&(u.unshift(o),u.unshift(f(b,e.UNIFORM_MODEL_MATRIX))),b[e.UNIFORM_VIEW_MATRIX]&&(u.unshift(o),u.unshift(f(b,e.UNIFORM_VIEW_MATRIX))),b[e.UNIFORM_PROJECTION_MATRIX]&&(u.unshift(o),u.unshift(f(b,e.UNIFORM_PROJECTION_MATRIX))),u.unshift(p),u.unshift("gl_Position"),u.unshift("  "),r.push(u.join("")),a[e.ATTRIBUTE_COLOR]){var v=c(a[e.ATTRIBUTE_COLOR],e.ATTRIBUTE_COLOR);switch(a[e.ATTRIBUTE_COLOR].glslType){case"vec4":r.push("  vColor = "+v+l);break;case"vec3":r.push("  vColor = vec4("+v+", 1.0);");break;default:throw new Error("Unexpected type for color attribute: "+a[e.ATTRIBUTE_COLOR].glslType)}}else if(b[e.UNIFORM_COLOR]){var w=f(b,e.UNIFORM_COLOR);switch(b[e.UNIFORM_COLOR].glslType){case"vec4":r.push("  vColor = "+w+l);break;case"vec3":r.push("  vColor = vec4("+w+", 1.0);");break;default:throw new Error("Unexpected type for color uniform: "+b[e.UNIFORM_COLOR].glslType)}}g&&(b[e.UNIFORM_DIRECTIONAL_LIGHT_COLOR]&&b[e.UNIFORM_DIRECTIONAL_LIGHT_DIRECTION]&&b[e.UNIFORM_NORMAL_MATRIX]&&a[e.ATTRIBUTE_NORMAL]?(r.push("  vec3 L = normalize("+f(b,e.UNIFORM_DIRECTIONAL_LIGHT_DIRECTION)+");"),r.push("  vec3 N = normalize("+f(b,e.UNIFORM_NORMAL_MATRIX)+" * "+c(a[e.ATTRIBUTE_NORMAL],e.ATTRIBUTE_NORMAL)+");"),r.push("  float "+q+" = max(dot(N, L), 0.0);"),b[e.UNIFORM_AMBIENT_LIGHT]?r.push("  vLight = "+f(b,e.UNIFORM_AMBIENT_LIGHT)+" + "+q+" * "+f(b,e.UNIFORM_DIRECTIONAL_LIGHT_COLOR)+";"):r.push("  vLight = "+q+" * "+f(b,e.UNIFORM_DIRECTIONAL_LIGHT_COLOR)+";")):b[e.UNIFORM_AMBIENT_LIGHT]?r.push("  vLight = "+f(b,e.UNIFORM_AMBIENT_LIGHT)+";"):r.push("  vLight = vec3(1.0, 1.0, 1.0);")),r.push("}");var x=r.join("\n");return x}var h=" ",i="attribute"+h,j="uniform"+h,k=","+h,l=";",m="(",n=")",o=h+"*"+h,p=h+"="+h,q="directionalLightCosineFactor";return g}),b("davinci-eight/programs/smartProgram",["require","exports","../programs/fragmentShader","../checks/isDefined","./shaderProgram","../core/Symbolic","../programs/vertexShader"],function(a,b,c,d,e,f,g){function h(a){return!!a[f.UNIFORM_AMBIENT_LIGHT]||!!a[f.UNIFORM_DIRECTIONAL_LIGHT_COLOR]&&!!a[f.UNIFORM_DIRECTIONAL_LIGHT_COLOR]}function i(a,b){return!!a[f.ATTRIBUTE_COLOR]||!!b[f.UNIFORM_COLOR]}var j=function(a,b,f,j){if(!d(b))throw new Error("The attributes parameter is required for smartProgram.");if(!f)throw new Error("The uniformsList parameter is required for smartProgram.");var k={};f.forEach(function(a){for(var b in a)k[b]=a[b]});var l=i(b,k),m=h(k),n=e(a,g(b,k,l,m),c(b,k,l,m),j),o={get program(){return n.program},get programId(){return n.programId},get attributes(){return n.attributes},get uniforms(){return n.uniforms},get vertexShader(){return n.vertexShader},get fragmentShader(){return n.fragmentShader},addRef:function(){return n.addRef()},release:function(){return n.release()},contextFree:function(){return n.contextFree()},contextGain:function(a){return n.contextGain(a)},contextLoss:function(){return n.contextLoss()},use:function(){return n.use()},enableAttrib:function(a){return n.enableAttrib(a)},setAttributes:function(a){return n.setAttributes(a)},uniform1f:function(a,b){return n.uniform1f(a,b)},uniform2f:function(a,b,c){return n.uniform2f(a,b,c)},uniform3f:function(a,b,c,d){return n.uniform3f(a,b,c,d)},uniform4f:function(a,b,c,d,e){return n.uniform4f(a,b,c,d,e)},uniformMatrix1:function(a,b,c){return n.uniformMatrix1(a,b,c)},uniformMatrix2:function(a,b,c){return n.uniformMatrix2(a,b,c)},uniformMatrix3:function(a,b,c){return n.uniformMatrix3(a,b,c)},uniformMatrix4:function(a,b,c){return n.uniformMatrix4(a,b,c)},uniformVector1:function(a,b){return n.uniformVector1(a,b)},uniformVector2:function(a,b){return n.uniformVector2(a,b)},uniformVector3:function(a,b){return n.uniformVector3(a,b)},uniformVector4:function(a,b){return n.uniformVector4(a,b)}};return o};return j}),b("davinci-eight/programs/programFromScripts",["require","exports","../programs/shaderProgram","../checks/expectArg"],function(a,b,c,d){function e(a,b,e,f,g){function h(a){d("id",a).toBeString();var b=f.getElementById(a);if(b)return b;throw new Error(a+" is not a valid DOM element identifier.")}void 0===g&&(g=[]),d("vsId",b).toBeString(),d("fsId",e).toBeString(),d("$document",f).toBeObject();var i=h(b).textContent,j=h(e).textContent;return c(a,i,j,g)}return e}),b("davinci-eight/resources/Texture",["require","exports"],function(a,b){var c=function(){function a(a){this._refCount=1}return a.prototype.addRef=function(){return this._refCount++,this._refCount},a.prototype.release=function(){return this._refCount--,0===this._refCount&&this.contextFree(),this._refCount},a.prototype.contextFree=function(){this._texture&&(this._context.deleteTexture(this._texture),this._texture=void 0),this._context=void 0},a.prototype.contextGain=function(a){this._context!==a&&(this.contextFree(),this._context=a,this._texture=a.createTexture())},a.prototype.contextLoss=function(){this._texture=void 0,this._context=void 0},a.prototype.bind=function(a){this._context?this._context.bindTexture(a,this._texture):console.warn("Texture.bind(target) missing WebGLRenderingContext.")},a}();return c});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/math/Matrix3",["require","exports","../math/AbstractMatrix"],function(a,b,c){var d=function(a){function b(b){a.call(this,b,9)}return f(b,a),b.identity=function(){return new b(new Float32Array([1,0,0,0,1,0,0,0,1]))},b.prototype.getInverse=function(a,b){var c=a.data,d=this.data;d[0]=c[10]*c[5]-c[6]*c[9],d[1]=-c[10]*c[1]+c[2]*c[9],d[2]=c[6]*c[1]-c[2]*c[5],d[3]=-c[10]*c[4]+c[6]*c[8],d[4]=c[10]*c[0]-c[2]*c[8],d[5]=-c[6]*c[0]+c[2]*c[4],d[6]=c[9]*c[4]-c[5]*c[8],d[7]=-c[9]*c[0]+c[1]*c[8],d[8]=c[5]*c[0]-c[1]*c[4];var e=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===e){var f="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(b||!b)throw new Error(f);return console.warn(f),this.identity(),this}return this.multiplyScalar(1/e),this},b.prototype.identity=function(){return this.set(1,0,0,0,1,0,0,0,1)},b.prototype.multiplyScalar=function(a){var b=this.data;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},b.prototype.normalFromMatrix4=function(a){this.getInverse(a).transpose()},b.prototype.set=function(a,b,c,d,e,f,g,h,i){var j=this.data;return j[0]=a,j[3]=b,j[6]=c,j[1]=d,j[4]=e,j[7]=f,j[2]=g,j[5]=h,j[8]=i,this},b.prototype.transpose=function(){var a,b=this.data;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this},b}(c);return d}),b("davinci-eight/math/Quaternion",["require","exports","../math/Vector3"],function(a,b,c){var d=1e-6,e=function(){function a(a,b,c,d){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),this.onChangeCallback=function(){},this._x=a,this._y=b,this._z=c,this._w=d}return Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(a){this._x=a,this.onChangeCallback()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(a){this._y=a,this.onChangeCallback()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"z",{get:function(){return this._z},set:function(a){this._z=a,this.onChangeCallback()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"w",{get:function(){return this._w},set:function(a){this._w=a,this.onChangeCallback()},enumerable:!0,configurable:!0}),a.prototype.add=function(a){return this},a.prototype.addVectors=function(a,b){return this},a.prototype.set=function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._w=d,this.onChangeCallback(),this},a.prototype.clone=function(){return new a(this._x,this._y,this._z,this._w)},a.prototype.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},a.prototype.copy=function(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this.onChangeCallback(),this},a.prototype.divideScalar=function(a){return this},a.prototype.dot=function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},a.prototype.exp=function(){return this},a.prototype.inverse=function(){return this.conjugate().normalize(),this},a.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},a.prototype.magnitude=function(){return Math.sqrt(this.quaditude())},a.prototype.multiply=function(a){return this.multiplyQuaternions(this,a)},a.prototype.multiplyQuaternions=function(a,b){var c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,i=b._z,j=b._w;return this._x=c*j+f*g+d*i-e*h,this._y=d*j+f*h+e*g-c*i,this._z=e*j+f*i+c*h-d*g,this._w=f*j-c*g-d*h-e*i,this.onChangeCallback(),this},a.prototype.multiplyScalar=function(a){return this},a.prototype.normalize=function(){var a=this.magnitude();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this.onChangeCallback(),this},a.prototype.onChange=function(a){return this.onChangeCallback=a,this},a.prototype.quaditude=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},a.prototype.setFromAxisAngle=function(a,b){var c=b/2,d=Math.sin(c);return this._x=a.x*d,this._y=a.y*d,this._z=a.z*d,this._w=Math.cos(c),this.onChangeCallback(),this},a.prototype.setFromRotationMatrix=function(a){var b,c=a.data,d=c[0],e=c[4],f=c[8],g=c[1],h=c[5],i=c[9],j=c[2],k=c[6],l=c[10],m=d+h+l;return m>0?(b=.5/Math.sqrt(m+1),this._w=.25/b,this._x=(k-i)*b,this._y=(f-j)*b,this._z=(g-e)*b):d>h&&d>l?(b=2*Math.sqrt(1+d-h-l),this._w=(k-i)/b,this._x=.25*b,this._y=(e+g)/b,this._z=(f+j)/b):h>l?(b=2*Math.sqrt(1+h-d-l),this._w=(f-j)/b,this._x=(e+g)/b,this._y=.25*b,this._z=(i+k)/b):(b=2*Math.sqrt(1+l-d-h),this._w=(g-e)/b,this._x=(f+j)/b,this._y=(i+k)/b,this._z=.25*b),this.onChangeCallback(),this},a.prototype.setFromUnitVectors=function(a,b){var e=new c,f=a.dot(b)+1;return d>f?(f=0,Math.abs(a.x)>Math.abs(a.z)?e.set(-a.y,a.x,0):e.set(0,-a.z,a.y)):e.crossVectors(a,b),this._x=e.x,this._y=e.y,this._z=e.z,this._w=f,this.normalize(),this},a.prototype.slerp=function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;if(0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a),g>=1)return this._w=f,this._x=c,this._y=d,this._z=e,this;var h=Math.acos(g),i=Math.sqrt(1-g*g);if(Math.abs(i)<.001)return this._w=.5*(f+this._w),this._x=.5*(c+this._x),this._y=.5*(d+this._y),this._z=.5*(e+this._z),this;var j=Math.sin((1-b)*h)/i,k=Math.sin(b*h)/i;return this._w=f*j+this._w*k,this._x=c*j+this._x*k,this._y=d*j+this._y*k,this._z=e*j+this._z*k,this.onChangeCallback(),this},a.prototype.sub=function(a){return this},a.prototype.equals=function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},a.prototype.fromArray=function(a,b){return void 0===b&&(b=0),this._x=a[b],this._y=a[b+1],this._z=a[b+2],this._w=a[b+3],this.onChangeCallback(),this},a.prototype.toArray=function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._w,a},a.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)},a}();return e});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);
c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/math/Vector4",["require","exports","../math/VectorN"],function(a,b,c){var d=function(a){function b(b,c){void 0===b&&(b=[0,0,0,0]),void 0===c&&(c=!1),a.call(this,b,c,4)}return f(b,a),Object.defineProperty(b.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.modified=this.modified||this.x!==a,this.data[0]=a},enumerable:!0,configurable:!0}),b.prototype.setX=function(a){return this.x=a,this},Object.defineProperty(b.prototype,"y",{get:function(){return this.data[1]},set:function(a){this.modified=this.modified||this.y!==a,this.data[1]=a},enumerable:!0,configurable:!0}),b.prototype.setY=function(a){return this.y=a,this},Object.defineProperty(b.prototype,"z",{get:function(){return this.data[2]},set:function(a){this.modified=this.modified||this.z!==a,this.data[2]=a},enumerable:!0,configurable:!0}),b.prototype.setZ=function(a){return this.z=a,this},Object.defineProperty(b.prototype,"w",{get:function(){return this.data[3]},set:function(a){this.modified=this.modified||this.w!==a,this.data[3]=a},enumerable:!0,configurable:!0}),b.prototype.setW=function(a){return this.w=a,this},b.prototype.add=function(a){return this},b.prototype.addVectors=function(a,b){return this},b.prototype.clone=function(){return new b([this.x,this.y,this.z,this.w])},b.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w,this},b.prototype.divideScalar=function(a){return this.x/=a,this.y/=a,this.z/=a,this.w/=a,this},b.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},b.prototype.multiplyScalar=function(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this},b.prototype.sub=function(a){return this},b}(c);return d}),b("davinci-eight/mesh/adapterOptions",["require","exports","../core/DrawMode","../core/Symbolic"],function(a,b,c,d){function e(a){void 0===a&&(a={wireFrame:!1});var b=a.wireFrame?c.LINES:c.TRIANGLES,e=a.elementUsage,f=a.positionVarName||d.ATTRIBUTE_POSITION,g=a.normalVarName||d.ATTRIBUTE_NORMAL;return{drawMode:b,elementUsage:e,positionVarName:f,normalVarName:g}}return e}),b("davinci-eight/mesh/arrowMesh",["require","exports","../geometries/GeometryAdapter","../geometries/ArrowGeometry","../mesh/adapterOptions","../math/Spinor3"],function(a,b,c,d,e,f){function g(a){a=a||{};var b=1,c=new f,e=12,g=1,h=.01,i=.08;return new d(b,c,e,g,h,i,a.coneHeight,a.axis)}function h(a,b){var d=new c(a,g(b),e(b)),f=1,h={draw:function(){return d.draw()},update:function(){return d.update()},getAttribData:function(){return d.getAttribData()},getAttribMeta:function(){return d.getAttribMeta()},get drawMode(){return d.drawMode},set drawMode(a){d.drawMode=a},get dynamic(){return d.dynamic},addRef:function(){return f++,f},release:function(){return f--,0===f&&(d.release(),d=void 0),f},contextFree:function(){return d.contextFree()},contextGain:function(a){return d.contextGain(a)},contextLoss:function(){return d.contextLoss()}};return h}return h}),b("davinci-eight/mesh/ArrowBuilder",["require","exports","../checks/expectArg","../checks/isUndefined","../mesh/arrowMesh","../math/Vector3"],function(a,b,c,d,e,f){var g=function(){function a(a){this.$axis=f.e3.clone(),a=a||{modelMatrix:"uModelMatrix"},this.setFlavor(d(a.flavor)?0:a.flavor),this.setWireFrame(d(a.wireFrame)?!1:a.wireFrame)}return Object.defineProperty(a.prototype,"axis",{get:function(){return this.$axis},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"flavor",{get:function(){return this.$flavor},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.$height},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"depth",{get:function(){return this.$depth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"widthSegments",{get:function(){return this.$widthSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"heightSegments",{get:function(){return this.$heightSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"depthSegments",{get:function(){return this.$depthSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"coneHeight",{get:function(){return this.$coneHeight},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"wireFrame",{get:function(){return this.$wireFrame},enumerable:!0,configurable:!0}),a.prototype.setAxis=function(a){return c("axis",a).toBeObject(),this.$axis.copy(a),this},a.prototype.setFlavor=function(a){return c("flavor",a).toBeNumber().toSatisfy(a>=0,"flavor must be greater than or equal to zero."),this.$flavor=a,this},a.prototype.setHeight=function(a){return c("height",a).toBeNumber().toSatisfy(a>=0,"height must be greater than or equal to zero."),this.$height=a,this},a.prototype.setDepth=function(a){return c("depth",a).toBeNumber().toSatisfy(a>=0,"depth must be greater than or equal to zero."),this.$depth=a,this},a.prototype.setWidthSegments=function(a){return c("widthSegments",a).toBeNumber().toSatisfy(a>0,"widthSegments must be greater than zero."),this.$widthSegments=a,this},a.prototype.setHeightSegments=function(a){return c("heightSegments",a).toBeNumber().toSatisfy(a>0,"heightSegments must be greater than zero."),this.$heightSegments=a,this},a.prototype.setDepthSegments=function(a){return c("depthSegments",a).toBeNumber().toSatisfy(a>0,"depthSegments must be greater than zero."),this.$depthSegments=a,this},a.prototype.setConeHeight=function(a){return c("coneHeight",a).toBeNumber().toSatisfy(a>=0,"coneHeight must be positive."),this.$coneHeight=a,this},a.prototype.setWireFrame=function(a){return c("wireFrame",a).toBeBoolean(),this.$wireFrame=a,this},a.prototype.buildMesh=function(a){return e(a,this)},a}();return g}),b("davinci-eight/mesh/boxMesh",["require","exports","../geometries/GeometryAdapter","../geometries/BoxGeometry","../mesh/adapterOptions"],function(a,b,c,d,e){function f(a){return a=a||{},new d(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments,a.wireFrame)}function g(a,b){var d=new c(a,f(b),e(b));d.addRef();var g=1,h={draw:function(){return d.draw()},update:function(){return d.update()},getAttribData:function(){return d.getAttribData()},getAttribMeta:function(){return d.getAttribMeta()},get drawMode(){return d.drawMode},set drawMode(a){d.drawMode=a},get dynamic(){return d.dynamic},addRef:function(){return g++,g},release:function(){return g--,0===g&&(d.release(),d=void 0),g},contextFree:function(){return d.contextFree()},contextGain:function(a){return d.contextGain(a)},contextLoss:function(){return d.contextLoss()}};return h}return g}),b("davinci-eight/mesh/BoxBuilder",["require","exports","../checks/expectArg","../checks/isUndefined","../mesh/boxMesh","../core/Symbolic"],function(a,b,c,d,e,f){var g=function(){function a(a){a=a||{},this.setWidth(d(a.width)?1:a.width),this.setHeight(d(a.height)?1:a.height),this.setDepth(d(a.depth)?1:a.depth),this.setWidthSegments(d(a.widthSegments)?1:a.widthSegments),this.setHeightSegments(d(a.heightSegments)?1:a.heightSegments),this.setDepthSegments(d(a.depthSegments)?1:a.depthSegments),this.setWireFrame(d(a.wireFrame)?!1:a.wireFrame),this.setPositionVarName(d(a.positionVarName)?f.ATTRIBUTE_POSITION:a.positionVarName),this.setNormalVarName(d(a.normalVarName)?f.ATTRIBUTE_NORMAL:a.normalVarName)}return Object.defineProperty(a.prototype,"width",{get:function(){return this.$width},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.$height},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"depth",{get:function(){return this.$depth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"widthSegments",{get:function(){return this.$widthSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"heightSegments",{get:function(){return this.$heightSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"depthSegments",{get:function(){return this.$depthSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"wireFrame",{get:function(){return this.$wireFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"positionVarName",{get:function(){return this.$positionVarName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"normalVarName",{get:function(){return this.$normalVarName},enumerable:!0,configurable:!0}),a.prototype.setWidth=function(a){return c("width",a).toBeNumber().toSatisfy(a>=0,"width must be greater than or equal to zero."),this.$width=a,this},a.prototype.setHeight=function(a){return c("height",a).toBeNumber().toSatisfy(a>=0,"height must be greater than or equal to zero."),this.$height=a,this},a.prototype.setDepth=function(a){return c("depth",a).toBeNumber().toSatisfy(a>=0,"depth must be greater than or equal to zero."),this.$depth=a,this},a.prototype.setWidthSegments=function(a){return c("widthSegments",a).toBeNumber().toSatisfy(a>0,"widthSegments must be greater than zero."),this.$widthSegments=a,this},a.prototype.setHeightSegments=function(a){return c("heightSegments",a).toBeNumber().toSatisfy(a>0,"heightSegments must be greater than zero."),this.$heightSegments=a,this},a.prototype.setDepthSegments=function(a){return c("depthSegments",a).toBeNumber().toSatisfy(a>0,"depthSegments must be greater than zero."),this.$depthSegments=a,this},a.prototype.setWireFrame=function(a){return c("wireFrame",a).toBeBoolean(),this.$wireFrame=a,this},a.prototype.setPositionVarName=function(a){return c("positionVarName",a).toBeString(),this.$positionVarName=a,this},a.prototype.setNormalVarName=function(a){return c("normalVarName",a).toBeString(),this.$normalVarName=a,this},a.prototype.buildMesh=function(a){return e(a,this)},a}();return g}),b("davinci-eight/mesh/cylinderMesh",["require","exports","../geometries/GeometryAdapter","../geometries/CylinderGeometry","../mesh/adapterOptions"],function(a,b,c,d,e){function f(a){return a=a||{},new d(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}function g(a,b){var d=new c(a,f(b),e(b)),g=1,h={draw:function(){return d.draw()},update:function(){return d.update()},getAttribData:function(){return d.getAttribData()},getAttribMeta:function(){return d.getAttribMeta()},get drawMode(){return d.drawMode},set drawMode(a){d.drawMode=a},get dynamic(){return d.dynamic},addRef:function(){return g++,g},release:function(){return g--,0===g&&(d.release(),d=void 0),g},contextFree:function(){return d.contextFree()},contextGain:function(a){return d.contextGain(a)},contextLoss:function(){return d.contextLoss()}};return h}return g}),b("davinci-eight/mesh/CylinderArgs",["require","exports","../checks/expectArg","../checks/isUndefined","../math/Vector3"],function(a,b,c,d,e){var f=function(){function a(a){this.$axis=e.e3.clone(),a=a||{modelMatrix:"uModelMatrix"},this.setRadiusTop(d(a.radiusTop)?1:a.radiusTop),this.setRadiusBottom(d(a.radiusBottom)?1:a.radiusBottom),this.setHeight(d(a.height)?1:a.height),this.setRadialSegments(d(a.radialSegments)?16:a.radialSegments),this.setHeightSegments(d(a.heightSegments)?1:a.heightSegments),this.setOpenEnded(d(a.openEnded)?!1:a.openEnded),this.setThetaStart(d(a.thetaStart)?0:a.thetaStart),this.setThetaLength(d(a.thetaLength)?2*Math.PI:a.thetaLength),this.setWireFrame(d(a.wireFrame)?!1:a.wireFrame)}return Object.defineProperty(a.prototype,"radiusTop",{get:function(){return this.$radiusTop},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"radiusBottom",{get:function(){return this.$radiusBottom},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.$height},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"radialSegments",{get:function(){return this.$radialSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"heightSegments",{get:function(){return this.$heightSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"openEnded",{get:function(){return this.$openEnded},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"thetaStart",{get:function(){return this.$thetaStart},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"thetaLength",{get:function(){return this.$thetaLength},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"wireFrame",{get:function(){return this.$wireFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"axis",{get:function(){return this.$axis},enumerable:!0,configurable:!0}),a.prototype.setRadiusTop=function(a){return c("radiusTop",a).toBeNumber().toSatisfy(a>=0,"radiusTop must be greater than or equal to zero."),this.$radiusTop=a,this},a.prototype.setRadiusBottom=function(a){return c("radiusBottom",a).toBeNumber().toSatisfy(a>=0,"radiusBottom must be greater than or equal to zero."),this.$radiusBottom=a,this},a.prototype.setHeight=function(a){return c("height",a).toBeNumber().toSatisfy(a>=0,"height must be greater than or equal to zero."),this.$height=a,this},a.prototype.setRadialSegments=function(a){return c("radialSegments",a).toBeNumber(),this.$radialSegments=a,this},a.prototype.setHeightSegments=function(a){return c("heightSegments",a).toBeNumber(),this.$heightSegments=a,this},a.prototype.setOpenEnded=function(a){return c("openEnded",a).toBeBoolean(),this.$openEnded=a,this},a.prototype.setThetaStart=function(a){return c("thetaStart",a).toBeNumber(),this.$thetaStart=a,this},a.prototype.setThetaLength=function(a){return c("thetaLength",a).toBeNumber(),this.$thetaLength=a,this},a.prototype.setWireFrame=function(a){return c("wireFrame",a).toBeBoolean(),this.$wireFrame=a,this},a.prototype.setAxis=function(a){return c("axis",a).toBeObject(),this.$axis.copy(a),this},a}();return f});var f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};b("davinci-eight/mesh/CylinderMeshBuilder",["require","exports","../mesh/CylinderArgs","../mesh/cylinderMesh"],function(a,b,c,d){var e=function(a){function b(b){a.call(this,b)}return f(b,a),b.prototype.setRadiusTop=function(b){return a.prototype.setRadiusTop.call(this,b),this},b.prototype.setRadiusBottom=function(b){return a.prototype.setRadiusBottom.call(this,b),this},b.prototype.setHeight=function(b){return a.prototype.setHeight.call(this,b),this},b.prototype.setRadialSegments=function(b){return a.prototype.setRadialSegments.call(this,b),this},b.prototype.setHeightSegments=function(b){return a.prototype.setHeightSegments.call(this,b),this},b.prototype.setOpenEnded=function(b){return a.prototype.setOpenEnded.call(this,b),this},b.prototype.setThetaStart=function(b){return a.prototype.setThetaStart.call(this,b),this},b.prototype.setThetaLength=function(b){return a.prototype.setThetaLength.call(this,b),this},b.prototype.setWireFrame=function(b){return a.prototype.setWireFrame.call(this,b),this},b.prototype.buildMesh=function(a){return d(a,this)},b}(c);return e}),b("davinci-eight/mesh/sphereMesh",["require","exports","../geometries/GeometryAdapter","../geometries/SphereGeometry","../mesh/adapterOptions"],function(a,b,c,d,e){function f(a){return a=a||{},new d(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)}function g(a,b){var d=new c(a,f(b),e(b)),g=1,h={draw:function(){return d.draw()},update:function(){return d.update()},getAttribData:function(){return d.getAttribData()},getAttribMeta:function(){return d.getAttribMeta()},get drawMode(){return d.drawMode},set drawMode(a){d.drawMode=a},get dynamic(){return d.dynamic},addRef:function(){return g++,g},release:function(){return g--,0===g&&(d.release(),d=void 0),g},contextFree:function(){return d.contextFree()},contextGain:function(a){return d.contextGain(a)},contextLoss:function(){return d.contextLoss()}};return h}return g}),b("davinci-eight/mesh/SphereBuilder",["require","exports","../checks/expectArg","../checks/isUndefined","../mesh/sphereMesh"],function(a,b,c,d,e){var f=function(){function a(a){a=a||{},this.setRadius(d(a.radius)?1:a.radius),this.setPhiStart(d(a.phiStart)?0:a.phiStart),this.setPhiLength(d(a.phiLength)?2*Math.PI:a.phiLength),this.setThetaStart(d(a.thetaStart)?0:a.thetaStart),this.setThetaLength(d(a.thetaLength)?Math.PI:a.thetaLength),this.setWidthSegments(d(a.widthSegments)?16:a.widthSegments),this.setHeightSegments(d(a.heightSegments)?12:a.heightSegments),this.setWireFrame(d(a.wireFrame)?!1:a.wireFrame)}return Object.defineProperty(a.prototype,"radius",{get:function(){return this.$radius},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"phiStart",{get:function(){return this.$phiStart},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"phiLength",{get:function(){return this.$phiLength},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"thetaStart",{get:function(){return this.$thetaStart},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"thetaLength",{get:function(){return this.$thetaLength},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"widthSegments",{get:function(){return this.$widthSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"heightSegments",{get:function(){return this.$heightSegments},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"wireFrame",{get:function(){return this.$wireFrame},enumerable:!0,configurable:!0}),a.prototype.setRadius=function(a){return c("radius",a).toBeNumber().toSatisfy(a>=0,"radius must be greater than or equal to zero."),this.$radius=a,this},a.prototype.setPhiStart=function(a){return c("phiStart",a).toBeNumber(),this.$phiStart=a,this},a.prototype.setPhiLength=function(a){return c("phiLength",a).toBeNumber(),this.$phiLength=a,this},a.prototype.setThetaStart=function(a){return c("thetaStart",a).toBeNumber(),this.$thetaStart=a,this},a.prototype.setThetaLength=function(a){return c("thetaLength",a).toBeNumber(),this.$thetaLength=a,this},a.prototype.setWidthSegments=function(a){return c("widthSegments",a).toBeNumber().toSatisfy(a>0,"widthSegments must be greater than zero."),this.$widthSegments=a,this},a.prototype.setHeightSegments=function(a){return c("heightSegments",a).toBeNumber().toSatisfy(a>0,"heightSegments must be greater than zero."),this.$heightSegments=a,this},a.prototype.setWireFrame=function(a){return c("wireFrame",a).toBeBoolean(),this.$wireFrame=a,this},a.prototype.buildMesh=function(a){return e(a,this)},a}();return f}),b("davinci-eight/mesh/checkMeshArgs",["require","exports"],function(a,b){function c(a){a=a||{};var b="undefined"==typeof a.wireFrame?!1:a.wireFrame;return{wireFrame:b}}return c}),b("davinci-eight/mesh/vortexMesh",["require","exports","../geometries/GeometryAdapter","../geometries/VortexGeometry","../mesh/adapterOptions","../mesh/checkMeshArgs"],function(a,b,c,d,e,f){function g(a){return new d}function h(a,b){var d=f(b),h=new c(a,g(d),e(d)),i=1,j={draw:function(){return h.draw()},update:function(){return h.update()},getAttribData:function(){return h.getAttribData()},getAttribMeta:function(){return h.getAttribMeta()},get drawMode(){return h.drawMode},set drawMode(a){h.drawMode=a},get dynamic(){return h.dynamic},addRef:function(){return i++,i},release:function(){return i--,0===i&&(h.release(),h=void 0),i},contextFree:function(){return h.contextFree()},contextGain:function(a){return h.contextGain(a)},contextLoss:function(){return h.contextLoss()}};return j}return h}),b("davinci-eight/renderers/initWebGL",["require","exports"],function(a,b){function c(a,b){var c;try{c=a.getContext("webgl",b)||a.getContext("experimental-webgl",b)}catch(d){}if(c)return c;throw new Error("Unable to initialize WebGL. Your browser may not support it.")}return c}),b("davinci-eight/renderers/renderer",["require","exports","../core/Color","../checks/expectArg"],function(a,b,c,d){var e=function(){function a(){}return a.prototype.primitive=function(a,b,c){a.dynamic&&a.update(),b.use(),c.accept(b),b.setAttributes(a.getAttribData());var d=b.attributes;Object.keys(d).forEach(function(a){d[a].enable()}),a.draw(),Object.keys(d).forEach(function(a){d[a].disable()})},a}(),f=new e,g=function(a,b){function e(a){a.accept(f)}d("canvas",a).toSatisfy(a instanceof HTMLCanvasElement,"canvas argument must be an HTMLCanvasElement"),b=b||{};var g=void 0,h=1,i=!0,j=c.fromRGB(0,0,0),k=0,l={get canvas(){return a},get context(){return g},addRef:function(){return h++,h},release:function(){return h--,0===h&&(g=void 0),h},contextFree:function(){g=void 0},contextGain:function(b){g=b,b.clearColor(j.r,j.g,j.b,k),b.clearDepth(1),b.enable(g.DEPTH_TEST),b.depthFunc(g.LEQUAL),b.viewport(0,0,a.width,a.height)},contextLoss:function(){g=void 0},get autoClear(){return i},set autoClear(a){i=d("autoClear",a).toBeBoolean().value},clearColor:function(a,b,c,e){j.r=d("red",a).toBeNumber().value,j.g=d("green",b).toBeNumber().value,j.b=d("blue",c).toBeNumber().value,k=d("alpha",e).toBeNumber().value,g&&g.clearColor(a,b,c,e)},render:function(a){g?i&&g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT):console.warn("renderer is unable to clear because WebGLRenderingContext is missing"),a.traverse(e)}};return l};return g}),b("davinci-eight/utils/IUnknownMap",["require","exports","../utils/refChange","../utils/uuid4"],function(a,b,c,d){var e="IUnknownMap",f=function(){function a(){this._refCount=1,this._elements={},this._uuid=d().generate(),c(this._uuid,1,e)}return a.prototype.addRef=function(){return c(this._uuid,1,e),this._refCount++,this._refCount},a.prototype.release=function(){if(c(this._uuid,-1,e),this._refCount--,0===this._refCount){var a=this;this.forEach(function(b){a.put(b,void 0)}),this._elements=void 0}return this._refCount},a.prototype.exists=function(a){var b=this._elements[a];return b?!0:!1},a.prototype.get=function(a){var b=this._elements[a];return b?(b.addRef(),b):void 0},a.prototype.put=function(a,b){var c=this._elements[a];c?b?c===b||(c.release(),b.addRef(),this._elements[a]=b):(c.release(),this._elements[a]=void 0):b&&(b.addRef(),this._elements[a]=b)},a.prototype.forEach=function(a){var b,c=this.keys,d=c.length;for(b=0;d>b;b++){var e=c[b];a(e)}},Object.defineProperty(a.prototype,"keys",{get:function(){return Object.keys(this._elements)},enumerable:!0,configurable:!0}),a.prototype.remove=function(a){this.put(a,void 0),delete this._elements[a]},a}();return f}),b("davinci-eight/utils/RefCount",["require","exports","../checks/expectArg"],function(a,b,c){var d=function(){function a(a){this._refCount=1,c("callback",a).toBeFunction(),this._callback=a}return a.prototype.addRef=function(){return this._refCount++,this._refCount},a.prototype.release=function(){if(this._refCount>0){if(this._refCount--,0===this._refCount){var a=this._callback;this._callback=void 0,a()}return this._refCount}console.warn("release() called with refCount already "+this._refCount)},a}();return d}),b("davinci-eight/utils/contextProxy",["require","exports","../core/ArrayBuffer","../dfx/Elements","../renderers/initWebGL","../checks/expectArg","../checks/isDefined","../utils/IUnknownMap","../utils/RefCount","../utils/refChange","../resources/Texture","../utils/uuid4"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a,b){switch(f("mode",a).toBeNumber(),a){case b.TRIANGLES:return!0;default:return!1}}function n(a,b){switch(f("usage",a).toBeNumber(),a){case b.STATIC_DRAW:return!0;default:return!1}}function o(a){return f("meshUUID",a).toBeString(),a+" is not a recognized mesh uuid"}function p(a,b){if(b){var c=b[a];return c?c:a}return a}function q(a,b){function q(a){f("user",a).toBeObject(),A.push(a),a.addRef(),x&&a.contextGain(x)}function u(a){f("user",a).toBeObject();var b=A.indexOf(a);if(b>=0){var c=A.splice(b,1);c.forEach(function(a){a.release()})}}function v(a){return function(){z.exists(a)?z.remove(a):console.warn("[System Error] "+o(a))}}function w(a){var b=new i(v(a)),c=void 0,d={addRef:function(){return j(a,1,"Mesh"),b.addRef()},release:function(){return j(a,-1,"Mesh"),b.release()},get uuid(){return a},bind:function(b,e){if(c!==b){c&&d.unbind();var g=z.get(a);if(!g)throw new Error(o(a));if(b){c=b,c.addRef();var h=g.indexBuffer;h.bind(x.ELEMENT_ARRAY_BUFFER),h.release();var i,j=Object.keys(b.attributes),k=j.length;for(i=0;k>i;i++){var l=j[i],m=p(l,e),n=g.attributes,q=n.get(m);if(q){var r=q.buffer;r.bind(x.ARRAY_BUFFER);var s=b.attributes[l];s.vertexPointer(q.size,q.normalized,q.stride,q.offset),r.unbind(x.ARRAY_BUFFER),s.enable(),r.release(),q.release()}else console.warn("program attribute "+l+" is not satisfied by the mesh");n.release()}}else f("program",b).toBeObject();g.release()}},draw:function(){var b=z.get(a);if(!b)throw new Error(o(a));b.drawCommand.execute(x),b.release()},unbind:function(){if(c){var b=z.get(a);if(!b)throw new Error(o(a));var d=b.indexBuffer;d.unbind(x.ELEMENT_ARRAY_BUFFER),d.release(),Object.keys(c.attributes).forEach(function(a){c.attributes[a].disable()}),b.release(),c.release(),c=void 0}}};return j(a,1,"Mesh"),d}f("canvas",a).toSatisfy(a instanceof HTMLCanvasElement,"canvas argument must be an HTMLCanvasElement");var x,y=l().generate(),z=new h,A=[],B=1,C=!0,D=(f("token",""),function(a){a.preventDefault(),x=void 0,A.forEach(function(a){a.contextLoss()})}),E=function(c){c.preventDefault(),x=e(a,b),A.forEach(function(a){a.contextGain(x)})},F={createMesh:function(a,b,c){f("elements",a).toSatisfy(a instanceof d,"elements must be an instance of Elements"),f("mode",b).toSatisfy(m(b,x),"mode must be one of TRIANGLES, ..."),g(c)?f("usage",c).toSatisfy(n(c,x),"usage must be on of STATIC_DRAW, ..."):c=x.STATIC_DRAW;var e=w(l().generate()),i=F.vertexBuffer();i.bind(x.ELEMENT_ARRAY_BUFFER),x.bufferData(x.ELEMENT_ARRAY_BUFFER,new Uint16Array(a.indices.data),c),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,null);var j,k=new h,o=Object.keys(a.attributes),p=o.length;for(j=0;p>j;j++){var q=o[j],u=F.vertexBuffer();u.bind(x.ARRAY_BUFFER);var v=a.attributes[q],y=v.vector.data;x.bufferData(x.ARRAY_BUFFER,new Float32Array(y),c);var A=new t(u,v.size,!1,0,0);k.put(q,A),A.release(),u.unbind(x.ARRAY_BUFFER),u.release()}var B=new r(b,a.indices.length,x.UNSIGNED_SHORT,0),C=new s(i,k,B);return z.put(e.uuid,C),C.release(),k.release(),i.release(),e},start:function(){return x=e(a,b),a.addEventListener("webglcontextlost",D,!1),a.addEventListener("webglcontextrestored",E,!1),A.forEach(function(a){a.contextGain(x)}),F},stop:function(){return x=void 0,A.forEach(function(a){a.contextFree()}),a.removeEventListener("webglcontextrestored",E,!1),a.removeEventListener("webglcontextlost",D,!1),F},addContextUser:function(a){return q(a),F},removeContextUser:function(a){return u(a),F},get context(){return g(x)?x:void console.warn("property context: WebGLRenderingContext is not defined. Either context has been lost or start() not called.")},addRef:function(){return j(y,1,"RenderingContextMonitor"),B++,B},release:function(){if(j(y,-1,"RenderingContextMonitor"),B--,0===B)for(z.release();A.length>0;){var a=A.pop();a.release()}return B},clearColor:function(a,b,c,d){return x?x.clearColor(a,b,c,d):void 0},clearDepth:function(a){return x?x.clearDepth(a):void 0},drawArrays:function(a,b,c){return x?x.drawArrays(a,b,c):void 0},drawElements:function(a,b,c,d){return x?x.drawElements(a,b,c,d):void 0},depthFunc:function(a){return x?x.depthFunc(a):void 0},enable:function(a){return x?x.enable(a):void 0},texture:function(){var a=new k(F);return F.addContextUser(a),a},vertexBuffer:function(){var a=new c(F);return F.addContextUser(a),a},get mirror(){return C},set mirror(a){C=f("mirror",a).toBeBoolean().value}};return j(y,1,"RenderingContextMonitor"),F}var r=function(){function a(a,b,c,d){this.mode=a,this.count=b,this.type=c,this.offset=d}return a.prototype.execute=function(a){a.drawElements(this.mode,this.count,this.type,this.offset)},a}(),s=function(){function a(a,b,c){this._refCount=1,this._uuid=l().generate(),this._indexBuffer=a,this._indexBuffer.addRef(),this._attributes=b,this._attributes.addRef(),this.drawCommand=c,j(this._uuid,1,"ElementsBlock")}return Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer.addRef(),this._indexBuffer},enumerable:!0,configurable:!0}),a.prototype.addRef=function(){return this._refCount++,j(this._uuid,1,"ElementsBlock"),this._refCount},a.prototype.release=function(){return this._refCount--,j(this._uuid,-1,"ElementsBlock"),0===this._refCount&&(this._attributes.release(),this._indexBuffer.release()),this._refCount},Object.defineProperty(a.prototype,"attributes",{get:function(){return this._attributes.addRef(),this._attributes},enumerable:!0,configurable:!0}),a}(),t=function(){function a(a,b,c,d,e){this._refCount=1,this._uuid=l().generate(),this._buffer=a,this._buffer.addRef(),this.size=b,this.normalized=c,this.stride=d,this.offset=e,j(this._uuid,1,"ElementsBlockAttrib")}return a.prototype.addRef=function(){return j(this._uuid,1,"ElementsBlockAttrib"),this._refCount++,this._refCount},a.prototype.release=function(){return j(this._uuid,-1,"ElementsBlockAttrib"),this._refCount--,0===this._refCount&&this._buffer.release(),this._refCount},Object.defineProperty(a.prototype,"buffer",{get:function(){return this._buffer.addRef(),this._buffer},enumerable:!0,configurable:!0}),a}();return q}),b("davinci-eight/utils/Model",["require","exports","../math/Matrix3","../math/Matrix4","../math/Spinor3","../math/Vector3"],function(a,b,c,d,e,f){var g=function(){function a(){this.position=new f,this.attitude=new e,this.scale=new f([1,1,1]),this.color=new f([1,1,1]),this.position.modified=!0,this.attitude.modified=!0,this.scale.modified=!0,this.color.modified=!0}return a.prototype.accept=function(a){var b=d.identity();b.scaling(this.scale);var e=d.identity();e.translation(this.position);var f=d.identity();f.rotation(this.attitude);var g=e.mul(f.mul(b)),h=c.identity();h.normalFromMatrix4(g),a.uniformMatrix4("uModelMatrix",!1,g),a.uniformMatrix3("uNormalMatrix",!1,h),a.uniformVector3("uColor",this.color)},a}();return g}),b("davinci-eight/utils/workbench3D",["require","exports"],function(a,b){function c(a,b){for(var c=a.getElementsByTagName(b),d=c.length-1;d>=0;d--){var e=c[d];e.parentNode.removeChild(e)}}var d="resize",e="canvas",f=function(a,b,f,g){function h(){var a=g.innerWidth,c=g.innerHeight;b.setSize(a,c),f.aspect=a/c}void 0===g&&(g=window);var i=g.document,j=function(a){h()},k={setUp:function(){i.body.insertBefore(a,i.body.firstChild),g.addEventListener(d,j,!1),h()},tearDown:function(){g.removeEventListener(d,j,!1),c(i,e)}};return k};return f}),b("davinci-eight/utils/windowAnimationRunner",["require","exports","../checks/expectArg"],function(a,b,c){function d(){}function e(a){if(a){var b="Exception raised during animate function: "+a;console.warn(b)}}function f(a){return!1}var g=function(a,b){var g=1,h=2,i=3;b=b||{};var j,k,l=c("options.window",b.window||window).toNotBeNull().value,m=c("options.setUp",b.setUp||d).value,n=c("options.tearDown",b.tearDown||e).value,o=c("options.terminate",b.terminate||f).toNotBeNull().value,p=!1,q=0,r=1e3,s=null,t=g,u=function(b){if(j&&(q=q+b-j),j=b,p||o(q/r)){p=!1,l.cancelAnimationFrame(s),w.isRunning?(t=i,j=void 0):console.error("stopSignal received while not running."),l.document.removeEventListener("keydown",v,!1);try{n(k)}catch(c){console.warn("Exception raised during tearDown function: "+c)}}else{s=l.requestAnimationFrame(u);try{a(q/r)}catch(c){k=c,p=!0}}},v=function(a){27===a.keyCode&&(p=!0,a.preventDefault())},w={start:function(){if(w.isRunning)throw new Error("The `start` method may only be called when not running.");m(),l.document.addEventListener("keydown",v,!1),t=h,s=l.requestAnimationFrame(u)},stop:function(){if(!w.isRunning)throw new Error("The `stop` method may only be called when running.");p=!0},reset:function(){if(!w.isPaused)throw new Error("The `reset` method may only be called when paused.");j=void 0,q=0,t=g},get time(){return q/r},lap:function(){if(!w.isRunning)throw new Error("The `lap` method may only be called when running.");
},get isRunning(){return t===h},get isPaused(){return t===i}};return w};return g}),b("davinci-eight",["require","exports","davinci-eight/cameras/frustum","davinci-eight/cameras/frustumMatrix","davinci-eight/cameras/perspective","davinci-eight/cameras/perspectiveMatrix","davinci-eight/cameras/view","davinci-eight/cameras/viewMatrix","davinci-eight/core/AttribLocation","davinci-eight/core/DefaultAttribProvider","davinci-eight/core/Color","davinci-eight/core","davinci-eight/core/DrawMode","davinci-eight/core/Face3","davinci-eight/objects/primitive","davinci-eight/core/UniformLocation","davinci-eight/curves/Curve","davinci-eight/dfx/Elements","davinci-eight/dfx/Simplex","davinci-eight/dfx/Vertex","davinci-eight/dfx/computeFaceNormals","davinci-eight/dfx/cube","davinci-eight/dfx/quad","davinci-eight/dfx/square","davinci-eight/dfx/triangles","davinci-eight/drawLists/scene","davinci-eight/geometries/Geometry3","davinci-eight/geometries/GeometryAdapter","davinci-eight/geometries/ArrowGeometry","davinci-eight/geometries/BarnGeometry","davinci-eight/geometries/BoxGeometry","davinci-eight/geometries/CylinderGeometry","davinci-eight/geometries/DodecahedronGeometry","davinci-eight/geometries/EllipticalCylinderGeometry","davinci-eight/geometries/IcosahedronGeometry","davinci-eight/geometries/KleinBottleGeometry","davinci-eight/geometries/MobiusStripGeometry","davinci-eight/geometries/OctahedronGeometry","davinci-eight/geometries/SurfaceGeometry","davinci-eight/geometries/PolyhedronGeometry","davinci-eight/geometries/RevolutionGeometry","davinci-eight/geometries/SphereGeometry","davinci-eight/geometries/TetrahedronGeometry","davinci-eight/geometries/TubeGeometry","davinci-eight/geometries/VortexGeometry","davinci-eight/programs/shaderProgram","davinci-eight/programs/smartProgram","davinci-eight/programs/programFromScripts","davinci-eight/resources/Texture","davinci-eight/core/ArrayBuffer","davinci-eight/math/Matrix3","davinci-eight/math/Matrix4","davinci-eight/math/Quaternion","davinci-eight/math/Spinor3","davinci-eight/math/Vector1","davinci-eight/math/Vector2","davinci-eight/math/Vector3","davinci-eight/math/Vector4","davinci-eight/math/VectorN","davinci-eight/mesh/arrowMesh","davinci-eight/mesh/ArrowBuilder","davinci-eight/mesh/boxMesh","davinci-eight/mesh/BoxBuilder","davinci-eight/mesh/cylinderMesh","davinci-eight/mesh/CylinderArgs","davinci-eight/mesh/CylinderMeshBuilder","davinci-eight/mesh/sphereMesh","davinci-eight/mesh/SphereBuilder","davinci-eight/mesh/vortexMesh","davinci-eight/renderers/initWebGL","davinci-eight/renderers/renderer","davinci-eight/utils/contextProxy","davinci-eight/utils/Model","davinci-eight/utils/refChange","davinci-eight/utils/workbench3D","davinci-eight/utils/windowAnimationRunner"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va){var wa={VERSION:l.VERSION,get initWebGL(){return pa},get Model(){return sa},get Simplex(){return s},get Vertex(){return t},get frustum(){return c},get frustumMatrix(){return d},get perspective(){return e},get perspectiveMatrix(){return f},get view(){return g},get viewMatrix(){return h},get scene(){return z},get renderer(){return qa},get webgl(){return ra},workbench:ua,animation:va,get DefaultAttribProvider(){return j},get primitive(){return o},get DrawMode(){return m},get AttribLocation(){return i},get UniformLocation(){return p},get shaderProgram(){return T},get smartProgram(){return U},get Color(){return k},get Face3(){return n},get Geometry3(){return A},get GeometryAdapter(){return B},get ArrowGeometry(){return C},get BarnGeometry(){return D},get BoxGeometry(){return E},get CylinderGeometry(){return F},get DodecahedronGeometry(){return G},get EllipticalCylinderGeometry(){return H},get IcosahedronGeometry(){return I},get KleinBottleGeometry(){return J},get MobiusStripGeometry(){return K},get OctahedronGeometry(){return L},get SurfaceGeometry(){return M},get PolyhedronGeometry(){return N},get RevolutionGeometry(){return O},get SphereGeometry(){return P},get TetrahedronGeometry(){return Q},get TubeGeometry(){return R},get VortexGeometry(){return S},get Matrix3(){return Y},get Matrix4(){return Z},get Spinor3(){return _},get Quaternion(){return $},get Vector1(){return aa},get Vector2(){return ba},get Vector3(){return ca},get Vector4(){return da},get VectorN(){return ea},get Curve(){return q},get arrowMesh(){return fa},get ArrowBuilder(){return ga},get boxMesh(){return ha},get BoxBuilder(){return ia},get computeFaceNormals(){return u},get cube(){return v},get quad(){return w},get square(){return x},get CylinderArgs(){return ka},get cylinderMesh(){return ja},get CylinderMeshBuilder(){return la},get sphereMesh(){return ma},get SphereBuilder(){return na},get vortexMesh(){return oa},get programFromScripts(){return V},get Texture(){return W},get triangles(){return y},get ArrayBuffer(){return X},get Elements(){return r},get refChange(){return ta}};return wa});var g=d("davinci-eight");"undefined"!=typeof module&&module.exports?module.exports=g:e?!function(a){a(function(){return g})}(e):a.EIGHT=g}(this);